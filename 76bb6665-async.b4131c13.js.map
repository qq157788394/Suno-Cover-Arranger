{"version":3,"sources":["src/hooks/usePromptRecords.ts","src/pages/record/index.tsx"],"sourcesContent":["import { useCallback, useState } from 'react';\nimport { db } from '@/services/db';\nimport type { PromptRecord } from '@/shared/types/types';\n\nexport interface PromptRecordFilters {\n  keyword?: string;\n  dateRange?: [string, string];\n  songLanguages?: string | string[];\n  targetSinger?: string;\n  styleDescription?: string;\n  songName?: string;\n}\n\nexport const usePromptRecords = (currentUserId: number) => {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [records, setRecords] = useState<PromptRecord[]>([]);\n\n  // 获取所有记录\n  const getAllRecords = useCallback(async () => {\n    return await db.getUserPromptRecords(currentUserId);\n  }, [currentUserId]);\n\n  // 日期范围筛选\n  const filterByDateRange = useCallback(\n    (records: PromptRecord[], dateRange?: [string, string]) => {\n      if (\n        !dateRange ||\n        !Array.isArray(dateRange) ||\n        !dateRange[0] ||\n        !dateRange[1]\n      ) {\n        return records;\n      }\n      const startDate = new Date(dateRange[0]);\n      const endDate = new Date(dateRange[1]);\n      endDate.setHours(23, 59, 59, 999);\n      return records.filter((record) => {\n        const recordDate = new Date(record.created_at || new Date(0));\n        return recordDate >= startDate && recordDate <= endDate;\n      });\n    },\n    [],\n  );\n\n  // 歌曲语言筛选\n  const filterBySongLanguages = useCallback(\n    (records: PromptRecord[], songLanguages?: string | string[]) => {\n      if (!songLanguages) {\n        return records;\n      }\n      const languages = Array.isArray(songLanguages)\n        ? songLanguages\n        : [songLanguages];\n      return records.filter((record) =>\n        languages.includes(record.user_input.song_language),\n      );\n    },\n    [],\n  );\n\n  // 目标歌手筛选\n  const filterByTargetSinger = useCallback(\n    (records: PromptRecord[], targetSinger?: string) => {\n      if (!targetSinger || !targetSinger.trim()) {\n        return records;\n      }\n      const lowerCaseTargetSinger = targetSinger.toLowerCase();\n      return records.filter((record) =>\n        record.user_input?.target_singer\n          ?.toLowerCase()\n          .includes(lowerCaseTargetSinger),\n      );\n    },\n    [],\n  );\n\n  // 风格描述筛选\n  const filterByStyleDescription = useCallback(\n    (records: PromptRecord[], styleDescription?: string) => {\n      if (!styleDescription || !styleDescription.trim()) {\n        return records;\n      }\n      const lowerCaseStyleDescription = styleDescription.toLowerCase();\n      return records.filter((record) =>\n        record.user_input?.style_description\n          ?.toLowerCase()\n          .includes(lowerCaseStyleDescription),\n      );\n    },\n    [],\n  );\n\n  // 歌曲名称筛选\n  const filterBySongName = useCallback(\n    (records: PromptRecord[], songName?: string) => {\n      if (!songName || !songName.trim()) {\n        return records;\n      }\n      const lowerCaseSongName = songName.toLowerCase();\n      return records.filter((record) =>\n        record.user_input?.song_name?.toLowerCase().includes(lowerCaseSongName),\n      );\n    },\n    [],\n  );\n\n  // 关键词筛选\n  const filterByKeyword = useCallback(\n    (records: PromptRecord[], keyword?: string) => {\n      if (!keyword || !keyword.trim()) {\n        return records;\n      }\n      const lowerCaseKeyword = keyword.toLowerCase();\n      return records.filter((record) => {\n        // 在歌曲名称、目标歌手、风格描述中搜索关键词\n        return (\n          record.user_input?.song_name\n            ?.toLowerCase()\n            .includes(lowerCaseKeyword) ||\n          record.user_input?.target_singer\n            ?.toLowerCase()\n            .includes(lowerCaseKeyword) ||\n          record.user_input?.style_description\n            ?.toLowerCase()\n            .includes(lowerCaseKeyword) ||\n          record.ai_result?.styles?.toLowerCase().includes(lowerCaseKeyword) ||\n          record.ai_result?.lyrics?.toLowerCase().includes(lowerCaseKeyword)\n        );\n      });\n    },\n    [],\n  );\n\n  // 获取记录列表（整合筛选逻辑）\n  const fetchRecords = useCallback(\n    async (filters: PromptRecordFilters = {}) => {\n      setLoading(true);\n      try {\n        let fetchedRecords = await getAllRecords();\n\n        // 应用所有筛选条件\n        fetchedRecords = filterByKeyword(fetchedRecords, filters.keyword);\n        fetchedRecords = filterByDateRange(fetchedRecords, filters.dateRange);\n        fetchedRecords = filterBySongLanguages(\n          fetchedRecords,\n          filters.songLanguages,\n        );\n        fetchedRecords = filterByTargetSinger(\n          fetchedRecords,\n          filters.targetSinger,\n        );\n        fetchedRecords = filterByStyleDescription(\n          fetchedRecords,\n          filters.styleDescription,\n        );\n        fetchedRecords = filterBySongName(fetchedRecords, filters.songName);\n\n        setRecords(fetchedRecords);\n        return fetchedRecords;\n      } catch (error) {\n        console.error('获取记录失败：', error);\n        setRecords([]);\n        return [];\n      } finally {\n        setLoading(false);\n      }\n    },\n    [\n      getAllRecords,\n      filterByKeyword,\n      filterByDateRange,\n      filterBySongLanguages,\n      filterByTargetSinger,\n      filterByStyleDescription,\n      filterBySongName,\n    ],\n  );\n\n  // 删除单条记录\n  const deleteRecord = useCallback(\n    async (recordId: number) => {\n      try {\n        await db.deletePromptRecord(recordId);\n        // 刷新数据\n        await fetchRecords();\n        return { success: true };\n      } catch (error) {\n        console.error('删除记录失败：', error);\n        return { success: false, error };\n      }\n    },\n    [fetchRecords],\n  );\n\n  // 清空所有记录\n  const clearAllRecords = useCallback(async () => {\n    try {\n      const userRecords = await db.getUserPromptRecords(currentUserId);\n      await Promise.all(\n        userRecords.map((record) => {\n          if (record.id) {\n            return db.deletePromptRecord(record.id);\n          }\n          return Promise.resolve();\n        }),\n      );\n      setRecords([]);\n      return { success: true };\n    } catch (error) {\n      console.error('清空记录失败：', error);\n      return { success: false, error };\n    }\n  }, [currentUserId]);\n\n  return {\n    records,\n    loading,\n    fetchRecords,\n    deleteRecord,\n    clearAllRecords,\n  };\n};\n","import {\n  ClockCircleOutlined,\n  DeleteOutlined,\n  EyeOutlined,\n} from \"@ant-design/icons\";\nimport {\n  PageContainer,\n  type ProColumns,\n  ProTable,\n} from \"@ant-design/pro-components\";\nimport { useNavigate } from \"@umijs/max\";\nimport { Alert, Button, Modal, message, Space, Tooltip } from \"antd\";\nimport React, { useCallback, useEffect, useMemo } from \"react\";\nimport { usePromptRecords } from \"@/hooks/usePromptRecords\";\nimport type { PromptRecord } from \"@/shared/types/types\";\n\n// 结构化日志系统\nconst log = {\n  info: (message: string, data?: any) => {\n    console.log(`[INFO] ${new Date().toISOString()}: ${message}`, data || \"\");\n  },\n  warn: (message: string, data?: any) => {\n    console.warn(`[WARN] ${new Date().toISOString()}: ${message}`, data || \"\");\n  },\n  error: (message: string, error?: any) => {\n    console.error(\n      `[ERROR] ${new Date().toISOString()}: ${message}`,\n      error || \"\"\n    );\n  },\n  debug: (message: string, data?: any) => {\n    console.debug(\n      `[DEBUG] ${new Date().toISOString()}: ${message}`,\n      data || \"\"\n    );\n  },\n};\n\nconst RecordPage: React.FC = () => {\n  // 模拟当前用户ID，实际应用中应该从登录状态获取\n  const currentUserId = 1;\n  // 使用自定义 hook 管理提示词记录\n  const { records, loading, fetchRecords, deleteRecord } =\n    usePromptRecords(currentUserId);\n  // 使用Umi的useNavigate进行路由跳转\n  const navigate = useNavigate();\n\n  // 组件挂载时获取初始数据\n  useEffect(() => {\n    fetchRecords();\n  }, [fetchRecords]);\n\n  // 查看详情\n  const handleViewDetail = useCallback(\n    (record: PromptRecord) => {\n      try {\n        log.info(\"点击查看详情，准备传递的记录ID\", {\n          recordId: record.id,\n          record,\n        });\n\n        // 确保record对象存在且有ID\n        if (!record || !record.id) {\n          log.error(\"record或record.id为空\", { record });\n          message.error(\"查看详情失败，记录数据不完整\");\n          return;\n        }\n\n        // 使用URL参数传递记录ID\n        log.info(\"开始跳转到首页，携带记录ID参数\", { recordId: record.id });\n        navigate(`/?recordId=${record.id}`);\n      } catch (error) {\n        log.error(\"导航到详情页失败\", error);\n        message.error(\"查看详情失败，请稍后重试\");\n      }\n    },\n    [navigate]\n  );\n\n  // 删除单条记录\n  const handleDelete = useCallback(\n    async (record: PromptRecord) => {\n      Modal.confirm({\n        title: \"确认删除\",\n        content: \"确定要删除这条记录吗？该操作无法恢复。\",\n        okText: \"删除\",\n        okType: \"danger\",\n        cancelText: \"取消\",\n        onOk: async () => {\n          try {\n            if (!record.id) {\n              message.error(\"记录ID不存在\");\n              return;\n            }\n            await deleteRecord(record.id);\n            message.success(\"删除成功\");\n          } catch (error) {\n            message.error(\"删除失败\");\n            console.error(\"删除失败：\", error);\n          }\n        },\n      });\n    },\n    [deleteRecord]\n  );\n\n  // 处理搜索表单提交前的参数处理\n  const beforeSearchSubmit = useCallback((params: any) => {\n    // 直接返回处理后的参数，这些参数会传递给request函数\n    return params;\n  }, []);\n\n  // 处理表格参数变化并获取数据\n  const handleTableChange = useCallback(\n    async (_pagination: any, _filters: any, _sorter: any, extra: any) => {\n      // 从extra中获取搜索表单的参数\n      const { action, searchFormValues } = extra;\n\n      // 只有在搜索操作时才执行筛选\n      if (action === \"search\") {\n        const keyword = searchFormValues?.keyword || \"\";\n        const dateRange = searchFormValues?.created_at;\n        const songLanguages = searchFormValues?.song_language;\n        const targetSinger = searchFormValues?.target_singer;\n        const styleDescription = searchFormValues?.style_description;\n        const songName = searchFormValues?.song_name;\n\n        await fetchRecords({\n          keyword,\n          dateRange,\n          songLanguages,\n          targetSinger,\n          styleDescription,\n          songName,\n        });\n      }\n    },\n    [fetchRecords]\n  );\n\n  // 表格列配置\n  const columns = useMemo<ProColumns<PromptRecord>[]>(\n    () => [\n      {\n        title: \"ID\",\n        dataIndex: \"id\",\n        key: \"id\",\n        width: 80,\n        hideInSearch: true,\n      },\n      {\n        title: \"时间\",\n        dataIndex: \"created_at\",\n        key: \"created_at\",\n        width: 180,\n        valueType: \"dateRange\",\n        render: (_, record) => {\n          const createdAt = record.created_at || new Date(0);\n          return (\n            <Tooltip title={new Date(createdAt).toLocaleString()}>\n              <Space>\n                <ClockCircleOutlined />\n                {new Date(createdAt).toLocaleString()}\n              </Space>\n            </Tooltip>\n          );\n        },\n      },\n      {\n        title: \"歌曲名称\",\n        dataIndex: [\"user_input\", \"song_name\"],\n        key: \"song_name\",\n        width: 150,\n        search: true,\n        ellipsis: {\n          showTitle: false,\n        },\n      },\n      {\n        title: \"歌曲语言\",\n        dataIndex: [\"user_input\", \"song_language\"],\n        key: \"song_language\",\n        width: 120,\n        valueType: \"select\",\n        valueEnum: {\n          Mandarin: { text: \"华语（普通话）\" },\n          Cantonese: { text: \"粤语\" },\n          Minnan: { text: \"闽南语\" },\n          English: { text: \"英语\" },\n          Korean: { text: \"韩语\" },\n          Japanese: { text: \"日语\" },\n          Other: { text: \"其他\" },\n        },\n        search: true,\n        // 使用自定义筛选配置，通过类型断言绕过 TypeScript 检查\n        ...({\n          search: {\n            multiple: true,\n            fieldProps: {\n              mode: \"multiple\",\n              options: [\n                { value: \"Mandarin\", label: \"华语（普通话）\" },\n                { value: \"Cantonese\", label: \"粤语\" },\n                { value: \"Minnan\", label: \"闽南语\" },\n                { value: \"English\", label: \"英语\" },\n                { value: \"Korean\", label: \"韩语\" },\n                { value: \"Japanese\", label: \"日语\" },\n                { value: \"Other\", label: \"其他\" },\n              ],\n              maxTagCount: \"responsive\",\n            },\n          },\n        } as any),\n      },\n      {\n        title: \"模仿歌手\",\n        dataIndex: [\"user_input\", \"target_singer\"],\n        key: \"target_singer\",\n        width: 150,\n        search: true,\n        ellipsis: {\n          showTitle: false,\n        },\n      },\n      {\n        title: \"风格备注\",\n        dataIndex: [\"user_input\", \"style_description\"],\n        key: \"style_description\",\n        width: 200,\n        search: true,\n        ellipsis: {\n          showTitle: false,\n        },\n      },\n      {\n        title: \"操作\",\n        key: \"action\",\n        width: 120,\n        fixed: \"right\",\n        hideInSearch: true,\n        render: (_, record) => (\n          <Space size=\"middle\">\n            <Tooltip title=\"查看提示词\">\n              <Button\n                type=\"primary\"\n                icon={<EyeOutlined />}\n                size=\"small\"\n                onClick={() => handleViewDetail(record)}\n              >\n                详情\n              </Button>\n            </Tooltip>\n            <Tooltip title=\"删除\">\n              <Button\n                danger\n                icon={<DeleteOutlined />}\n                size=\"small\"\n                onClick={() => handleDelete(record)}\n              >\n                删除\n              </Button>\n            </Tooltip>\n          </Space>\n        ),\n      },\n    ],\n    [handleViewDetail, handleDelete]\n  );\n\n  return (\n    <PageContainer>\n      <Alert\n        title=\"生成记录仅保存在本地设备，不会上传至服务器，更换设备或浏览器后记录将无法查看。\"\n        banner\n        style={{ marginBottom: 24 }}\n      />\n      <ProTable\n        rowKey=\"id\"\n        columns={columns}\n        // 直接使用records状态作为数据来源\n        dataSource={records}\n        loading={loading}\n        headerTitle=\"提示词生成记录\"\n        options={{\n          reload: () => fetchRecords(),\n          density: true,\n          fullScreen: true,\n        }}\n        scroll={{ x: \"max-content\" }}\n        // 使用onChange处理表格参数变化\n        onChange={handleTableChange}\n        pagination={{\n          pageSize: 20,\n          showSizeChanger: true,\n          showQuickJumper: true,\n          showTotal: (total: number) => `共 ${total} 条记录`,\n        }}\n        search={{\n          labelWidth: \"auto\",\n          defaultCollapsed: false,\n          span: 6,\n        }}\n        // 添加request属性以确保表格能正确处理数据\n        request={async (params, _sort, _filter) => {\n          // 当表格首次加载或分页变化时也会调用此方法\n          // params包含了搜索表单的值\n          const keyword = params?.keyword || \"\";\n          const dateRange = params?.created_at;\n          const songLanguages = params?.song_language;\n          const targetSinger = params?.target_singer;\n          const styleDescription = params?.style_description;\n          const songName = params?.song_name;\n\n          await fetchRecords({\n            keyword,\n            dateRange,\n            songLanguages,\n            targetSinger,\n            styleDescription,\n            songName,\n          });\n\n          return {\n            data: records,\n            success: true,\n            total: records.length,\n          };\n        }}\n        // 在搜索表单提交前处理参数\n        beforeSearchSubmit={beforeSearchSubmit}\n      />\n    </PageContainer>\n  );\n};\n\nexport default React.memo(RecordPage);\n"],"names":[],"mappings":"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"}