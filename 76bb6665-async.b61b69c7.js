(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["76bb6665"],{eab7b529:function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return O;}});var r=a("777fffbe"),l=a("852bbaa9"),n=a("92e1422f"),s=a("dbdbaf61"),i=r._(s),o=a("b2254a00"),c=l._(o),u=a("9c8f4ef9"),d=r._(u),f=a("c2a49600"),g=r._(f),h=c.forwardRef(function(e,t){return c.createElement(g.default,(0,i.default)({},e,{ref:t,icon:d.default}));}),b=a("57d75ce9"),y=r._(b),p=a("e151c991"),w=r._(p),m=a("95836fa2"),x=a("ccf5e343"),k=a("6fe81391"),v=r._(k),C=a("4ff05871"),_=r._(C),I=a("c1be9c40"),S=r._(I),j=a("987cb190"),D=r._(j),T=a("64cd5827"),R=r._(T),L=a("31b33a98"),A=r._(L),P=a("d5126294"),M=a("e236400f");let E=e=>{let[t,a]=(0,c.useState)(!1),[r,l]=(0,c.useState)([]),n=(0,c.useCallback)(async t=>t?await M.db.searchPromptRecords(e,t):await M.db.getUserPromptRecords(e),[e]),s=(0,c.useCallback)((e,t)=>{if(!t||!Array.isArray(t)||!t[0]||!t[1])return e;let a=new Date(t[0]),r=new Date(t[1]);return r.setHours(23,59,59,999),e.filter(e=>{let t=new Date(e.createdAt||new Date(0));return t>=a&&t<=r;});},[]),i=(0,c.useCallback)((e,t)=>{if(!t)return e;let a=Array.isArray(t)?t:[t];return e.filter(e=>a.includes(e.userInput.songLanguage));},[]),o=(0,c.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,r;return null===(r=e.userInput)||void 0===r?void 0:null===(t=r.targetSinger)||void 0===t?void 0:t.toLowerCase().includes(a);});},[]),u=(0,c.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,r;return null===(r=e.userInput)||void 0===r?void 0:null===(t=r.styleDescription)||void 0===t?void 0:t.toLowerCase().includes(a);});},[]);return{records:r,loading:t,fetchRecords:(0,c.useCallback)(async(e={})=>{a(!0);try{let t=await n(e.keyword);return t=s(t,e.dateRange),t=i(t,e.songLanguages),t=o(t,e.targetSinger),t=u(t,e.styleDescription),l(t),t;}catch(e){return console.error("\u83B7\u53D6\u8BB0\u5F55\u5931\u8D25\uFF1A",e),l([]),[];}finally{a(!1);}},[n,s,i,o,u]),deleteRecord:(0,c.useCallback)(async e=>{try{return await M.db.deletePromptRecord(e),l(t=>t.filter(t=>t.id!==e)),{success:!0};}catch(e){return console.error("\u5220\u9664\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[]),clearAllRecords:(0,c.useCallback)(async()=>{try{let t=await M.db.getUserPromptRecords(e);return await Promise.all(t.map(e=>M.db.deletePromptRecord(e.id))),l([]),{success:!0};}catch(e){return console.error("\u6E05\u7A7A\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[e])};};var O=c.default.memo(()=>{let{records:e,loading:t,fetchRecords:a,deleteRecord:r}=E(1),l=(0,x.useNavigate)(),s=(0,c.useCallback)(e=>{try{localStorage.setItem("selectedPromptRecord",JSON.stringify(e)),l("/");}catch(e){console.error("\u5B58\u50A8\u8BB0\u5F55\u6570\u636E\u5931\u8D25:",e),D.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");}},[l]),i=(0,c.useCallback)(async e=>{S.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D\u3002",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:async()=>{try{await r(e.id),D.default.success("\u5220\u9664\u6210\u529F");}catch(e){D.default.error("\u5220\u9664\u5931\u8D25"),console.error("\u5220\u9664\u5931\u8D25\uFF1A",e);}}});},[r]),o=(0,c.useCallback)(async e=>{let t=e.keyword||"",r=e.createdAt,l=e.songLanguage,n=e.targetSinger,s=e.styleDescription,i=await a({keyword:t,dateRange:r,songLanguages:l,targetSinger:n,styleDescription:s});return{data:i,success:!0,total:i.length};},[a]),u=(0,c.useMemo)(()=>[{title:"ID",dataIndex:"id",key:"id",width:80,hideInSearch:!0},{title:"\u65F6\u95F4",dataIndex:"createdAt",key:"createdAt",width:180,valueType:"dateRange",render:(e,t)=>{let a=t.createdAt||new Date(0);return(0,n.jsx)(A.default,{title:new Date(a).toLocaleString(),children:(0,n.jsxs)(R.default,{children:[(0,n.jsx)(h,{}),new Date(a).toLocaleString()]})});}},{title:"\u6B4C\u66F2\u8BED\u8A00",dataIndex:["userInput","songLanguage"],key:"songLanguage",width:120,valueType:"select",valueEnum:{Mandarin:{text:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},Cantonese:{text:"\u7CA4\u8BED"},Minnan:{text:"\u95FD\u5357\u8BED"},English:{text:"\u82F1\u8BED"},Korean:{text:"\u97E9\u8BED"},Japanese:{text:"\u65E5\u8BED"},Other:{text:"\u5176\u4ED6"}},search:!0,search:{multiple:!0,fieldProps:{mode:"multiple",options:[{value:"Mandarin",label:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},{value:"Cantonese",label:"\u7CA4\u8BED"},{value:"Minnan",label:"\u95FD\u5357\u8BED"},{value:"English",label:"\u82F1\u8BED"},{value:"Korean",label:"\u97E9\u8BED"},{value:"Japanese",label:"\u65E5\u8BED"},{value:"Other",label:"\u5176\u4ED6"}],maxTagCount:"responsive"}}},{title:"\u6A21\u4EFF\u6B4C\u624B",dataIndex:["userInput","targetSinger"],key:"targetSinger",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u98CE\u683C\u5907\u6CE8",dataIndex:["userInput","styleDescription"],key:"styleDescription",width:200,search:!0,ellipsis:{showTitle:!1}},{title:"\u64CD\u4F5C",key:"action",width:120,fixed:"right",hideInSearch:!0,render:(e,t)=>(0,n.jsxs)(R.default,{size:"middle",children:[(0,n.jsx)(A.default,{title:"\u67E5\u770B\u63D0\u793A\u8BCD",children:(0,n.jsx)(_.default,{type:"primary",icon:(0,n.jsx)(w.default,{}),size:"small",onClick:()=>s(t),children:"\u8BE6\u60C5"})}),(0,n.jsx)(A.default,{title:"\u5220\u9664",children:(0,n.jsx)(_.default,{danger:!0,icon:(0,n.jsx)(y.default,{}),size:"small",onClick:()=>i(t),children:"\u5220\u9664"})})]})}],[s,i]);return(0,n.jsxs)(m.PageContainer,{children:[(0,n.jsx)(v.default,{title:"\u751F\u6210\u8BB0\u5F55\u4EC5\u4FDD\u5B58\u5728\u672C\u5730\u8BBE\u5907\uFF0C\u4E0D\u4F1A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF0C\u66F4\u6362\u8BBE\u5907\u6216\u6D4F\u89C8\u5668\u540E\u8BB0\u5F55\u5C06\u65E0\u6CD5\u67E5\u770B\u3002",banner:!0,style:{marginBottom:24}}),(0,n.jsx)(P.ProTableWrapper,{rowKey:"id",columns:u,request:o,loading:t,title:"\u63D0\u793A\u8BCD\u751F\u6210\u8BB0\u5F55",options:{reload:()=>a(),density:!0,fullScreen:!0},scroll:{x:1200}})]});});}}]);
//# sourceMappingURL=76bb6665-async.b61b69c7.js.map