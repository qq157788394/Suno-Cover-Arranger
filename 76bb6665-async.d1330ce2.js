(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["76bb6665"],{eab7b529:function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return O;}});var l=a("777fffbe"),r=a("852bbaa9"),n=a("92e1422f"),i=a("dbdbaf61"),s=l._(i),o=a("b2254a00"),u=r._(o),d=a("9c8f4ef9"),c=l._(d),g=a("c2a49600"),f=l._(g),v=u.forwardRef(function(e,t){return u.createElement(f.default,(0,s.default)({},e,{ref:t,icon:c.default}));}),h=a("57d75ce9"),p=l._(h),b=a("e151c991"),y=l._(b),w=a("95836fa2"),m=a("8b2a1aa3"),C=a("ccf5e343"),k=a("6fe81391"),x=l._(k),I=a("4ff05871"),S=l._(I),L=a("c1be9c40"),T=l._(L),_=a("987cb190"),D=l._(_),j=a("64cd5827"),A=l._(j),N=a("31b33a98"),P=l._(N),R=a("e236400f");let M=e=>{let[t,a]=(0,u.useState)(!1),[l,r]=(0,u.useState)([]),n=(0,u.useCallback)(async()=>await R.db.getUserPromptRecords(e),[e]),i=(0,u.useCallback)((e,t)=>{if(!t||!Array.isArray(t)||!t[0]||!t[1])return e;let a=new Date(t[0]),l=new Date(t[1]);return l.setHours(23,59,59,999),e.filter(e=>{let t=new Date(e.createdAt||new Date(0));return t>=a&&t<=l;});},[]),s=(0,u.useCallback)((e,t)=>{if(!t)return e;let a=Array.isArray(t)?t:[t];return e.filter(e=>a.includes(e.userInput.songLanguage));},[]),o=(0,u.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,l;return null===(l=e.userInput)||void 0===l?void 0:null===(t=l.targetSinger)||void 0===t?void 0:t.toLowerCase().includes(a);});},[]),d=(0,u.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,l;return null===(l=e.userInput)||void 0===l?void 0:null===(t=l.styleDescription)||void 0===t?void 0:t.toLowerCase().includes(a);});},[]),c=(0,u.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,l;return null===(l=e.userInput)||void 0===l?void 0:null===(t=l.songName)||void 0===t?void 0:t.toLowerCase().includes(a);});},[]),g=(0,u.useCallback)((e,t)=>{if(!t||!t.trim())return e;let a=t.toLowerCase();return e.filter(e=>{var t,l,r,n,i,s,o,u,d,c;return(null===(l=e.userInput)||void 0===l?void 0:null===(t=l.songName)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(n=e.userInput)||void 0===n?void 0:null===(r=n.targetSinger)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===(s=e.userInput)||void 0===s?void 0:null===(i=s.styleDescription)||void 0===i?void 0:i.toLowerCase().includes(a))||(null===(u=e.aiOutput)||void 0===u?void 0:null===(o=u.styles)||void 0===o?void 0:o.toLowerCase().includes(a))||(null===(c=e.aiOutput)||void 0===c?void 0:null===(d=c.lyrics)||void 0===d?void 0:d.toLowerCase().includes(a));});},[]),f=(0,u.useCallback)(async(e={})=>{a(!0);try{let t=await n();return t=g(t,e.keyword),t=i(t,e.dateRange),t=s(t,e.songLanguages),t=o(t,e.targetSinger),t=d(t,e.styleDescription),t=c(t,e.songName),r(t),t;}catch(e){return console.error("\u83B7\u53D6\u8BB0\u5F55\u5931\u8D25\uFF1A",e),r([]),[];}finally{a(!1);}},[n,g,i,s,o,d,c]),v=(0,u.useCallback)(async e=>{try{return await R.db.deletePromptRecord(e),await f(),{success:!0};}catch(e){return console.error("\u5220\u9664\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[f]);return{records:l,loading:t,fetchRecords:f,deleteRecord:v,clearAllRecords:(0,u.useCallback)(async()=>{try{let t=await R.db.getUserPromptRecords(e);return await Promise.all(t.map(e=>R.db.deletePromptRecord(e.id))),r([]),{success:!0};}catch(e){return console.error("\u6E05\u7A7A\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[e])};};var O=u.default.memo(()=>{let{records:e,loading:t,fetchRecords:a,deleteRecord:l}=M(1),r=(0,C.useNavigate)();(0,u.useEffect)(()=>{a();},[a]);let i=(0,u.useCallback)(e=>{try{localStorage.setItem("selectedPromptRecord",JSON.stringify(e)),r("/");}catch(e){console.error("\u5B58\u50A8\u8BB0\u5F55\u6570\u636E\u5931\u8D25:",e),D.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");}},[r]),s=(0,u.useCallback)(async e=>{T.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D\u3002",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:async()=>{try{await l(e.id),D.default.success("\u5220\u9664\u6210\u529F");}catch(e){D.default.error("\u5220\u9664\u5931\u8D25"),console.error("\u5220\u9664\u5931\u8D25\uFF1A",e);}}});},[l]),o=(0,u.useCallback)(e=>e,[]),d=(0,u.useCallback)(async(e,t,l,r)=>{let{action:n,searchFormValues:i}=r;if("search"===n){let e=(null==i?void 0:i.keyword)||"",t=null==i?void 0:i.createdAt,l=null==i?void 0:i.songLanguage,r=null==i?void 0:i.targetSinger,n=null==i?void 0:i.styleDescription,s=null==i?void 0:i.songName;await a({keyword:e,dateRange:t,songLanguages:l,targetSinger:r,styleDescription:n,songName:s});}},[a]),c=(0,u.useMemo)(()=>[{title:"ID",dataIndex:"id",key:"id",width:80,hideInSearch:!0},{title:"\u65F6\u95F4",dataIndex:"createdAt",key:"createdAt",width:180,valueType:"dateRange",render:(e,t)=>{let a=t.createdAt||new Date(0);return(0,n.jsx)(P.default,{title:new Date(a).toLocaleString(),children:(0,n.jsxs)(A.default,{children:[(0,n.jsx)(v,{}),new Date(a).toLocaleString()]})});}},{title:"\u6B4C\u66F2\u540D\u79F0",dataIndex:["userInput","songName"],key:"songName",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u6B4C\u66F2\u8BED\u8A00",dataIndex:["userInput","songLanguage"],key:"songLanguage",width:120,valueType:"select",valueEnum:{Mandarin:{text:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},Cantonese:{text:"\u7CA4\u8BED"},Minnan:{text:"\u95FD\u5357\u8BED"},English:{text:"\u82F1\u8BED"},Korean:{text:"\u97E9\u8BED"},Japanese:{text:"\u65E5\u8BED"},Other:{text:"\u5176\u4ED6"}},search:!0,search:{multiple:!0,fieldProps:{mode:"multiple",options:[{value:"Mandarin",label:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},{value:"Cantonese",label:"\u7CA4\u8BED"},{value:"Minnan",label:"\u95FD\u5357\u8BED"},{value:"English",label:"\u82F1\u8BED"},{value:"Korean",label:"\u97E9\u8BED"},{value:"Japanese",label:"\u65E5\u8BED"},{value:"Other",label:"\u5176\u4ED6"}],maxTagCount:"responsive"}}},{title:"\u6A21\u4EFF\u6B4C\u624B",dataIndex:["userInput","targetSinger"],key:"targetSinger",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u98CE\u683C\u5907\u6CE8",dataIndex:["userInput","styleDescription"],key:"styleDescription",width:200,search:!0,ellipsis:{showTitle:!1}},{title:"\u64CD\u4F5C",key:"action",width:120,fixed:"right",hideInSearch:!0,render:(e,t)=>(0,n.jsxs)(A.default,{size:"middle",children:[(0,n.jsx)(P.default,{title:"\u67E5\u770B\u63D0\u793A\u8BCD",children:(0,n.jsx)(S.default,{type:"primary",icon:(0,n.jsx)(y.default,{}),size:"small",onClick:()=>i(t),children:"\u8BE6\u60C5"})}),(0,n.jsx)(P.default,{title:"\u5220\u9664",children:(0,n.jsx)(S.default,{danger:!0,icon:(0,n.jsx)(p.default,{}),size:"small",onClick:()=>s(t),children:"\u5220\u9664"})})]})}],[i,s]);return(0,n.jsxs)(w.PageContainer,{children:[(0,n.jsx)(x.default,{title:"\u751F\u6210\u8BB0\u5F55\u4EC5\u4FDD\u5B58\u5728\u672C\u5730\u8BBE\u5907\uFF0C\u4E0D\u4F1A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF0C\u66F4\u6362\u8BBE\u5907\u6216\u6D4F\u89C8\u5668\u540E\u8BB0\u5F55\u5C06\u65E0\u6CD5\u67E5\u770B\u3002",banner:!0,style:{marginBottom:24}}),(0,n.jsx)(m.ProTable,{rowKey:"id",columns:c,dataSource:e,loading:t,headerTitle:"\u63D0\u793A\u8BCD\u751F\u6210\u8BB0\u5F55",options:{reload:()=>a(),density:!0,fullScreen:!0},scroll:{x:"max-content"},onChange:d,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`\u{5171} ${e} \u{6761}\u{8BB0}\u{5F55}`},search:{labelWidth:"auto",defaultCollapsed:!1,span:6},request:async(t,l,r)=>{let n=(null==t?void 0:t.keyword)||"",i=null==t?void 0:t.createdAt,s=null==t?void 0:t.songLanguage,o=null==t?void 0:t.targetSinger,u=null==t?void 0:t.styleDescription,d=null==t?void 0:t.songName;return await a({keyword:n,dateRange:i,songLanguages:s,targetSinger:o,styleDescription:u,songName:d}),{data:e,success:!0,total:e.length};},beforeSearchSubmit:o})]});});}}]);
//# sourceMappingURL=76bb6665-async.d1330ce2.js.map