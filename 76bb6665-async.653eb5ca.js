(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["76bb6665"],{eab7b529:function(e,t,l){l.d(t,"__esModule",{value:!0}),l.e(t,{default:function(){return P;}});var r=l("777fffbe"),a=l("852bbaa9"),n=l("c1fced07"),i=l("47ea07bf"),o=r._(i),s=l("84f5357b"),d=r._(s),u=l("b0f18a1c"),c=r._(u),g=l("94726fb6"),f=l("cbf15750"),v=l("ccf5e343"),_=l("59830d05"),h=r._(_),b=l("7c4238ce"),p=r._(b),w=l("83e0e46b"),y=r._(w),m=l("2d814793"),C=r._(m),k=l("6337b314"),x=r._(k),I=l("1b7cbf58"),S=r._(I),T=l("067db9e2"),L=a._(T),D=l("e236400f");let j=e=>{let[t,l]=(0,L.useState)(!1),[r,a]=(0,L.useState)([]),n=(0,L.useCallback)(async()=>await D.db.getUserPromptRecords(e),[e]),i=(0,L.useCallback)((e,t)=>{if(!t||!Array.isArray(t)||!t[0]||!t[1])return e;let l=new Date(t[0]),r=new Date(t[1]);return r.setHours(23,59,59,999),e.filter(e=>{let t=new Date(e.created_at||new Date(0));return t>=l&&t<=r;});},[]),o=(0,L.useCallback)((e,t)=>{if(!t)return e;let l=Array.isArray(t)?t:[t];return e.filter(e=>l.includes(e.user_input.song_language));},[]),s=(0,L.useCallback)((e,t)=>{if(!t||!t.trim())return e;let l=t.toLowerCase();return e.filter(e=>{var t,r;return null===(r=e.user_input)||void 0===r?void 0:null===(t=r.target_singer)||void 0===t?void 0:t.toLowerCase().includes(l);});},[]),d=(0,L.useCallback)((e,t)=>{if(!t||!t.trim())return e;let l=t.toLowerCase();return e.filter(e=>{var t,r;return null===(r=e.user_input)||void 0===r?void 0:null===(t=r.style_description)||void 0===t?void 0:t.toLowerCase().includes(l);});},[]),u=(0,L.useCallback)((e,t)=>{if(!t||!t.trim())return e;let l=t.toLowerCase();return e.filter(e=>{var t,r;return null===(r=e.user_input)||void 0===r?void 0:null===(t=r.song_name)||void 0===t?void 0:t.toLowerCase().includes(l);});},[]),c=(0,L.useCallback)((e,t)=>{if(!t||!t.trim())return e;let l=t.toLowerCase();return e.filter(e=>{var t,r,a,n,i,o,s,d,u,c;return(null===(r=e.user_input)||void 0===r?void 0:null===(t=r.song_name)||void 0===t?void 0:t.toLowerCase().includes(l))||(null===(n=e.user_input)||void 0===n?void 0:null===(a=n.target_singer)||void 0===a?void 0:a.toLowerCase().includes(l))||(null===(o=e.user_input)||void 0===o?void 0:null===(i=o.style_description)||void 0===i?void 0:i.toLowerCase().includes(l))||(null===(d=e.ai_result)||void 0===d?void 0:null===(s=d.styles)||void 0===s?void 0:s.toLowerCase().includes(l))||(null===(c=e.ai_result)||void 0===c?void 0:null===(u=c.lyrics)||void 0===u?void 0:u.toLowerCase().includes(l));});},[]),g=(0,L.useCallback)(async(e={})=>{l(!0);try{let t=await n();return t=c(t,e.keyword),t=i(t,e.dateRange),t=o(t,e.songLanguages),t=s(t,e.targetSinger),t=d(t,e.styleDescription),t=u(t,e.songName),a(t),t;}catch(e){return console.error("\u83B7\u53D6\u8BB0\u5F55\u5931\u8D25\uFF1A",e),a([]),[];}finally{l(!1);}},[n,c,i,o,s,d,u]),f=(0,L.useCallback)(async e=>{try{return await D.db.deletePromptRecord(e),await g(),{success:!0};}catch(e){return console.error("\u5220\u9664\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[g]);return{records:r,loading:t,fetchRecords:g,deleteRecord:f,clearAllRecords:(0,L.useCallback)(async()=>{try{let t=await D.db.getUserPromptRecords(e);return await Promise.all(t.map(e=>e.id?D.db.deletePromptRecord(e.id):Promise.resolve())),a([]),{success:!0};}catch(e){return console.error("\u6E05\u7A7A\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[e])};},R={info:(e,t)=>{console.log(`[INFO] ${new Date().toISOString()}: ${e}`,t||"");},error:(e,t)=>{console.error(`[ERROR] ${new Date().toISOString()}: ${e}`,t||"");}};var P=L.default.memo(()=>{let{records:e,loading:t,fetchRecords:l,deleteRecord:r}=j(1),a=(0,v.useNavigate)();(0,L.useEffect)(()=>{l();},[l]);let i=(0,L.useCallback)(e=>{try{if(R.info("\u70B9\u51FB\u67E5\u770B\u8BE6\u60C5\uFF0C\u51C6\u5907\u4F20\u9012\u7684\u8BB0\u5F55ID",{recordId:e.id,record:e}),!e||!e.id){R.error("record\u6216record.id\u4E3A\u7A7A",{record:e}),C.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BB0\u5F55\u6570\u636E\u4E0D\u5B8C\u6574");return;}R.info("\u5F00\u59CB\u8DF3\u8F6C\u5230\u9996\u9875\uFF0C\u643A\u5E26\u8BB0\u5F55ID\u53C2\u6570",{recordId:e.id}),a(`/?recordId=${e.id}`);}catch(e){R.error("\u5BFC\u822A\u5230\u8BE6\u60C5\u9875\u5931\u8D25",e),C.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");}},[a]),s=(0,L.useCallback)(async e=>{y.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D\u3002",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:async()=>{try{if(!e.id){C.default.error("\u8BB0\u5F55ID\u4E0D\u5B58\u5728");return;}await r(e.id),C.default.success("\u5220\u9664\u6210\u529F");}catch(e){C.default.error("\u5220\u9664\u5931\u8D25"),console.error("\u5220\u9664\u5931\u8D25\uFF1A",e);}}});},[r]),u=(0,L.useCallback)(e=>e,[]),_=(0,L.useCallback)(async(e,t,r,a)=>{let{action:n,searchFormValues:i}=a;if("search"===n){let e=(null==i?void 0:i.keyword)||"",t=null==i?void 0:i.created_at,r=null==i?void 0:i.song_language,a=null==i?void 0:i.target_singer,n=null==i?void 0:i.style_description,o=null==i?void 0:i.song_name;await l({keyword:e,dateRange:t,songLanguages:r,targetSinger:a,styleDescription:n,songName:o});}},[l]),b=(0,L.useMemo)(()=>[{title:"ID",dataIndex:"id",key:"id",width:80,hideInSearch:!0},{title:"\u65F6\u95F4",dataIndex:"created_at",key:"created_at",width:180,valueType:"dateRange",render:(e,t)=>{let l=t.created_at||new Date(0);return(0,n.jsx)(S.default,{title:new Date(l).toLocaleString(),children:(0,n.jsxs)(x.default,{children:[(0,n.jsx)(o.default,{}),new Date(l).toLocaleString()]})});}},{title:"\u6B4C\u66F2\u540D\u79F0",dataIndex:["user_input","song_name"],key:"song_name",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u6B4C\u66F2\u8BED\u8A00",dataIndex:["user_input","song_language"],key:"song_language",width:120,valueType:"select",valueEnum:{Mandarin:{text:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},Cantonese:{text:"\u7CA4\u8BED"},Minnan:{text:"\u95FD\u5357\u8BED"},English:{text:"\u82F1\u8BED"},Korean:{text:"\u97E9\u8BED"},Japanese:{text:"\u65E5\u8BED"},Other:{text:"\u5176\u4ED6"}},search:!0,search:{multiple:!0,fieldProps:{mode:"multiple",options:[{value:"Mandarin",label:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},{value:"Cantonese",label:"\u7CA4\u8BED"},{value:"Minnan",label:"\u95FD\u5357\u8BED"},{value:"English",label:"\u82F1\u8BED"},{value:"Korean",label:"\u97E9\u8BED"},{value:"Japanese",label:"\u65E5\u8BED"},{value:"Other",label:"\u5176\u4ED6"}],maxTagCount:"responsive"}}},{title:"\u6A21\u4EFF\u6B4C\u624B",dataIndex:["user_input","target_singer"],key:"target_singer",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u98CE\u683C\u5907\u6CE8",dataIndex:["user_input","style_description"],key:"style_description",width:200,search:!0,ellipsis:{showTitle:!1}},{title:"\u64CD\u4F5C",key:"action",width:120,fixed:"right",hideInSearch:!0,render:(e,t)=>(0,n.jsxs)(x.default,{size:"middle",children:[(0,n.jsx)(S.default,{title:"\u67E5\u770B\u63D0\u793A\u8BCD",children:(0,n.jsx)(p.default,{type:"primary",icon:(0,n.jsx)(c.default,{}),size:"small",onClick:()=>i(t),children:"\u8BE6\u60C5"})}),(0,n.jsx)(S.default,{title:"\u5220\u9664",children:(0,n.jsx)(p.default,{danger:!0,icon:(0,n.jsx)(d.default,{}),size:"small",onClick:()=>s(t),children:"\u5220\u9664"})})]})}],[i,s]);return(0,n.jsxs)(g.PageContainer,{children:[(0,n.jsx)(h.default,{title:"\u751F\u6210\u8BB0\u5F55\u4EC5\u4FDD\u5B58\u5728\u672C\u5730\u8BBE\u5907\uFF0C\u4E0D\u4F1A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF0C\u66F4\u6362\u8BBE\u5907\u6216\u6D4F\u89C8\u5668\u540E\u8BB0\u5F55\u5C06\u65E0\u6CD5\u67E5\u770B\u3002",banner:!0,style:{marginBottom:24}}),(0,n.jsx)(f.ProTable,{rowKey:"id",columns:b,dataSource:e,loading:t,headerTitle:"\u63D0\u793A\u8BCD\u751F\u6210\u8BB0\u5F55",options:{reload:()=>l(),density:!0,fullScreen:!0},scroll:{x:"max-content"},onChange:_,pagination:{pageSize:20,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`\u{5171} ${e} \u{6761}\u{8BB0}\u{5F55}`},search:{labelWidth:"auto",defaultCollapsed:!1,span:6},request:async(t,r,a)=>{let n=(null==t?void 0:t.keyword)||"",i=null==t?void 0:t.created_at,o=null==t?void 0:t.song_language,s=null==t?void 0:t.target_singer,d=null==t?void 0:t.style_description,u=null==t?void 0:t.song_name;return await l({keyword:n,dateRange:i,songLanguages:o,targetSinger:s,styleDescription:d,songName:u}),{data:e,success:!0,total:e.length};},beforeSearchSubmit:u})]});});}}]);
//# sourceMappingURL=76bb6665-async.653eb5ca.js.map