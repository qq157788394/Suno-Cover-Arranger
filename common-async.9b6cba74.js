(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["common"],{e236400f:function(e,t,s){s.d(t,"__esModule",{value:!0}),s.e(t,{db:function(){return n;}});var r=s("777fffbe"),a=s("4cd55e76"),o=r._(a);let i=Symbol.for("Dexie"),d=globalThis[i]||(globalThis[i]=o.default);if(o.default.semVer!==d.semVer)throw Error(`Two different versions of Dexie loaded in the same app: ${o.default.semVer} and ${d.semVer}`);let n=new class extends d{users;projects;styleConfigs;promptRecords;constructor(){super("SunoCoverArrangerDB"),this.version(1).stores({users:"++id, name, email, createdAt",projects:"++id, title, userId, createdAt, updatedAt",styleConfigs:"++id, name, userId, isDefault, createdAt, updatedAt",promptRecords:"++id, userId, createdAt"}),this.users=this.table("users"),this.projects=this.table("projects"),this.styleConfigs=this.table("styleConfigs"),this.promptRecords=this.table("promptRecords");}async createUser(e){let t={...e,createdAt:new Date},s=await this.users.add(t);return{...t,id:s};}async getUser(e){return this.users.get(e);}async updateUser(e,t){return this.users.update(e,t);}async deleteUser(e){await this.users.delete(e);}async getAllUsers(){return this.users.toArray();}async createProject(e){let t=new Date,s={...e,createdAt:t,updatedAt:t},r=await this.projects.add(s);return{...s,id:r};}async getProject(e){return this.projects.get(e);}async updateProject(e,t){return this.projects.update(e,{...t,updatedAt:new Date});}async deleteProject(e){await this.projects.delete(e);}async getUserProjects(e){return this.projects.where("userId").equals(e).toArray();}async createStyleConfig(e){let t=new Date,s={...e,createdAt:t,updatedAt:t};s.isDefault&&await this.styleConfigs.where({userId:s.userId,isDefault:!0}).modify({isDefault:!1,updatedAt:t});let r=await this.styleConfigs.add(s);return{...s,id:r};}async getStyleConfig(e){return this.styleConfigs.get(e);}async updateStyleConfig(e,t){let s=new Date;if(t.isDefault){let t=await this.styleConfigs.get(e);t&&await this.styleConfigs.where({userId:t.userId,isDefault:!0}).modify({isDefault:!1,updatedAt:s});}return this.styleConfigs.update(e,{...t,updatedAt:s});}async deleteStyleConfig(e){await this.styleConfigs.delete(e);}async getUserStyleConfigs(e){return this.styleConfigs.where("userId").equals(e).toArray();}async getDefaultStyleConfig(e){return this.styleConfigs.where({userId:e,isDefault:!0}).first();}async createPromptRecord(e){let t={...e,createdAt:new Date},s=await this.promptRecords.add(t);return{...t,id:s};}async getPromptRecord(e){return this.promptRecords.get(e);}async updatePromptRecord(e,t){return this.promptRecords.update(e,t);}async deletePromptRecord(e){await this.promptRecords.delete(e);}async getUserPromptRecords(e,t){let s=this.promptRecords.where("userId").equals(e).sortBy("createdAt").then(e=>e.reverse());return t?(await s).slice(0,t):s;}async searchPromptRecords(e,t,s){let r=(await this.getUserPromptRecords(e)).filter(e=>JSON.stringify(e).toLowerCase().includes(t.toLowerCase()));return s?r.slice(0,s):r;}async getRecentPromptRecords(e,t=7){let s=new Date;return s.setDate(s.getDate()-t),this.promptRecords.where("userId").equals(e).and(e=>e.createdAt>=s).sortBy("createdAt").then(e=>e.reverse());}};}}]);
//# sourceMappingURL=common-async.9b6cba74.js.map