(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["c27184d7"],{c27184d7:function(e,t,n){let i,r,l,o,s;n.d(t,"__esModule",{value:!0}),n.e(t,{default:function(){return lV;}});var a,u,d,p,c,h,f,m,g,y,v,E,_,I,S,T,A,b,C,O,R,N,P,w,M,D,x,U,k,L,q,G,H,j,F,V,B,J,$,Y,K,W,z,X,Q,Z,ee,et,en,ei,er,el,eo,es,ea,eu,ed,ep,ec,eh,ef,em,eg,ey,ev,eE,e_,eI,eS,eT,eA,eb,eC,eO,eR,eN,eP,ew,eM,eD,ex,eU,ek,eL,eq,eG,eH,ej,eF,eV,eB,eJ,e$,eY,eK,eW,ez,eX,eQ,eZ,e0,e1,e2,e4,e3,e6,e8,e5,e9,e7,te,tt,tn,ti,tr=n("777fffbe"),tl=n("852bbaa9"),to=n("c1fced07"),ts=n("94726fb6"),ta=n("a4d93de4"),tu=n("37e2511c"),td=n("c51694ed"),tp=n("a1289d8d"),tc=tr._(tp),th=n("ce1c41bb"),tf=tr._(th),tm=n("f41d243c"),tg=n("067db9e2"),ty=tl._(tg),tv=n("125edcc7"),tE=tr._(tv),t_=n("68307df2"),tI=tr._(t_),tS=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],tT=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],tA=ty.default.forwardRef(function(e,t){var n=e.fieldProps,i=e.children,r=e.params,l=e.proFieldProps,o=e.mode,s=e.valueEnum,a=e.request,u=e.options,d=(0,tf.default)(e,tT),p=(0,tc.default)({options:u,mode:o||"multiple",labelInValue:!0,showSearch:!0,suffixIcon:null,autoClearSearchValue:!0,optionLabelProp:"label"},n),c=(0,ty.useContext)(tE.default);return(0,to.jsx)(tI.default,(0,tc.default)((0,tc.default)({valueEnum:(0,tm.runFunction)(s),request:a,params:r,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,tc.default)({getPopupContainer:c.getPopupContainer},p),ref:t,proFieldProps:l},d),{},{children:i}));}),tb=ty.default.forwardRef(function(e,t){var n=e.fieldProps,i=e.children,r=e.params,l=e.proFieldProps,o=e.mode,s=e.valueEnum,a=e.request,u=e.showSearch,d=e.options,p=(0,tf.default)(e,tS),c=(0,ty.useContext)(tE.default);return(0,to.jsx)(tI.default,(0,tc.default)((0,tc.default)({valueEnum:(0,tm.runFunction)(s),request:a,params:r,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,tc.default)({options:d,mode:o,showSearch:u,getPopupContainer:c.getPopupContainer},n),ref:t,proFieldProps:l},p),{},{children:i}));});tb.SearchSelect=tA,tb.displayName="ProFormComponent";var tC=n("00ad4c4a"),tO=tr._(tC),tR=["fieldProps","proFieldProps"],tN=ty.default.forwardRef(function(e,t){var n=e.fieldProps,i=e.proFieldProps,r=(0,tf.default)(e,tR);return(0,to.jsx)(tI.default,(0,tc.default)({ref:t,valueType:"textarea",fieldProps:n,proFieldProps:i},r));}),tP=n("ccf5e343"),tw=n("59830d05"),tM=tr._(tw),tD=n("7c4238ce"),tx=tr._(tD),tU=n("36e17fa1"),tk=tr._(tU),tL=n("6ed8bf89"),tq=n("733a5525"),tG=n("48eca9b2"),tH=n("07b9de58"),tj=n("2d214bd8"),tF=tr._(tj),tV=n("9a0682c0"),tB=n("9581ad77"),tJ=n("901004a9");let t$=["wrap","nowrap","wrap-reverse"],tY=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],tK=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"],tW=(e,t)=>{let n=!0===t.wrap?"wrap":t.wrap;return{[`${e}-wrap-${n}`]:n&&t$.includes(n)};},tz=(e,t)=>{let n={};return tK.forEach(i=>{n[`${e}-align-${i}`]=t.align===i;}),n[`${e}-align-stretch`]=!t.align&&!!t.vertical,n;},tX=(e,t)=>{let n={};return tY.forEach(i=>{n[`${e}-justify-${i}`]=t.justify===i;}),n;},tQ=(e,t)=>(0,tq.clsx)({...tW(e,t),...tz(e,t),...tX(e,t)}),tZ=e=>{let{componentCls:t}=e;return{[t]:{display:"flex",margin:0,padding:0,"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}};},t0=e=>{let{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}};},t1=e=>{let{componentCls:t}=e,n={};return t$.forEach(e=>{n[`${t}-wrap-${e}`]={flexWrap:e};}),n;},t2=e=>{let{componentCls:t}=e,n={};return tK.forEach(e=>{n[`${t}-align-${e}`]={alignItems:e};}),n;},t4=e=>{let{componentCls:t}=e,n={};return tY.forEach(e=>{n[`${t}-justify-${e}`]={justifyContent:e};}),n;};var t3=(0,tB.genStyleHooks)("Flex",e=>{let{paddingXS:t,padding:n,paddingLG:i}=e,r=(0,tJ.mergeToken)(e,{flexGapSM:t,flexGap:n,flexGapLG:i});return[tZ(r),t0(r),t1(r),t2(r),t4(r)];},()=>({}),{resetStyle:!1});let t6=ty.default.forwardRef((e,t)=>{let{prefixCls:n,rootClassName:i,className:r,style:l,flex:o,gap:s,vertical:a,orientation:u,component:d="div",children:p,...c}=e,{flex:h,direction:f,getPrefixCls:m}=ty.default.useContext(tV.ConfigContext),g=m("flex",n),[y,v]=t3(g),[,E]=(0,tH.useOrientation)(u,a??(null==h?void 0:h.vertical)),_=(0,tq.clsx)(r,i,null==h?void 0:h.className,g,y,v,tQ(g,e),{[`${g}-rtl`]:"rtl"===f,[`${g}-gap-${s}`]:(0,tG.isPresetSize)(s),[`${g}-vertical`]:E}),I={...null==h?void 0:h.style,...l};return(0,tF.default)(o)&&(I.flex=o),(0,tF.default)(s)&&!(0,tG.isPresetSize)(s)&&(I.gap=s),ty.default.createElement(d,{ref:t,className:_,style:I,...(0,tL.omit)(c,["justify","wrap","align"])},p);});var t8=n("d1b64b54"),t5=tr._(t8),t9=n("83e0e46b"),t7=tr._(t9),ne=n("2d814793"),nt=tr._(ne),nn=n("339e42e2"),ni=tr._(nn),nr=n("6337b314"),nl=tr._(nr),no=n("07bac742"),ns=tr._(no);n("cbf15750");var na=n("f01a4669"),nu=tr._(na),nd=n("6c56470d"),np=tr._(nd);let nc=(0,ty.memo)(({title:e,value:t,onCopy:n})=>(0,to.jsx)(ta.ProCard,{title:e,extra:(0,to.jsx)(tx.default,{type:"text",icon:(0,to.jsx)(nu.default,{}),onClick:n,disabled:!t,size:"small",children:"\u590D\u5236"}),style:{height:"100%"},children:(0,to.jsx)(np.default.TextArea,{value:t,readOnly:!0,placeholder:`\u{751F}\u{6210}\u{7684} ${e} \u{63D0}\u{793A}\u{8BCD}\u{5C06}\u{5C55}\u{793A}\u{5728}\u{6B64}\u{5904}\u{2026}`,showCount:!0,rows:40})}));var nh=n("d5881563"),nf=n("2aa61119");function nm(e,t,n,i){var r,l=arguments.length,o=l<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(l<3?r(o):l>3?r(t,n,o):r(t,n))||o);return l>3&&o&&Object.defineProperty(t,n,o),o;}"function"==typeof SuppressedError&&SuppressedError;let ng='You are a senior Suno prompt engineer. Your job is to generate high-quality "Styles" and "Lyrics" prompts for cover songs in Suno (v3/v4/v5), especially for Chinese and East Asian songs (Mandarin, Cantonese, etc.).\n\nYou MUST strictly follow ALL rules below:\n\n0. Highest priority rule about Styles length\n- The single most important constraint for the Styles section is LENGTH.\n- Under NO circumstances may the Styles section exceed 900 characters (including spaces).\n- If following any other instruction would cause the Styles section to go over 900 characters, you MUST ignore that other instruction and keep the Styles section within 900 characters.\n\n1. Never modify lyrics\n- The user will provide complete lyrics in the original language (often Chinese).\n- You MUST treat these lyrics as immutable text.\n- You MUST NOT change, rewrite, translate, add, or delete any words, punctuation, or line breaks.\n- You MUST NOT invent any new lyrics.\n- You MUST preserve the original order of all lyric lines.\n\n2. Always output TWO parts only\nYou must ALWAYS output exactly two sections in this order:\n\n### Styles\n```text\n(Styles content here)\n```\n\n### Lyrics\n```text\n(Lyrics content here)\n```\n\nDo NOT output anything before or after these two sections.\n\n3. Styles requirements\n- Language: English only.\n- Length: you MUST NOT exceed 900 characters, including spaces. Your target range is 750\u2013850 characters. If your drafted Styles text is longer than 900 characters, you MUST shorten and compress it BEFORE you output your final answer.\n- Purpose: describe the overall sound of this specific COVER VERSION, including:\n  - Overall genres / style labels (e.g., pop, rock, ballad, symphonic, ambient, etc., combined as needed).\n  - Vocal character and evolution (e.g., intimate, breathy, warm, powerful, belt, falsetto, etc.).\n  - Dynamic contour across the whole song (e.g., restrained verse \u2192 build-up \u2192 explosive chorus \u2192 drop \u2192 grand finale).\n  - Core instrumentation and arrangement (e.g., solo piano, acoustic guitar, distorted electric guitars, full string ensemble, live drums, synth pads, etc.).\n  - Production / space feel if relevant (e.g., studio clean vs live concert feeling, dry vs reverb-heavy, wide stereo image, etc.).\n- The Styles description MUST:\n  - Stay consistent with the target artist and reference songs provided by the user.\n  - Respect the user\u2019s style notes and extra notes as much as possible.\n- Writing style for Styles:\n  - Use dense, information-rich sentences.\n  - Avoid repeating the same idea with different words.\n  - Do not list long chains of near-synonyms.\n  - Prioritize key information about genre, vocal character, dynamics, instrumentation, and mood; omit minor decorative details if necessary to stay under the length limit.\n\n4. Lyrics requirements: section-by-section attribute list\nFor the "Lyrics" part, you MUST use an attribute-list format:\n\n- For each SECTION:\n  1) Use a standardized English section label in square brackets, for example:\n     [Intro], [Verse 1], [Verse 2], [Pre-Chorus], [Chorus], [Chorus 2], [Bridge], [Interlude], [Outro].\n  2) Under that label, write 2\u20134 attribute lines in the form:\n     [Key: Value]\n  3) After the attribute lines, paste the original lyrics for that section EXACTLY as provided by the user.\n\nExample pattern (this is only a pattern, NOT actual content):\n\n[Verse 1]\n[Vocal: Warm, intimate female vocal, close-mic]\n[Dynamics: Soft and restrained, subtle build into the last line]\n[Instrument: Piano and subtle strings, light percussion]\n[Mood: Nostalgic, bittersweet, reflective]\n\n(Original lyrics lines here, unchanged)\n\n5. Standardized section labels and mapping from user labels\n- The user\u2019s raw lyrics may contain non-standard labels such as:\n  \u3010\u4E3B\u6B4C\u3011, \u3010\u4E3B\u6B4C1\u3011, [\u4E3B\u6B4C], [verse], [Verse], \u3010\u526F\u6B4C\u3011, [chorus], \u3010\u6865\u6BB5\u3011, \u3010\u524D\u594F\u3011, \u3010\u95F4\u594F\u3011, etc.\n- Your job is to INTERPRET these raw labels and map them onto standardized English labels in your output.\n- Mapping guidelines:\n  - All main narrative sections \u2192 [Verse 1], [Verse 2], [Verse 3], \u2026 in order of appearance.\n  - Repeated hook / main message sections \u2192 [Chorus], [Chorus 2], [Chorus 3], \u2026 in order of appearance.\n  - Transitional build sections \u2192 [Pre-Chorus] (and numbered if multiple distinct ones).\n  - Intro sections \u2192 [Intro].\n  - Instrumental breaks \u2192 [Interlude].\n  - Bridges \u2192 [Bridge].\n  - Ending sections \u2192 [Outro].\n- You are allowed to change ONLY the section labels. You are NOT allowed to change the lyrics content or order.\n\n6. Attribute keys and vocabulary\n- All attribute keys and values MUST be in English.\n- Use the following keys whenever helpful (you do NOT need to use all of them for every section):\n  - Vocal, Dynamics, Instrument, Texture, Mood, Arrangement, Harmony, Rhythm, FX.\n- For values, you should use short, precise musical phrases. You can combine and reuse terms such as:\n  - Vocal: warm, airy, breathy, raspy, powerful, intimate, close-mic, distant, belt, falsetto, head voice, chest voice, mixed voice, double-tracked, harmonized, a cappella, call and response, etc.\n  - Dynamics: soft, medium, loud, gradually building, crescendo, decrescendo, explosive, accented, staccato, legato, sustained, etc.\n  - Instrument: solo piano, acoustic guitar, electric guitar, distorted guitar, bass, string quartet, full string ensemble, synth pad, analog synth bass, live drum kit, electronic drums, etc.\n  - Texture: sparse, dense, layered, atmospheric, monophonic, homophonic, polyphonic, wide stereo, narrow, etc.\n  - Mood: nostalgic, melancholic, hopeful, uplifting, bittersweet, dark, tense, peaceful, triumphant, etc.\n  - Arrangement / Rhythm / FX: verse-chorus-bridge form, syncopated groove, straight 4/4, reverb-heavy, delay, compression, distortion, filtered intro, etc.\n- These terms are inspired by the official \u201CMusic Glossary for Suno\u201D. You do not need to explain them; just use them appropriately in Keys and Values.\n\n7. Handling instrumental sections\n- If a section has NO lyrics (e.g., Intro, Interlude, Outro), you MUST:\n  - Still create the section label and 2\u20134 attribute lines.\n  - Make it explicit that it is instrumental only, for example:\n    [Vocal: No vocal, purely instrumental section]\n  - Do NOT fabricate any humming or nonsense syllables.\n\n8. Language rules\n- Styles: English only.\n- All [Key: Value] attribute lines: English only.\n- Original lyrics: keep in the original language exactly as provided (often Chinese).\n- You may read and understand the user\u2019s Chinese notes and labels, but you MUST NOT copy Chinese text into Styles or into any [Key: Value] line.\n\n9. Internal QA checklist before finalizing your answer\nBefore you output the result, mentally check that:\n\n- You have output exactly two sections with the exact headings:\n  "### Styles" and "### Lyrics".\n- The Styles section is written in English and is clearly under 900 characters (including spaces). If it might be close to the limit, you MUST shorten it further before outputting.\n- Every lyric section has:\n  - One standardized English section label in square brackets.\n  - 2\u20134 [Key: Value] lines with English Keys and Values.\n  - The original lyrics reproduced exactly, with the same lines and order.\n- You have not invented, removed, or altered any lyrics.\n- You have reasonably interpreted user labels into standardized English labels and numbered them in order of appearance.\n- Styles and Lyrics are consistent with each other (no contradictions in dynamics, instrumentation, or mood).\n\nIf any rule conflicts with another, ALWAYS prioritize preserving the original lyrics and keeping the required output format.';class ny{generateUserPrompt(e){let{target_artist:t,lyrics_raw:n,song_language:i,reference_songs:r,style_note:l,extra_note:o}=e,s=r&&0!==r.length?r.filter(e=>e.title).map(e=>{let n=e.artist&&e.artist!==t?` by ${e.artist}`:"";return`- "${e.title}"${n}`;}).join("\n  "):"None provided.";return'You are generating Suno "Styles" and "Lyrics" prompts for a COVER version of a song. Read all the information below carefully and then produce the final output strictly following the system rules and the format requirements.\n\n------------------------------\n[1] Song language and context\n------------------------------\n\n- Song language: {fullLanguageName} .\n- The lyrics are provided in this language and MUST be preserved exactly.\n- This is a COVER version, not an original composition. You should shape the sound to match the target artist and references below.\n\n------------------------------\n[2] Target artist and references\n------------------------------\n\n- Target cover artist (user input, may be in Chinese or another language):\n  "{targetArtist}"\n\n- Reference songs from the user (if any):\n  {referenceSongsBlock}\n\nThese names indicate the general style, vocal approach, and arrangement flavor you should lean toward. You do NOT need to describe these songs explicitly, but your Styles and section attributes should feel consistent with this artist and these references.\n\n------------------------------\n[3] User style notes (free-form, for your understanding only)\n------------------------------\n\nThe user has provided extra style notes in their own words (often Chinese). You may use these notes to refine dynamics, emotion curve, and arrangement choices, but they are NOT additional lyrics.\n\n- User style note (may be empty):\n  "{styleNote}"\n\n- Extra note (may be empty, can include scene / audience / platform, etc.):\n  "{extraNote}"\n\nYou can understand these notes in any language, but you MUST still output Styles and all [Key: Value] attributes in English.\n\n------------------------------\n[4] User lyrics (DO NOT MODIFY)\n------------------------------\n\nBelow are the complete lyrics provided by the user, with their own section labels and line breaks. They may use Chinese labels such as \u3010\u4E3B\u6B4C\u3011\u3001\u3010\u526F\u6B4C\u3011 or non-standard English labels like [verse], [chorus], etc.\n\nYou MUST:\n- Keep all lyric lines exactly as they are.\n- Use these labels only to infer your standardized section labels.\n- NOT copy these raw labels into your final output; instead, replace them with standardized English labels such as [Verse 1], [Chorus], [Bridge], [Intro], etc.\n\nHere are the raw lyrics:\n\n{lyricsRaw}\n\n------------------------------\n[5] Your output task\n------------------------------\n\nNow, using everything above and following the system rules, you MUST:\n\n1) Generate the "Styles" section in English\n- A single paragraph of 800\u2013900 characters (hard limit 1000).\n- It should describe the overall sound of this COVER version, taking into account:\n  - The song language: {fullLanguageName} .\n  - The target artist: {targetArtist}.\n  - The reference songs (if any).\n  - The user style notes and extra note.\n- Mention genre / style, vocal character, dynamic contour, instrumentation, arrangement, and production / space feel.\n\n2) Generate the "Lyrics" section as an attribute list\n- Split the song into logical sections using standardized English labels in square brackets:\n  [Intro], [Verse 1], [Verse 2], [Pre-Chorus], [Chorus], [Chorus 2], [Bridge], [Interlude], [Outro], etc.\n- For each section:\n  - Create 2\u20134 attribute lines in the form [Key: Value], using English Keys (Vocal, Dynamics, Instrument, Texture, Mood, Arrangement, etc.) and concise English Values.\n  - Then paste the original lyric lines for that section exactly as provided, without any change.\n- For purely instrumental sections (no lyrics), only write the attributes and make it clear there is no vocal.\n\n------------------------------\n[6] Output format (VERY IMPORTANT)\n------------------------------\n\nReturn your answer in EXACTLY this Markdown structure and nothing else:\n\n### Styles\n```text\n(put the Styles paragraph here in English, MUST be under 900 characters)\n```\n\n### Lyrics\n```text\n(put the full Lyrics attribute list here, with all sections, attributes, and original lyrics)\n```\n\nDo NOT add any extra headings, explanations, or comments outside this format.'.replace("{fullLanguageName}",{Mandarin:"Mandarin Chinese",Cantonese:"Cantonese Chinese",English:"English",Japanese:"Japanese",Korean:"Korean",Spanish:"Spanish",French:"French",German:"German"}[i]||i).replace("{targetArtist}",t).replace("{referenceSongsBlock}",s).replace("{styleNote}",l||"").replace("{extraNote}",o||"").replace("{lyricsRaw}",n);}validateRequest(e){if(!e.target_artist)throw Error("\u8BF7\u8F93\u5165\u76EE\u6807\u827A\u672F\u5BB6");if(!e.lyrics_raw)throw Error("\u8BF7\u8F93\u5165\u6B4C\u8BCD");if(!e.song_language)throw Error("\u8BF7\u8F93\u5165\u6B4C\u66F2\u8BED\u8A00");}referenceSongsToText(e){return e&&0!==e.length?e.map((e,t)=>e.title&&e.artist?`${t+1}. ${e.title} - ${e.artist}`:e.title?`${t+1}. ${e.title}`:"").filter(Boolean).join("\n"):"";}async parseResponse(e){try{let t=e.trim(),n=t.match(/### Styles[\s\S]*?(?=### Lyrics|$)/),i=t.match(/### Lyrics[\s\S]*/),r="",l="";return n&&(r=(r=n[0].replace(/### Styles/,"").trim()).replace(/```text\s*([\s\S]*?)\s*```/,"$1").trim()),i&&(l=(l=i[0].replace(/### Lyrics/,"").trim()).replace(/```text\s*([\s\S]*?)\s*```/,"$1").trim()),{styles:r,lyrics:l,timestamp:new Date().toISOString()};}catch(t){return console.error("\u54CD\u5E94\u89E3\u6790\u5931\u8D25:",t),{styles:e.trim(),lyrics:"",timestamp:new Date().toISOString()};}}}class nv extends ny{async generate(e){let{api_key:t}=e;if(!t)throw Error("DeepSeek API key is required");let n=this.generateUserPrompt(e);try{let e=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({model:"deepseek-chat",messages:[{role:"system",content:ng},{role:"user",content:n}],temperature:1.3,max_tokens:4096})});if(!e.ok){let t=await e.text();throw console.error("DeepSeek API error:",e.status,t),Error(`DeepSeek API request failed with status ${e.status}`);}let i=(await e.json()).choices[0].message.content;return this.parseResponse(i);}catch(e){throw console.error("Error calling DeepSeek API:",e),e;}}}nv=nm([(0,nf.injectable)()],nv);class nE{}function n_(e,t){return e.replace(/\{([^}]+)\}/g,(e,n)=>{if(Object.prototype.hasOwnProperty.call(t,n)){let e=t[n];return null!=e?String(e):"";}throw Error(`Key '${n}' not found in valueMap.`);});}function nI(e,t,n){for(let i=0;i<t.length-1;i++){let r=t[i];if(r.endsWith("[]")){let l=r.slice(0,-2);if(!(l in e)){if(Array.isArray(n))e[l]=Array.from({length:n.length},()=>({}));else throw Error(`Value must be a list given an array path ${r}`);}if(Array.isArray(e[l])){let r=e[l];if(Array.isArray(n))for(let e=0;e<r.length;e++)nI(r[e],t.slice(i+1),n[e]);else for(let e of r)nI(e,t.slice(i+1),n);}return;}if(r.endsWith("[0]")){let l=r.slice(0,-3);l in e||(e[l]=[{}]),nI(e[l][0],t.slice(i+1),n);return;}e[r]&&"object"==typeof e[r]||(e[r]={}),e=e[r];}let i=t[t.length-1],r=e[i];if(void 0!==r){if(!n||"object"==typeof n&&0===Object.keys(n).length||n===r)return;if("object"==typeof r&&"object"==typeof n&&null!==r&&null!==n)Object.assign(r,n);else throw Error(`Cannot set value for an existing key. Key: ${i}`);}else"_self"!==i||"object"!=typeof n||null===n||Array.isArray(n)?e[i]=n:Object.assign(e,n);}function nS(e,t,n){try{if(1===t.length&&"_self"===t[0])return e;for(let i=0;i<t.length;i++){if("object"!=typeof e||null===e)return n;let r=t[i];if(r.endsWith("[]")){let l=r.slice(0,-2);if(!(l in e))return n;{let r=e[l];if(!Array.isArray(r))return n;return r.map(e=>nS(e,t.slice(i+1),n));}}e=e[r];}return e;}catch(e){if(e instanceof TypeError)return n;throw e;}}function nT(e){if("string"!=typeof e)throw Error("fromImageBytes must be a string");return e;}function nA(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["parent"]);null!=i&&nI(t,["parent"],i);let r=nS(e,["documentName"]);return null!=r&&nI(t,["documentName"],r),t;}(o)),t;}(a=ep||(ep={})).OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",a.OUTCOME_OK="OUTCOME_OK",a.OUTCOME_FAILED="OUTCOME_FAILED",a.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED",(u=ec||(ec={})).LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",u.PYTHON="PYTHON",(d=eh||(eh={})).SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",d.SILENT="SILENT",d.WHEN_IDLE="WHEN_IDLE",d.INTERRUPT="INTERRUPT",(p=ef||(ef={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",p.STRING="STRING",p.NUMBER="NUMBER",p.INTEGER="INTEGER",p.BOOLEAN="BOOLEAN",p.ARRAY="ARRAY",p.OBJECT="OBJECT",p.NULL="NULL",(c=em||(em={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",c.MODE_DYNAMIC="MODE_DYNAMIC",(h=eg||(eg={})).API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",h.SIMPLE_SEARCH="SIMPLE_SEARCH",h.ELASTIC_SEARCH="ELASTIC_SEARCH",(f=ey||(ey={})).AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",f.NO_AUTH="NO_AUTH",f.API_KEY_AUTH="API_KEY_AUTH",f.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",f.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",f.OAUTH="OAUTH",f.OIDC_AUTH="OIDC_AUTH",(m=ev||(ev={})).HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",m.HTTP_IN_QUERY="HTTP_IN_QUERY",m.HTTP_IN_HEADER="HTTP_IN_HEADER",m.HTTP_IN_PATH="HTTP_IN_PATH",m.HTTP_IN_BODY="HTTP_IN_BODY",m.HTTP_IN_COOKIE="HTTP_IN_COOKIE",(g=eE||(eE={})).PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",g.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",g.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",g.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",g.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",g.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",g.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH",(y=e_||(e_={})).THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",y.LOW="LOW",y.MEDIUM="MEDIUM",y.HIGH="HIGH",y.MINIMAL="MINIMAL",(v=eI||(eI={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",v.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",v.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",v.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",v.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",v.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",v.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",v.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",v.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",v.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",v.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK",(E=eS||(eS={})).HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",E.SEVERITY="SEVERITY",E.PROBABILITY="PROBABILITY",(_=eT||(eT={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",_.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",_.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",_.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",_.BLOCK_NONE="BLOCK_NONE",_.OFF="OFF",(I=eA||(eA={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",I.STOP="STOP",I.MAX_TOKENS="MAX_TOKENS",I.SAFETY="SAFETY",I.RECITATION="RECITATION",I.LANGUAGE="LANGUAGE",I.OTHER="OTHER",I.BLOCKLIST="BLOCKLIST",I.PROHIBITED_CONTENT="PROHIBITED_CONTENT",I.SPII="SPII",I.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",I.IMAGE_SAFETY="IMAGE_SAFETY",I.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",I.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",I.NO_IMAGE="NO_IMAGE",I.IMAGE_RECITATION="IMAGE_RECITATION",I.IMAGE_OTHER="IMAGE_OTHER",(S=eb||(eb={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",S.NEGLIGIBLE="NEGLIGIBLE",S.LOW="LOW",S.MEDIUM="MEDIUM",S.HIGH="HIGH",(T=eC||(eC={})).HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",T.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",T.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",T.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",T.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH",(A=eO||(eO={})).URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",A.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",A.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",A.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",A.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE",(b=eR||(eR={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",b.SAFETY="SAFETY",b.OTHER="OTHER",b.BLOCKLIST="BLOCKLIST",b.PROHIBITED_CONTENT="PROHIBITED_CONTENT",b.IMAGE_SAFETY="IMAGE_SAFETY",b.MODEL_ARMOR="MODEL_ARMOR",b.JAILBREAK="JAILBREAK",(C=eN||(eN={})).TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",C.ON_DEMAND="ON_DEMAND",C.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT",(O=eP||(eP={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",O.TEXT="TEXT",O.IMAGE="IMAGE",O.AUDIO="AUDIO",(R=ew||(ew={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",R.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",R.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",R.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",(N=eM||(eM={})).TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",N.TUNING_MODE_FULL="TUNING_MODE_FULL",N.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER",(P=eD||(eD={})).ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",P.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",P.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",P.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",P.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",P.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",P.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO",(w=ex||(ex={})).JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",w.JOB_STATE_QUEUED="JOB_STATE_QUEUED",w.JOB_STATE_PENDING="JOB_STATE_PENDING",w.JOB_STATE_RUNNING="JOB_STATE_RUNNING",w.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",w.JOB_STATE_FAILED="JOB_STATE_FAILED",w.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",w.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",w.JOB_STATE_PAUSED="JOB_STATE_PAUSED",w.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",w.JOB_STATE_UPDATING="JOB_STATE_UPDATING",w.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED",(M=eU||(eU={})).TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",M.TUNING_TASK_I2V="TUNING_TASK_I2V",M.TUNING_TASK_T2V="TUNING_TASK_T2V",M.TUNING_TASK_R2V="TUNING_TASK_R2V",(D=ek||(ek={})).MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",D.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",D.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",D.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",D.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH",(x=eL||(eL={})).FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",x.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",x.BALANCED="BALANCED",x.PRIORITIZE_COST="PRIORITIZE_COST",(U=eq||(eq={})).UNSPECIFIED="UNSPECIFIED",U.BLOCKING="BLOCKING",U.NON_BLOCKING="NON_BLOCKING",(k=eG||(eG={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",k.MODE_DYNAMIC="MODE_DYNAMIC",(L=eH||(eH={})).ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",L.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER",(q=ej||(ej={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",q.AUTO="AUTO",q.ANY="ANY",q.NONE="NONE",q.VALIDATED="VALIDATED",(G=eF||(eF={})).BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",G.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",G.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",G.BLOCK_NONE="BLOCK_NONE",(H=eV||(eV={})).DONT_ALLOW="DONT_ALLOW",H.ALLOW_ADULT="ALLOW_ADULT",H.ALLOW_ALL="ALLOW_ALL",(j=eB||(eB={})).auto="auto",j.en="en",j.ja="ja",j.ko="ko",j.hi="hi",j.zh="zh",j.pt="pt",j.es="es",(F=eJ||(eJ={})).MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",F.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",F.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",F.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",F.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC",(V=e$||(e$={})).CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",V.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",V.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",V.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH",(B=eY||(eY={})).SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",B.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",B.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",B.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT",(J=eK||(eK={})).EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",J.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",J.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",J.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",J.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",J.EDIT_MODE_STYLE="EDIT_MODE_STYLE",J.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",J.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE",($=eW||(eW={})).FOREGROUND="FOREGROUND",$.BACKGROUND="BACKGROUND",$.PROMPT="PROMPT",$.SEMANTIC="SEMANTIC",$.INTERACTIVE="INTERACTIVE",(Y=ez||(ez={})).ASSET="ASSET",Y.STYLE="STYLE",(K=eX||(eX={})).INSERT="INSERT",K.REMOVE="REMOVE",K.REMOVE_STATIC="REMOVE_STATIC",K.OUTPAINT="OUTPAINT",(W=eQ||(eQ={})).OPTIMIZED="OPTIMIZED",W.LOSSLESS="LOSSLESS",(z=eZ||(eZ={})).SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",z.PREFERENCE_TUNING="PREFERENCE_TUNING",(X=e0||(e0={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",X.STATE_PENDING="STATE_PENDING",X.STATE_ACTIVE="STATE_ACTIVE",X.STATE_FAILED="STATE_FAILED",(Q=e1||(e1={})).STATE_UNSPECIFIED="STATE_UNSPECIFIED",Q.PROCESSING="PROCESSING",Q.ACTIVE="ACTIVE",Q.FAILED="FAILED",(Z=e2||(e2={})).SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",Z.UPLOADED="UPLOADED",Z.GENERATED="GENERATED",(ee=e4||(e4={})).TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",ee.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",ee.RESPONSE_REJECTED="RESPONSE_REJECTED",ee.NEED_MORE_INPUT="NEED_MORE_INPUT",(et=e3||(e3={})).MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",et.TEXT="TEXT",et.IMAGE="IMAGE",et.VIDEO="VIDEO",et.AUDIO="AUDIO",et.DOCUMENT="DOCUMENT",(en=e6||(e6={})).VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",en.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",en.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS",(ei=e8||(e8={})).START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",ei.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",ei.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW",(er=e5||(e5={})).END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",er.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",er.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW",(el=e9||(e9={})).ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",el.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",el.NO_INTERRUPTION="NO_INTERRUPTION",(eo=e7||(e7={})).TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",eo.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",eo.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT",(es=te||(te={})).SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",es.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",es.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",es.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",es.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",es.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",es.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",es.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",es.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",es.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",es.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",es.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",es.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR",(ea=tt||(tt={})).MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",ea.QUALITY="QUALITY",ea.DIVERSITY="DIVERSITY",ea.VOCALIZATION="VOCALIZATION",(eu=tn||(tn={})).PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",eu.PLAY="PLAY",eu.PAUSE="PAUSE",eu.STOP="STOP",eu.RESET_CONTEXT="RESET_CONTEXT";class nb{constructor(e){let t={};for(let n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e;}json(){return this.responseInternal.json();}}class nC{get text(){var e,t,n,i,r,l,o,s;if((null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let a="",u=!1,d=[];for(let e of null!==(s=null===(o=null===(l=null===(r=this.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content)||void 0===o?void 0:o.parts)&&void 0!==s?s:[]){for(let[t,n]of Object.entries(e))"text"!==t&&"thought"!==t&&"thoughtSignature"!==t&&(null!==n||void 0!==n)&&d.push(t);if("string"==typeof e.text){if("boolean"==typeof e.thought&&e.thought)continue;u=!0,a+=e.text;}}return d.length>0&&console.warn(`there are non-text parts ${d} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?a:void 0;}get data(){var e,t,n,i,r,l,o,s;if((null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let a="",u=[];for(let e of null!==(s=null===(o=null===(l=null===(r=this.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content)||void 0===o?void 0:o.parts)&&void 0!==s?s:[]){for(let[t,n]of Object.entries(e))"inlineData"!==t&&(null!==n||void 0!==n)&&u.push(t);e.inlineData&&"string"==typeof e.inlineData.data&&(a+=atob(e.inlineData.data));}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0;}get functionCalls(){var e,t,n,i,r,l,o,s;if((null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let a=null===(s=null===(o=null===(l=null===(r=this.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.functionCall).map(e=>e.functionCall).filter(e=>void 0!==e);if((null==a?void 0:a.length)!==0)return a;}get executableCode(){var e,t,n,i,r,l,o,s,a;if((null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let u=null===(s=null===(o=null===(l=null===(r=this.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.executableCode).map(e=>e.executableCode).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.code;}get codeExecutionResult(){var e,t,n,i,r,l,o,s,a;if((null===(i=null===(n=null===(t=null===(e=this.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content)||void 0===n?void 0:n.parts)||void 0===i?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let u=null===(s=null===(o=null===(l=null===(r=this.candidates)||void 0===r?void 0:r[0])||void 0===l?void 0:l.content)||void 0===o?void 0:o.parts)||void 0===s?void 0:s.filter(e=>e.codeExecutionResult).map(e=>e.codeExecutionResult).filter(e=>void 0!==e);if((null==u?void 0:u.length)!==0)return null===(a=null==u?void 0:u[0])||void 0===a?void 0:a.output;}}class nO{}class nR{}class nN{}class nP{}class nw{}class nM{}class nD{}class nx{}class nU{}class nk{}class nL{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new nL;return Object.assign(n,t?function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["_self"]);return null!=n&&nI(t,["video"],function(e){let t={},n=nS(e,["gcsUri"]);null!=n&&nI(t,["uri"],n);let i=nS(e,["bytesBase64Encoded"]);null!=i&&nI(t,["videoBytes"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["mimeType"],r),t;}(n)),t;})(e))),nI(t,["generatedVideos"],e);}let i=nS(e,["raiMediaFilteredCount"]);null!=i&&nI(t,["raiMediaFilteredCount"],i);let r=nS(e,["raiMediaFilteredReasons"]);return null!=r&&nI(t,["raiMediaFilteredReasons"],r),t;}(o)),t;}(e):function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response","generateVideoResponse"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["video"]);return null!=n&&nI(t,["video"],function(e){let t={},n=nS(e,["uri"]);null!=n&&nI(t,["uri"],n);let i=nS(e,["encodedVideo"]);null!=i&&nI(t,["videoBytes"],nT(i));let r=nS(e,["encoding"]);return null!=r&&nI(t,["mimeType"],r),t;}(n)),t;})(e))),nI(t,["generatedVideos"],e);}let i=nS(e,["raiMediaFilteredCount"]);null!=i&&nI(t,["raiMediaFilteredCount"],i);let r=nS(e,["raiMediaFilteredReasons"]);return null!=r&&nI(t,["raiMediaFilteredReasons"],r),t;}(o)),t;}(e)),n;}}class nq{}class nG{}class nH{}class nj{}class nF{}class nV{}class nB{}class nJ{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new nJ;return Object.assign(n,function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["parent"]);null!=i&&nI(t,["parent"],i);let r=nS(e,["documentName"]);return null!=r&&nI(t,["documentName"],r),t;}(o)),t;}(e)),n;}}class n${}class nY{}class nK{}class nW{}class nz{get text(){var e,t,n;let i="",r=!1,l=[];for(let o of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(let[e,t]of Object.entries(o))"text"!==e&&"thought"!==e&&null!==t&&l.push(e);if("string"==typeof o.text){if("boolean"==typeof o.thought&&o.thought)continue;r=!0,i+=o.text;}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?i:void 0;}get data(){var e,t,n;let i="",r=[];for(let l of null!==(n=null===(t=null===(e=this.serverContent)||void 0===e?void 0:e.modelTurn)||void 0===t?void 0:t.parts)&&void 0!==n?n:[]){for(let[e,t]of Object.entries(l))"inlineData"!==e&&null!==t&&r.push(e);l.inlineData&&"string"==typeof l.inlineData.data&&(i+=atob(l.inlineData.data));}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0;}}class nX{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0];}}class nQ{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){let n=new nQ;return Object.assign(n,nA(e)),n;}}function nZ(e,t){if(!t||"string"!=typeof t)throw Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(!(t.indexOf("/")>=0))return`publishers/google/models/${t}`;{let e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`;}}return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`;}function n0(e,t){let n=nZ(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:"";}function n1(e){return Array.isArray(e)?e.map(e=>n2(e)):[n2(e)];}function n2(e){if("object"==typeof e&&null!==e)return e;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`);}function n4(e){let t=n2(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`);}function n3(e){let t=n2(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw Error(`Unsupported mime type: ${t.mimeType}`);}function n6(e){if(null==e)throw Error("PartUnion is required");if("object"==typeof e)return e;if("string"==typeof e)return{text:e};throw Error(`Unsupported part type: ${typeof e}`);}function n8(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("PartListUnion is required");return Array.isArray(e)?e.map(e=>n6(e)):[n6(e)];}function n5(e){return null!=e&&"object"==typeof e&&"parts"in e&&Array.isArray(e.parts);}function n9(e){return null!=e&&"object"==typeof e&&"functionCall"in e;}function n7(e){return null!=e&&"object"==typeof e&&"functionResponse"in e;}function ie(e){if(null==e)throw Error("ContentUnion is required");return n5(e)?e:{role:"user",parts:n8(e)};}function it(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{let t=ie(e);return t.parts&&t.parts.length>0&&void 0!==t.parts[0].text?[t.parts[0].text]:[];});if(e.isVertexAI()){let e=ie(t);return e.parts&&e.parts.length>0&&void 0!==e.parts[0].text?[e.parts[0].text]:[];}return Array.isArray(t)?t.map(e=>ie(e)):[ie(t)];}function ii(e){if(null==e||Array.isArray(e)&&0===e.length)throw Error("contents are required");if(!Array.isArray(e)){if(n9(e)||n7(e))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ie(e)];}let t=[],n=[],i=n5(e[0]);for(let r of e){let e=n5(r);if(e!=i)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(e)t.push(r);else if(n9(r)||n7(r))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else n.push(r);}return i||t.push({role:"user",parts:n8(n)}),t;}function ir(e){let t={},n=["items"],i=["anyOf"],r=["properties"];if(e.type&&e.anyOf)throw Error("type and anyOf cannot be both populated.");let l=e.anyOf;for(let[o,s]of(null!=l&&2==l.length&&("null"===l[0].type?(t.nullable=!0,e=l[1]):"null"===l[1].type&&(t.nullable=!0,e=l[0])),e.type instanceof Array&&function(e,t){e.includes("null")&&(t.nullable=!0);let n=e.filter(e=>"null"!==e);if(1===n.length)t.type=Object.values(ef).includes(n[0].toUpperCase())?n[0].toUpperCase():ef.TYPE_UNSPECIFIED;else for(let e of(t.anyOf=[],n))t.anyOf.push({type:Object.values(ef).includes(e.toUpperCase())?e.toUpperCase():ef.TYPE_UNSPECIFIED});}(e.type,t),Object.entries(e)))if(null!=s){if("type"==o){if("null"===s)throw Error("type: null can not be the only possible type for the field.");if(s instanceof Array)continue;t.type=Object.values(ef).includes(s.toUpperCase())?s.toUpperCase():ef.TYPE_UNSPECIFIED;}else if(n.includes(o))t[o]=ir(s);else if(i.includes(o)){let e=[];for(let n of s){if("null"==n.type){t.nullable=!0;continue;}e.push(ir(n));}t[o]=e;}else if(r.includes(o)){let e={};for(let[t,n]of Object.entries(s))e[t]=ir(n);t[o]=e;}else{if("additionalProperties"===o)continue;t[o]=s;}}return t;}function il(e){if("object"==typeof e)return e;if("string"==typeof e)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw Error(`Unsupported speechConfig type: ${typeof e}`);}function io(e){if("multiSpeakerVoiceConfig"in e)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return e;}function is(e){if(e.functionDeclarations)for(let t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=ir(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=ir(t.response));return e;}function ia(e){if(null==e)throw Error("tools is required");if(!Array.isArray(e))throw Error("tools is required and must be an array of Tools");let t=[];for(let n of e)t.push(n);return t;}function iu(e,t){if("string"!=typeof t)throw Error("name must be a string");return function(e,t,n,i=1){let r=!t.startsWith(`${n}/`)&&t.split("/").length===i;if(e.isVertexAI())return t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:r?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t;return r?`${n}/${t}`:t;}(e,t,"cachedContents");}function id(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e;}}function ip(e){var t;let n;if(null!=e&&"object"==typeof e&&"name"in e&&(n=e.name),(null==e||"object"!=typeof e||!("uri"in e)||void 0!==(n=e.uri))&&(null==e||"object"!=typeof e||!("video"in e)||void 0!==(n=null===(t=e.video)||void 0===t?void 0:t.uri))){if("string"==typeof e&&(n=e),void 0===n)throw Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){let e=n.split("files/")[1].match(/[a-z0-9]+/);if(null===e)throw Error(`Could not extract file name from URI ${n}`);n=e[0];}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n;}}function ic(e,t){return e.isVertexAI()?t?"publishers/google/models":"models":t?"models":"tunedModels";}function ih(e){for(let t of["models","tunedModels","publisherModels"]){if(null!==e&&"object"==typeof e&&t in e)return e[t];}return[];}function im(e,t){let n;if("string"==typeof t){if(e.isVertexAI()){if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw Error(`Unsupported string source for Vertex AI: ${t}`);}else if(t.startsWith("files/"))n={fileName:t};else throw Error(`Unsupported string source for Gemini API: ${t}`);}else if(Array.isArray(t)){if(e.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t};}else n=t;let i=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,r=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(r>0||1!==i)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.");}else if(i>0||1!==r)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n;}function ig(e){if("object"!=typeof e||null===e)return{};let t=e.inlinedResponses;if("object"!=typeof t||null===t)return e;let n=t.inlinedResponses;if(!Array.isArray(n)||0===n.length)return e;let i=!1;for(let e of n){if("object"!=typeof e||null===e)continue;let t=e.response;if("object"==typeof t&&null!==t&&void 0!==t.embedding){i=!0;break;}}return i&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),e;}function iy(e,t){if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw Error(`Invalid batch job name: ${t}.`);}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw Error(`Invalid batch job name: ${t}.`);}function iv(e){if("BATCH_STATE_UNSPECIFIED"===e)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===e)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===e)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===e)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===e)return"JOB_STATE_FAILED";if("BATCH_STATE_CANCELLED"===e)return"JOB_STATE_CANCELLED";if("BATCH_STATE_EXPIRED"===e)return"JOB_STATE_EXPIRED";else return e;}function iE(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata","displayName"]);null!=i&&nI(t,["displayName"],i);let r=nS(e,["metadata","state"]);null!=r&&nI(t,["state"],iv(r));let l=nS(e,["metadata","createTime"]);null!=l&&nI(t,["createTime"],l);let o=nS(e,["metadata","endTime"]);null!=o&&nI(t,["endTime"],o);let s=nS(e,["metadata","updateTime"]);null!=s&&nI(t,["updateTime"],s);let a=nS(e,["metadata","model"]);null!=a&&nI(t,["model"],a);let u=nS(e,["metadata","output"]);return null!=u&&nI(t,["dest"],function(e){let t={},n=nS(e,["responsesFile"]);null!=n&&nI(t,["fileName"],n);let i=nS(e,["inlinedResponses","inlinedResponses"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["response"]);null!=n&&nI(t,["response"],function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["content"]);null!=n&&nI(t,["content"],n);let i=nS(e,["citationMetadata"]);null!=i&&nI(t,["citationMetadata"],function(e){let t={},n=nS(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["citations"],e);}return t;}(i));let r=nS(e,["tokenCount"]);null!=r&&nI(t,["tokenCount"],r);let l=nS(e,["finishReason"]);null!=l&&nI(t,["finishReason"],l);let o=nS(e,["avgLogprobs"]);null!=o&&nI(t,["avgLogprobs"],o);let s=nS(e,["groundingMetadata"]);null!=s&&nI(t,["groundingMetadata"],s);let a=nS(e,["index"]);null!=a&&nI(t,["index"],a);let u=nS(e,["logprobsResult"]);null!=u&&nI(t,["logprobsResult"],u);let d=nS(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["safetyRatings"],e);}let p=nS(e,["urlContextMetadata"]);return null!=p&&nI(t,["urlContextMetadata"],p),t;})(e))),nI(t,["candidates"],e);}let r=nS(e,["modelVersion"]);null!=r&&nI(t,["modelVersion"],r);let l=nS(e,["promptFeedback"]);null!=l&&nI(t,["promptFeedback"],l);let o=nS(e,["responseId"]);null!=o&&nI(t,["responseId"],o);let s=nS(e,["usageMetadata"]);return null!=s&&nI(t,["usageMetadata"],s),t;}(n));let i=nS(e,["error"]);return null!=i&&nI(t,["error"],i),t;})(e))),nI(t,["inlinedResponses"],e);}let r=nS(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["inlinedEmbedContentResponses"],e);}return t;}(ig(u))),t;}function i_(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["displayName"]);null!=i&&nI(t,["displayName"],i);let r=nS(e,["state"]);null!=r&&nI(t,["state"],iv(r));let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["createTime"]);null!=o&&nI(t,["createTime"],o);let s=nS(e,["startTime"]);null!=s&&nI(t,["startTime"],s);let a=nS(e,["endTime"]);null!=a&&nI(t,["endTime"],a);let u=nS(e,["updateTime"]);null!=u&&nI(t,["updateTime"],u);let d=nS(e,["model"]);null!=d&&nI(t,["model"],d);let p=nS(e,["inputConfig"]);null!=p&&nI(t,["src"],function(e){let t={},n=nS(e,["instancesFormat"]);null!=n&&nI(t,["format"],n);let i=nS(e,["gcsSource","uris"]);null!=i&&nI(t,["gcsUri"],i);let r=nS(e,["bigquerySource","inputUri"]);return null!=r&&nI(t,["bigqueryUri"],r),t;}(p));let c=nS(e,["outputConfig"]);null!=c&&nI(t,["dest"],function(e){let t={},n=nS(e,["predictionsFormat"]);null!=n&&nI(t,["format"],n);let i=nS(e,["gcsDestination","outputUriPrefix"]);null!=i&&nI(t,["gcsUri"],i);let r=nS(e,["bigqueryDestination","outputUri"]);return null!=r&&nI(t,["bigqueryUri"],r),t;}(ig(c)));let h=nS(e,["completionStats"]);return null!=h&&nI(t,["completionStats"],h),t;}function iI(e){let t={},n=nS(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["mediaResolution"]);null!=n&&nI(t,["mediaResolution"],n);let i=nS(e,["codeExecutionResult"]);null!=i&&nI(t,["codeExecutionResult"],i);let r=nS(e,["executableCode"]);null!=r&&nI(t,["executableCode"],r);let l=nS(e,["fileData"]);null!=l&&nI(t,["fileData"],function(e){let t={};if(void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=nS(e,["fileUri"]);null!=n&&nI(t,["fileUri"],n);let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(l));let o=nS(e,["functionCall"]);null!=o&&nI(t,["functionCall"],function(e){let t={},n=nS(e,["id"]);null!=n&&nI(t,["id"],n);let i=nS(e,["args"]);null!=i&&nI(t,["args"],i);let r=nS(e,["name"]);if(null!=r&&nI(t,["name"],r),void 0!==nS(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==nS(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t;}(o));let s=nS(e,["functionResponse"]);null!=s&&nI(t,["functionResponse"],s);let a=nS(e,["inlineData"]);null!=a&&nI(t,["inlineData"],function(e){let t={},n=nS(e,["data"]);if(null!=n&&nI(t,["data"],n),void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(a));let u=nS(e,["text"]);null!=u&&nI(t,["text"],u);let d=nS(e,["thought"]);null!=d&&nI(t,["thought"],d);let p=nS(e,["thoughtSignature"]);null!=p&&nI(t,["thoughtSignature"],p);let c=nS(e,["videoMetadata"]);return null!=c&&nI(t,["videoMetadata"],c),t;})(e))),nI(t,["parts"],e);}let i=nS(e,["role"]);return null!=i&&nI(t,["role"],i),t;}function iS(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["src"]);null!=r&&nI(n,["batch","inputConfig"],function(e,t){let n={};if(void 0!==nS(t,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==nS(t,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==nS(t,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let i=nS(t,["fileName"]);null!=i&&nI(n,["fileName"],i);let r=nS(t,["inlinedRequests"]);if(null!=r){let t=r;Array.isArray(t)&&(t=t.map(t=>(function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["request","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>iI(e))),nI(n,["request","contents"],e);}let l=nS(t,["metadata"]);null!=l&&nI(n,["metadata"],l);let o=nS(t,["config"]);return null!=o&&nI(n,["request","generationConfig"],function(e,t,n){let i={},r=nS(t,["systemInstruction"]);void 0!==n&&null!=r&&nI(n,["systemInstruction"],iI(ie(r)));let l=nS(t,["temperature"]);null!=l&&nI(i,["temperature"],l);let o=nS(t,["topP"]);null!=o&&nI(i,["topP"],o);let s=nS(t,["topK"]);null!=s&&nI(i,["topK"],s);let a=nS(t,["candidateCount"]);null!=a&&nI(i,["candidateCount"],a);let u=nS(t,["maxOutputTokens"]);null!=u&&nI(i,["maxOutputTokens"],u);let d=nS(t,["stopSequences"]);null!=d&&nI(i,["stopSequences"],d);let p=nS(t,["responseLogprobs"]);null!=p&&nI(i,["responseLogprobs"],p);let c=nS(t,["logprobs"]);null!=c&&nI(i,["logprobs"],c);let h=nS(t,["presencePenalty"]);null!=h&&nI(i,["presencePenalty"],h);let f=nS(t,["frequencyPenalty"]);null!=f&&nI(i,["frequencyPenalty"],f);let m=nS(t,["seed"]);null!=m&&nI(i,["seed"],m);let g=nS(t,["responseMimeType"]);null!=g&&nI(i,["responseMimeType"],g);let y=nS(t,["responseSchema"]);null!=y&&nI(i,["responseSchema"],ir(y));let v=nS(t,["responseJsonSchema"]);if(null!=v&&nI(i,["responseJsonSchema"],v),void 0!==nS(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==nS(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let E=nS(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["category"]);if(null!=n&&nI(t,["category"],n),void 0!==nS(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=nS(e,["threshold"]);return null!=i&&nI(t,["threshold"],i),t;})(e))),nI(n,["safetySettings"],e);}let _=nS(t,["tools"]);if(void 0!==n&&null!=_){let e=ia(_);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["functionDeclarations"],e);}if(void 0!==nS(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=nS(e,["googleSearchRetrieval"]);null!=i&&nI(t,["googleSearchRetrieval"],i);let r=nS(e,["computerUse"]);null!=r&&nI(t,["computerUse"],r);let l=nS(e,["fileSearch"]);null!=l&&nI(t,["fileSearch"],l);let o=nS(e,["codeExecution"]);if(null!=o&&nI(t,["codeExecution"],o),void 0!==nS(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=nS(e,["googleMaps"]);null!=s&&nI(t,["googleMaps"],function(e){let t={};if(void 0!==nS(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=nS(e,["enableWidget"]);return null!=n&&nI(t,["enableWidget"],n),t;}(s));let a=nS(e,["googleSearch"]);null!=a&&nI(t,["googleSearch"],function(e){let t={};if(void 0!==nS(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==nS(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=nS(e,["timeRangeFilter"]);return null!=n&&nI(t,["timeRangeFilter"],n),t;}(a));let u=nS(e,["urlContext"]);return null!=u&&nI(t,["urlContext"],u),t;})(is(e)))),nI(n,["tools"],e);}let I=nS(t,["toolConfig"]);if(void 0!==n&&null!=I&&nI(n,["toolConfig"],function(e){let t={},n=nS(e,["functionCallingConfig"]);null!=n&&nI(t,["functionCallingConfig"],function(e){let t={},n=nS(e,["mode"]);null!=n&&nI(t,["mode"],n);let i=nS(e,["allowedFunctionNames"]);if(null!=i&&nI(t,["allowedFunctionNames"],i),void 0!==nS(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t;}(n));let i=nS(e,["retrievalConfig"]);return null!=i&&nI(t,["retrievalConfig"],i),t;}(I)),void 0!==nS(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let S=nS(t,["cachedContent"]);void 0!==n&&null!=S&&nI(n,["cachedContent"],iu(e,S));let T=nS(t,["responseModalities"]);null!=T&&nI(i,["responseModalities"],T);let A=nS(t,["mediaResolution"]);null!=A&&nI(i,["mediaResolution"],A);let b=nS(t,["speechConfig"]);if(null!=b&&nI(i,["speechConfig"],il(b)),void 0!==nS(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=nS(t,["thinkingConfig"]);null!=C&&nI(i,["thinkingConfig"],C);let O=nS(t,["imageConfig"]);null!=O&&nI(i,["imageConfig"],function(e){let t={},n=nS(e,["aspectRatio"]);null!=n&&nI(t,["aspectRatio"],n);let i=nS(e,["imageSize"]);if(null!=i&&nI(t,["imageSize"],i),void 0!==nS(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==nS(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t;}(O));let R=nS(t,["enableEnhancedCivicAnswers"]);return null!=R&&nI(i,["enableEnhancedCivicAnswers"],R),i;}(e,o,nS(n,["request"],{}))),n;})(e,t))),nI(n,["requests","requests"],t);}return n;}(e,im(e,r)));let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["displayName"]);if(void 0!==t&&null!=n&&nI(t,["batch","displayName"],n),void 0!==nS(e,["dest"]))throw Error("dest parameter is not supported in Gemini API.");}(l,n),n;}(ed=ti||(ti={})).PAGED_ITEM_BATCH_JOBS="batchJobs",ed.PAGED_ITEM_MODELS="models",ed.PAGED_ITEM_TUNING_JOBS="tuningJobs",ed.PAGED_ITEM_FILES="files",ed.PAGED_ITEM_CACHED_CONTENTS="cachedContents",ed.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",ed.PAGED_ITEM_DOCUMENTS="documents";class iT{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i);}init(e,t,n){var i,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=null==t?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};(l=n&&0!==Object.keys(n).length?"object"==typeof n?Object.assign({},n):n:{config:{}}).config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=null!==(r=null===(i=l.config)||void 0===i?void 0:i.pageSize)&&void 0!==r?r:this.pageInternal.length;}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal);}get page(){return this.pageInternal;}get name(){return this.nameInternal;}get pageSize(){return this.pageInternalSize;}get sdkHttpResponse(){return this.sdkHttpResponseInternal;}get params(){return this.paramsInternal;}get pageLength(){return this.pageInternal.length;}getItem(e){return this.pageInternal[e];}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength){if(!this.hasNextPage())return{value:void 0,done:!0};await this.nextPage();}let e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1};},return:async()=>({value:void 0,done:!0})};}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let e=await this.requestInternal(this.params);return this.initNextPage(e),this.page;}hasNextPage(){var e;return(null===(e=this.params.config)||void 0===e?void 0:e.pageToken)!==void 0;}}class iA extends nE{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new iT(ti.PAGED_ITEM_BATCH_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.create=async e=>(this.apiClient.isVertexAI()&&(e.config=this.formatDestination(e.src,e.config)),this.createInternal(e)),this.createEmbeddings=async e=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(e);};}createInlinedGenerateContentRequest(e){let t=iS(this.apiClient,e),n=n_("{model}:batchGenerateContent",t._url),i=t.batch.inputConfig.requests,r=i.requests,l=[];for(let e of r){let t=Object.assign({},e);if(t.systemInstruction){let e=t.systemInstruction;delete t.systemInstruction;let n=t.request;n.systemInstruction=e,t.request=n;}l.push(t);}return i.requests=l,delete t.config,delete t._url,delete t._query,{path:n,body:t};}getGcsUri(e){return"string"==typeof e?e.startsWith("gs://")?e:void 0:!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0?e.gcsUri[0]:void 0;}getBigqueryUri(e){return"string"==typeof e?e.startsWith("bq://")?e:void 0:Array.isArray(e)?void 0:e.bigqueryUri;}formatDestination(e,t){let n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),void 0===n.dest){let t=this.getGcsUri(e),r=this.getBigqueryUri(e);if(t)t.endsWith(".jsonl")?n.dest=`${t.slice(0,-6)}/dest`:n.dest=`${t}_dest_${i}`;else if(r)n.dest=`${r}_dest_${i}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.");}return n;}async createInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["model"],nZ(e,i));let r=nS(t,["src"]);null!=r&&nI(n,["inputConfig"],function(e){let t={},n=nS(e,["format"]);null!=n&&nI(t,["instancesFormat"],n);let i=nS(e,["gcsUri"]);null!=i&&nI(t,["gcsSource","uris"],i);let r=nS(e,["bigqueryUri"]);if(null!=r&&nI(t,["bigquerySource","inputUri"],r),void 0!==nS(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==nS(e,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return t;}(im(e,r)));let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["displayName"]);void 0!==t&&null!=n&&nI(t,["displayName"],n);let i=nS(e,["dest"]);void 0!==t&&null!=i&&nI(t,["outputConfig"],function(e){let t={},n=nS(e,["format"]);null!=n&&nI(t,["predictionsFormat"],n);let i=nS(e,["gcsUri"]);null!=i&&nI(t,["gcsDestination","outputUriPrefix"],i);let r=nS(e,["bigqueryUri"]);if(null!=r&&nI(t,["bigqueryDestination","outputUri"],r),void 0!==nS(e,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==nS(e,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==nS(e,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t;}(function(e){if("string"!=typeof e)return e;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw Error(`Unsupported destination: ${e}`);}(i)));}(l,n),n;}(this.apiClient,e);return l=n_("batchPredictionJobs",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>i_(e));}{let t=iS(this.apiClient,e);return l=n_("{model}:batchGenerateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>iE(e));}}async createEmbeddingsInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["src"]);null!=r&&nI(n,["batch","inputConfig"],function(e,t){let n={},i=nS(t,["fileName"]);null!=i&&nI(n,["file_name"],i);let r=nS(t,["inlinedRequests"]);return null!=r&&nI(n,["requests"],function(e,t){let n={},i=nS(t,["contents"]);if(null!=i){let t=it(e,i);Array.isArray(t)&&(t=t.map(e=>e)),nI(n,["requests[]","request","content"],t);}let r=nS(t,["config"]);return null!=r&&(nI(n,["_self"],function(e,t){let n=nS(e,["taskType"]);void 0!==t&&null!=n&&nI(t,["requests[]","taskType"],n);let i=nS(e,["title"]);void 0!==t&&null!=i&&nI(t,["requests[]","title"],i);let r=nS(e,["outputDimensionality"]);if(void 0!==t&&null!=r&&nI(t,["requests[]","outputDimensionality"],r),void 0!==nS(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==nS(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{};}(r,n)),function(e,t){for(let[n,i]of Object.entries(t)){let t=n.split("."),r=i.split("."),l=new Set,o=-1;for(let e=0;e<t.length;e++)if("*"===t[e]){o=e;break;}if(-1!==o&&r.length>o)for(let e=o;e<r.length;e++){let t=r[e];"*"===t||t.endsWith("[]")||t.endsWith("[0]")||l.add(t);}(function e(t,n,i,r,l){if(r>=n.length||"object"!=typeof t||null===t)return;let o=n[r];if(o.endsWith("[]")){let s=o.slice(0,-2);if(s in t&&Array.isArray(t[s]))for(let o of t[s])e(o,n,i,r+1,l);}else if("*"===o){if("object"==typeof t&&null!==t&&!Array.isArray(t)){let e=Object.keys(t).filter(e=>!e.startsWith("_")&&!l.has(e)),n={};for(let i of e)n[i]=t[i];for(let[e,l]of Object.entries(n)){let n=[];for(let t of i.slice(r))"*"===t?n.push(e):n.push(t);nI(t,n,l);}for(let n of e)delete t[n];}}else o in t&&e(t[o],n,i,r+1,l);})(e,t,r,0,l);}}(n,{"requests[].*":"requests[].request.*"})),n;}(e,r)),n;}(e,r));let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["displayName"]);void 0!==t&&null!=n&&nI(t,["batch","displayName"],n);}(l,n),n;}(this.apiClient,e);return i=n_("{model}:asyncBatchEmbedContent",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>iE(e));}}async get(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);return l=n_("batchPredictionJobs/{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>i_(e));}{let t=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);return l=n_("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>iE(e));}}async cancel(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);l=n_("batchPredictionJobs/{name}:cancel",i._url),o=i._query,delete i._url,delete i._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal});}else{let t=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);l=n_("batches/{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,await this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal});}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);let r=nS(e,["filter"]);void 0!==t&&null!=r&&nI(t,["_query","filter"],r);}(n,t),t;}(e);return l=n_("batchPredictionJobs",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["batchPredictionJobs"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>i_(e))),nI(t,["batchJobs"],e);}return t;}(e),n=new nW;return Object.assign(n,t),n;});}{let t=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);if(void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i),void 0!==nS(e,["filter"]))throw Error("filter parameter is not supported in Gemini API.");}(n,t),t;}(e);return l=n_("batches",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["operations"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>iE(e))),nI(t,["batchJobs"],e);}return t;}(e),n=new nW;return Object.assign(n,t),n;});}}async delete(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);return l=n_("batchPredictionJobs/{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["name"]);null!=i&&nI(t,["name"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);return null!=l&&nI(t,["error"],l),t;})(e));}{let t=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iy(e,i)),n;}(this.apiClient,e);return l=n_("batches/{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["name"]);null!=i&&nI(t,["name"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);return null!=l&&nI(t,["error"],l),t;})(e));}}}function ib(e){let t={},n=nS(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["mediaResolution"]);null!=n&&nI(t,["mediaResolution"],n);let i=nS(e,["codeExecutionResult"]);null!=i&&nI(t,["codeExecutionResult"],i);let r=nS(e,["executableCode"]);null!=r&&nI(t,["executableCode"],r);let l=nS(e,["fileData"]);null!=l&&nI(t,["fileData"],function(e){let t={};if(void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=nS(e,["fileUri"]);null!=n&&nI(t,["fileUri"],n);let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(l));let o=nS(e,["functionCall"]);null!=o&&nI(t,["functionCall"],function(e){let t={},n=nS(e,["id"]);null!=n&&nI(t,["id"],n);let i=nS(e,["args"]);null!=i&&nI(t,["args"],i);let r=nS(e,["name"]);if(null!=r&&nI(t,["name"],r),void 0!==nS(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==nS(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t;}(o));let s=nS(e,["functionResponse"]);null!=s&&nI(t,["functionResponse"],s);let a=nS(e,["inlineData"]);null!=a&&nI(t,["inlineData"],function(e){let t={},n=nS(e,["data"]);if(null!=n&&nI(t,["data"],n),void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(a));let u=nS(e,["text"]);null!=u&&nI(t,["text"],u);let d=nS(e,["thought"]);null!=d&&nI(t,["thought"],d);let p=nS(e,["thoughtSignature"]);null!=p&&nI(t,["thoughtSignature"],p);let c=nS(e,["videoMetadata"]);return null!=c&&nI(t,["videoMetadata"],c),t;})(e))),nI(t,["parts"],e);}let i=nS(e,["role"]);return null!=i&&nI(t,["role"],i),t;}class iC extends nE{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new iT(ti.PAGED_ITEM_CACHED_CONTENTS,e=>this.listInternal(e),await this.listInternal(e),e);}async create(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["model"],n0(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["ttl"]);void 0!==t&&null!=n&&nI(t,["ttl"],n);let i=nS(e,["expireTime"]);void 0!==t&&null!=i&&nI(t,["expireTime"],i);let r=nS(e,["displayName"]);void 0!==t&&null!=r&&nI(t,["displayName"],r);let l=nS(e,["contents"]);if(void 0!==t&&null!=l){let e=ii(l);Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["contents"],e);}let o=nS(e,["systemInstruction"]);void 0!==t&&null!=o&&nI(t,["systemInstruction"],ie(o));let s=nS(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==nS(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=nS(e,["description"]);null!=n&&nI(t,["description"],n);let i=nS(e,["name"]);null!=i&&nI(t,["name"],i);let r=nS(e,["parameters"]);null!=r&&nI(t,["parameters"],r);let l=nS(e,["parametersJsonSchema"]);null!=l&&nI(t,["parametersJsonSchema"],l);let o=nS(e,["response"]);null!=o&&nI(t,["response"],o);let s=nS(e,["responseJsonSchema"]);return null!=s&&nI(t,["responseJsonSchema"],s),t;})(e))),nI(t,["functionDeclarations"],e);}let i=nS(e,["retrieval"]);null!=i&&nI(t,["retrieval"],i);let r=nS(e,["googleSearchRetrieval"]);null!=r&&nI(t,["googleSearchRetrieval"],r);let l=nS(e,["computerUse"]);if(null!=l&&nI(t,["computerUse"],l),void 0!==nS(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=nS(e,["codeExecution"]);null!=o&&nI(t,["codeExecution"],o);let s=nS(e,["enterpriseWebSearch"]);null!=s&&nI(t,["enterpriseWebSearch"],s);let a=nS(e,["googleMaps"]);null!=a&&nI(t,["googleMaps"],a);let u=nS(e,["googleSearch"]);null!=u&&nI(t,["googleSearch"],u);let d=nS(e,["urlContext"]);return null!=d&&nI(t,["urlContext"],d),t;})(e))),nI(t,["tools"],e);}let a=nS(e,["toolConfig"]);void 0!==t&&null!=a&&nI(t,["toolConfig"],a);let u=nS(e,["kmsKeyName"]);void 0!==t&&null!=u&&nI(t,["encryption_spec","kmsKeyName"],u);}(r,n),n;}(this.apiClient,e);return l=n_("cachedContents",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["model"],n0(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["ttl"]);void 0!==t&&null!=n&&nI(t,["ttl"],n);let i=nS(e,["expireTime"]);void 0!==t&&null!=i&&nI(t,["expireTime"],i);let r=nS(e,["displayName"]);void 0!==t&&null!=r&&nI(t,["displayName"],r);let l=nS(e,["contents"]);if(void 0!==t&&null!=l){let e=ii(l);Array.isArray(e)&&(e=e.map(e=>ib(e))),nI(t,["contents"],e);}let o=nS(e,["systemInstruction"]);void 0!==t&&null!=o&&nI(t,["systemInstruction"],ib(ie(o)));let s=nS(e,["tools"]);if(void 0!==t&&null!=s){let e=s;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["functionDeclarations"],e);}if(void 0!==nS(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=nS(e,["googleSearchRetrieval"]);null!=i&&nI(t,["googleSearchRetrieval"],i);let r=nS(e,["computerUse"]);null!=r&&nI(t,["computerUse"],r);let l=nS(e,["fileSearch"]);null!=l&&nI(t,["fileSearch"],l);let o=nS(e,["codeExecution"]);if(null!=o&&nI(t,["codeExecution"],o),void 0!==nS(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=nS(e,["googleMaps"]);null!=s&&nI(t,["googleMaps"],function(e){let t={};if(void 0!==nS(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=nS(e,["enableWidget"]);return null!=n&&nI(t,["enableWidget"],n),t;}(s));let a=nS(e,["googleSearch"]);null!=a&&nI(t,["googleSearch"],function(e){let t={};if(void 0!==nS(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==nS(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=nS(e,["timeRangeFilter"]);return null!=n&&nI(t,["timeRangeFilter"],n),t;}(a));let u=nS(e,["urlContext"]);return null!=u&&nI(t,["urlContext"],u),t;})(e))),nI(t,["tools"],e);}let a=nS(e,["toolConfig"]);if(void 0!==t&&null!=a&&nI(t,["toolConfig"],function(e){let t={},n=nS(e,["functionCallingConfig"]);null!=n&&nI(t,["functionCallingConfig"],function(e){let t={},n=nS(e,["mode"]);null!=n&&nI(t,["mode"],n);let i=nS(e,["allowedFunctionNames"]);if(null!=i&&nI(t,["allowedFunctionNames"],i),void 0!==nS(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t;}(n));let i=nS(e,["retrievalConfig"]);return null!=i&&nI(t,["retrievalConfig"],i),t;}(a)),void 0!==nS(e,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.");}(r,n),n;}(this.apiClient,e);return l=n_("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e);}}async get(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iu(e,i)),n;}(this.apiClient,e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}{let t=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iu(e,i)),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e);}}async delete(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iu(e,i)),n;}(this.apiClient,e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nH;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["name"]);return null!=i&&nI(n,["_url","name"],iu(e,i)),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nH;return Object.assign(n,t),n;});}}async update(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["name"]);null!=i&&nI(n,["_url","name"],iu(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["ttl"]);void 0!==t&&null!=n&&nI(t,["ttl"],n);let i=nS(e,["expireTime"]);void 0!==t&&null!=i&&nI(t,["expireTime"],i);}(r,n),n;}(this.apiClient,e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}{let t=function(e,t){let n={},i=nS(t,["name"]);null!=i&&nI(n,["_url","name"],iu(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["ttl"]);void 0!==t&&null!=n&&nI(t,["ttl"],n);let i=nS(e,["expireTime"]);void 0!==t&&null!=i&&nI(t,["expireTime"],i);}(r,n),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>e);}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);}(n,t),t;}(e);return l=n_("cachedContents",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["cachedContents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["cachedContents"],e);}return t;}(e),n=new nj;return Object.assign(n,t),n;});}{let t=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);}(n,t),t;}(e);return l=n_("cachedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["cachedContents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["cachedContents"],e);}return t;}(e),n=new nj;return Object.assign(n,t),n;});}}}function iO(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]]);return n;}function iR(e){return this instanceof iR?(this.v=e,this):new iR(e);}function iN(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),l=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",function(e){return function(t){return Promise.resolve(t).then(e,u);};}),i[Symbol.asyncIterator]=function(){return this;},i;function o(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,i){l.push([e,t,n,i])>1||s(e,t);});},t&&(i[e]=t(i[e])));}function s(e,t){try{var n;(n=r[e](t)).value instanceof iR?Promise.resolve(n.value.v).then(a,u):d(l[0][2],n);}catch(e){d(l[0][3],e);}}function a(e){s("next",e);}function u(e){s("throw",e);}function d(e,t){e(t),l.shift(),l.length&&s(l[0][0],l[0][1]);}}function iP(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e};}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.");}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this;},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){!function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n});},t);}(i,r,(t=e[n](t)).done,t.value);});};}}function iw(e){if(void 0===e.parts||0===e.parts.length)return!1;for(let t of e.parts)if(void 0===t||0===Object.keys(t).length)return!1;return!0;}function iM(e){if(void 0===e||0===e.length)return[];let t=[],n=e.length,i=0;for(;i<n;)if("user"===e[i].role)t.push(e[i]),i++;else{let r=[],l=!0;for(;i<n&&"model"===e[i].role;)r.push(e[i]),l&&!iw(e[i])&&(l=!1),i++;l?t.push(...r):t.pop();}return t;}"function"==typeof SuppressedError&&SuppressedError;class iD{constructor(e,t){this.modelsModule=e,this.apiClient=t;}create(e){return new ix(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history));}}class ix{constructor(e,t,n,i={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=r,this.sendPromise=Promise.resolve(),function(e){if(0!==e.length){for(let t of e)if("user"!==t.role&&"model"!==t.role)throw Error(`Role must be user or model, but got ${t.role}.`);}}(r);}async sendMessage(e){var t;await this.sendPromise;let n=ie(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});return this.sendPromise=(async()=>{var e,t,r;let l=await i,o=null===(t=null===(e=l.candidates)||void 0===e?void 0:e[0])||void 0===t?void 0:t.content,s=l.automaticFunctionCallingHistory,a=this.getHistory(!0).length,u=[];null!=s&&(u=null!==(r=s.slice(a))&&void 0!==r?r:[]),this.recordHistory(n,o?[o]:[],u);})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve();}),i;}async sendMessageStream(e){var t;await this.sendPromise;let n=ie(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:null!==(t=e.config)&&void 0!==t?t:this.config});this.sendPromise=i.then(()=>void 0).catch(()=>void 0);let r=await i;return this.processStreamResponse(r,n);}getHistory(e=!1){return structuredClone(e?iM(this.history):this.history);}processStreamResponse(e,t){return iN(this,arguments,function*(){let n=[];try{for(var i,r,l,o,s,a,u,d=!0,p=iP(e);!(i=(u=yield iR(p.next())).done);d=!0){if(o=u.value,d=!1,function(e){var t;if(void 0==e.candidates||0===e.candidates.length)return!1;let n=null===(t=e.candidates[0])||void 0===t?void 0:t.content;return void 0!==n&&iw(n);}(o)){let e=null===(a=null===(s=o.candidates)||void 0===s?void 0:s[0])||void 0===a?void 0:a.content;void 0!==e&&n.push(e);}yield yield iR(o);}}catch(e){r={error:e};}finally{try{!d&&!i&&(l=p.return)&&(yield iR(l.call(p)));}finally{if(r)throw r.error;}}this.recordHistory(t,n);});}recordHistory(e,t,n){let i=[];t.length>0&&t.every(e=>void 0!==e.role)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...iM(n)):this.history.push(e),this.history.push(...i);}}class iU extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,iU.prototype);}}class ik extends nE{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new iT(ti.PAGED_ITEM_FILES,e=>this.listInternal(e),await this.listInternal(e),e);}async upload(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(e=>e);}async download(e){await this.apiClient.downloadFile(e);}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);}(n,t),t;}(e);return i=n_("files",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["files"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["files"],e);}return t;}(e),n=new n$;return Object.assign(n,t),n;});}}async createInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["file"]);return null!=n&&nI(t,["file"],n),t;}(e);return i=n_("upload/v1beta/files",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nY;return Object.assign(n,t),n;});}}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);return null!=n&&nI(t,["_url","file"],ip(n)),t;}(e);return i=n_("files/{file}",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);return null!=n&&nI(t,["_url","file"],ip(n)),t;}(e);return i=n_("files/{file}",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nK;return Object.assign(n,t),n;});}}}function iL(e){let t={},n=nS(e,["data"]);if(null!=n&&nI(t,["data"],n),void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}function iq(e){let t={},n=nS(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["mediaResolution"]);null!=n&&nI(t,["mediaResolution"],n);let i=nS(e,["codeExecutionResult"]);null!=i&&nI(t,["codeExecutionResult"],i);let r=nS(e,["executableCode"]);null!=r&&nI(t,["executableCode"],r);let l=nS(e,["fileData"]);null!=l&&nI(t,["fileData"],function(e){let t={};if(void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=nS(e,["fileUri"]);null!=n&&nI(t,["fileUri"],n);let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(l));let o=nS(e,["functionCall"]);null!=o&&nI(t,["functionCall"],function(e){let t={},n=nS(e,["id"]);null!=n&&nI(t,["id"],n);let i=nS(e,["args"]);null!=i&&nI(t,["args"],i);let r=nS(e,["name"]);if(null!=r&&nI(t,["name"],r),void 0!==nS(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==nS(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t;}(o));let s=nS(e,["functionResponse"]);null!=s&&nI(t,["functionResponse"],s);let a=nS(e,["inlineData"]);null!=a&&nI(t,["inlineData"],function(e){let t={},n=nS(e,["data"]);if(null!=n&&nI(t,["data"],n),void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(a));let u=nS(e,["text"]);null!=u&&nI(t,["text"],u);let d=nS(e,["thought"]);null!=d&&nI(t,["thought"],d);let p=nS(e,["thoughtSignature"]);null!=p&&nI(t,["thoughtSignature"],p);let c=nS(e,["videoMetadata"]);return null!=c&&nI(t,["videoMetadata"],c),t;})(e))),nI(t,["parts"],e);}let i=nS(e,["role"]);return null!=i&&nI(t,["role"],i),t;}function iG(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>iq(e))),nI(n,["contents"],e);}let l=nS(t,["config"]);return null!=l&&nI(n,["generationConfig"],function(e,t,n){let i={},r=nS(t,["systemInstruction"]);void 0!==n&&null!=r&&nI(n,["systemInstruction"],iq(ie(r)));let l=nS(t,["temperature"]);null!=l&&nI(i,["temperature"],l);let o=nS(t,["topP"]);null!=o&&nI(i,["topP"],o);let s=nS(t,["topK"]);null!=s&&nI(i,["topK"],s);let a=nS(t,["candidateCount"]);null!=a&&nI(i,["candidateCount"],a);let u=nS(t,["maxOutputTokens"]);null!=u&&nI(i,["maxOutputTokens"],u);let d=nS(t,["stopSequences"]);null!=d&&nI(i,["stopSequences"],d);let p=nS(t,["responseLogprobs"]);null!=p&&nI(i,["responseLogprobs"],p);let c=nS(t,["logprobs"]);null!=c&&nI(i,["logprobs"],c);let h=nS(t,["presencePenalty"]);null!=h&&nI(i,["presencePenalty"],h);let f=nS(t,["frequencyPenalty"]);null!=f&&nI(i,["frequencyPenalty"],f);let m=nS(t,["seed"]);null!=m&&nI(i,["seed"],m);let g=nS(t,["responseMimeType"]);null!=g&&nI(i,["responseMimeType"],g);let y=nS(t,["responseSchema"]);null!=y&&nI(i,["responseSchema"],ir(y));let v=nS(t,["responseJsonSchema"]);if(null!=v&&nI(i,["responseJsonSchema"],v),void 0!==nS(t,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==nS(t,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let E=nS(t,["safetySettings"]);if(void 0!==n&&null!=E){let e=E;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["category"]);if(null!=n&&nI(t,["category"],n),void 0!==nS(e,["method"]))throw Error("method parameter is not supported in Gemini API.");let i=nS(e,["threshold"]);return null!=i&&nI(t,["threshold"],i),t;})(e))),nI(n,["safetySettings"],e);}let _=nS(t,["tools"]);if(void 0!==n&&null!=_){let e=ia(_);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["functionDeclarations"],e);}if(void 0!==nS(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=nS(e,["googleSearchRetrieval"]);null!=i&&nI(t,["googleSearchRetrieval"],i);let r=nS(e,["computerUse"]);null!=r&&nI(t,["computerUse"],r);let l=nS(e,["fileSearch"]);null!=l&&nI(t,["fileSearch"],l);let o=nS(e,["codeExecution"]);if(null!=o&&nI(t,["codeExecution"],o),void 0!==nS(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=nS(e,["googleMaps"]);null!=s&&nI(t,["googleMaps"],function(e){let t={};if(void 0!==nS(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=nS(e,["enableWidget"]);return null!=n&&nI(t,["enableWidget"],n),t;}(s));let a=nS(e,["googleSearch"]);null!=a&&nI(t,["googleSearch"],function(e){let t={};if(void 0!==nS(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==nS(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=nS(e,["timeRangeFilter"]);return null!=n&&nI(t,["timeRangeFilter"],n),t;}(a));let u=nS(e,["urlContext"]);return null!=u&&nI(t,["urlContext"],u),t;})(is(e)))),nI(n,["tools"],e);}let I=nS(t,["toolConfig"]);if(void 0!==n&&null!=I&&nI(n,["toolConfig"],function(e){let t={},n=nS(e,["functionCallingConfig"]);null!=n&&nI(t,["functionCallingConfig"],function(e){let t={},n=nS(e,["mode"]);null!=n&&nI(t,["mode"],n);let i=nS(e,["allowedFunctionNames"]);if(null!=i&&nI(t,["allowedFunctionNames"],i),void 0!==nS(e,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t;}(n));let i=nS(e,["retrievalConfig"]);return null!=i&&nI(t,["retrievalConfig"],i),t;}(I)),void 0!==nS(t,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let S=nS(t,["cachedContent"]);void 0!==n&&null!=S&&nI(n,["cachedContent"],iu(e,S));let T=nS(t,["responseModalities"]);null!=T&&nI(i,["responseModalities"],T);let A=nS(t,["mediaResolution"]);null!=A&&nI(i,["mediaResolution"],A);let b=nS(t,["speechConfig"]);if(null!=b&&nI(i,["speechConfig"],il(b)),void 0!==nS(t,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let C=nS(t,["thinkingConfig"]);null!=C&&nI(i,["thinkingConfig"],C);let O=nS(t,["imageConfig"]);null!=O&&nI(i,["imageConfig"],function(e){let t={},n=nS(e,["aspectRatio"]);null!=n&&nI(t,["aspectRatio"],n);let i=nS(e,["imageSize"]);if(null!=i&&nI(t,["imageSize"],i),void 0!==nS(e,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==nS(e,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return t;}(O));let R=nS(t,["enableEnhancedCivicAnswers"]);return null!=R&&nI(i,["enableEnhancedCivicAnswers"],R),i;}(e,l,n)),n;}function iH(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>e)),nI(n,["contents"],e);}let l=nS(t,["config"]);return null!=l&&nI(n,["generationConfig"],function(e,t,n){let i={},r=nS(t,["systemInstruction"]);void 0!==n&&null!=r&&nI(n,["systemInstruction"],ie(r));let l=nS(t,["temperature"]);null!=l&&nI(i,["temperature"],l);let o=nS(t,["topP"]);null!=o&&nI(i,["topP"],o);let s=nS(t,["topK"]);null!=s&&nI(i,["topK"],s);let a=nS(t,["candidateCount"]);null!=a&&nI(i,["candidateCount"],a);let u=nS(t,["maxOutputTokens"]);null!=u&&nI(i,["maxOutputTokens"],u);let d=nS(t,["stopSequences"]);null!=d&&nI(i,["stopSequences"],d);let p=nS(t,["responseLogprobs"]);null!=p&&nI(i,["responseLogprobs"],p);let c=nS(t,["logprobs"]);null!=c&&nI(i,["logprobs"],c);let h=nS(t,["presencePenalty"]);null!=h&&nI(i,["presencePenalty"],h);let f=nS(t,["frequencyPenalty"]);null!=f&&nI(i,["frequencyPenalty"],f);let m=nS(t,["seed"]);null!=m&&nI(i,["seed"],m);let g=nS(t,["responseMimeType"]);null!=g&&nI(i,["responseMimeType"],g);let y=nS(t,["responseSchema"]);null!=y&&nI(i,["responseSchema"],ir(y));let v=nS(t,["responseJsonSchema"]);null!=v&&nI(i,["responseJsonSchema"],v);let E=nS(t,["routingConfig"]);null!=E&&nI(i,["routingConfig"],E);let _=nS(t,["modelSelectionConfig"]);null!=_&&nI(i,["modelConfig"],_);let I=nS(t,["safetySettings"]);if(void 0!==n&&null!=I){let e=I;Array.isArray(e)&&(e=e.map(e=>e)),nI(n,["safetySettings"],e);}let S=nS(t,["tools"]);if(void 0!==n&&null!=S){let e=ia(S);Array.isArray(e)&&(e=e.map(e=>iX(is(e)))),nI(n,["tools"],e);}let T=nS(t,["toolConfig"]);void 0!==n&&null!=T&&nI(n,["toolConfig"],T);let A=nS(t,["labels"]);void 0!==n&&null!=A&&nI(n,["labels"],A);let b=nS(t,["cachedContent"]);void 0!==n&&null!=b&&nI(n,["cachedContent"],iu(e,b));let C=nS(t,["responseModalities"]);null!=C&&nI(i,["responseModalities"],C);let O=nS(t,["mediaResolution"]);null!=O&&nI(i,["mediaResolution"],O);let R=nS(t,["speechConfig"]);null!=R&&nI(i,["speechConfig"],il(R));let N=nS(t,["audioTimestamp"]);null!=N&&nI(i,["audioTimestamp"],N);let P=nS(t,["thinkingConfig"]);null!=P&&nI(i,["thinkingConfig"],P);let w=nS(t,["imageConfig"]);if(null!=w&&nI(i,["imageConfig"],function(e){let t={},n=nS(e,["aspectRatio"]);null!=n&&nI(t,["aspectRatio"],n);let i=nS(e,["imageSize"]);null!=i&&nI(t,["imageSize"],i);let r=nS(e,["outputMimeType"]);null!=r&&nI(t,["imageOutputOptions","mimeType"],r);let l=nS(e,["outputCompressionQuality"]);return null!=l&&nI(t,["imageOutputOptions","compressionQuality"],l),t;}(w)),void 0!==nS(t,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i;}(e,l,n)),n;}function ij(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["content"]);null!=n&&nI(t,["content"],n);let i=nS(e,["citationMetadata"]);null!=i&&nI(t,["citationMetadata"],function(e){let t={},n=nS(e,["citationSources"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["citations"],e);}return t;}(i));let r=nS(e,["tokenCount"]);null!=r&&nI(t,["tokenCount"],r);let l=nS(e,["finishReason"]);null!=l&&nI(t,["finishReason"],l);let o=nS(e,["avgLogprobs"]);null!=o&&nI(t,["avgLogprobs"],o);let s=nS(e,["groundingMetadata"]);null!=s&&nI(t,["groundingMetadata"],s);let a=nS(e,["index"]);null!=a&&nI(t,["index"],a);let u=nS(e,["logprobsResult"]);null!=u&&nI(t,["logprobsResult"],u);let d=nS(e,["safetyRatings"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["safetyRatings"],e);}let p=nS(e,["urlContextMetadata"]);return null!=p&&nI(t,["urlContextMetadata"],p),t;})(e))),nI(t,["candidates"],e);}let r=nS(e,["modelVersion"]);null!=r&&nI(t,["modelVersion"],r);let l=nS(e,["promptFeedback"]);null!=l&&nI(t,["promptFeedback"],l);let o=nS(e,["responseId"]);null!=o&&nI(t,["responseId"],o);let s=nS(e,["usageMetadata"]);return null!=s&&nI(t,["usageMetadata"],s),t;}function iF(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["candidates"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["candidates"],e);}let r=nS(e,["createTime"]);null!=r&&nI(t,["createTime"],r);let l=nS(e,["modelVersion"]);null!=l&&nI(t,["modelVersion"],l);let o=nS(e,["promptFeedback"]);null!=o&&nI(t,["promptFeedback"],o);let s=nS(e,["responseId"]);null!=s&&nI(t,["responseId"],s);let a=nS(e,["usageMetadata"]);return null!=a&&nI(t,["usageMetadata"],a),t;}function iV(e){let t={},n=nS(e,["_self"]);null!=n&&nI(t,["image"],iB(n));let i=nS(e,["raiFilteredReason"]);null!=i&&nI(t,["raiFilteredReason"],i);let r=nS(e,["_self"]);null!=r&&nI(t,["safetyAttributes"],iz(r));let l=nS(e,["prompt"]);return null!=l&&nI(t,["enhancedPrompt"],l),t;}function iB(e){let t={},n=nS(e,["gcsUri"]);null!=n&&nI(t,["gcsUri"],n);let i=nS(e,["bytesBase64Encoded"]);null!=i&&nI(t,["imageBytes"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["mimeType"],r),t;}function iJ(e){let t={};if(void 0!==nS(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let n=nS(e,["imageBytes"]);null!=n&&nI(t,["bytesBase64Encoded"],nT(n));let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}function i$(e){let t={},n=nS(e,["gcsUri"]);null!=n&&nI(t,["gcsUri"],n);let i=nS(e,["imageBytes"]);null!=i&&nI(t,["bytesBase64Encoded"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["mimeType"],r),t;}function iY(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["displayName"]);null!=i&&nI(t,["displayName"],i);let r=nS(e,["description"]);null!=r&&nI(t,["description"],r);let l=nS(e,["version"]);null!=l&&nI(t,["version"],l);let o=nS(e,["_self"]);null!=o&&nI(t,["tunedModelInfo"],function(e){let t={},n=nS(e,["baseModel"]);null!=n&&nI(t,["baseModel"],n);let i=nS(e,["createTime"]);null!=i&&nI(t,["createTime"],i);let r=nS(e,["updateTime"]);return null!=r&&nI(t,["updateTime"],r),t;}(o));let s=nS(e,["inputTokenLimit"]);null!=s&&nI(t,["inputTokenLimit"],s);let a=nS(e,["outputTokenLimit"]);null!=a&&nI(t,["outputTokenLimit"],a);let u=nS(e,["supportedGenerationMethods"]);null!=u&&nI(t,["supportedActions"],u);let d=nS(e,["temperature"]);null!=d&&nI(t,["temperature"],d);let p=nS(e,["maxTemperature"]);null!=p&&nI(t,["maxTemperature"],p);let c=nS(e,["topP"]);null!=c&&nI(t,["topP"],c);let h=nS(e,["topK"]);null!=h&&nI(t,["topK"],h);let f=nS(e,["thinking"]);return null!=f&&nI(t,["thinking"],f),t;}function iK(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["displayName"]);null!=i&&nI(t,["displayName"],i);let r=nS(e,["description"]);null!=r&&nI(t,["description"],r);let l=nS(e,["versionId"]);null!=l&&nI(t,["version"],l);let o=nS(e,["deployedModels"]);if(null!=o){let e=o;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["endpoint"]);null!=n&&nI(t,["name"],n);let i=nS(e,["deployedModelId"]);return null!=i&&nI(t,["deployedModelId"],i),t;})(e))),nI(t,["endpoints"],e);}let s=nS(e,["labels"]);null!=s&&nI(t,["labels"],s);let a=nS(e,["_self"]);null!=a&&nI(t,["tunedModelInfo"],function(e){let t={},n=nS(e,["labels","google-vertex-llm-tuning-base-model-id"]);null!=n&&nI(t,["baseModel"],n);let i=nS(e,["createTime"]);null!=i&&nI(t,["createTime"],i);let r=nS(e,["updateTime"]);return null!=r&&nI(t,["updateTime"],r),t;}(a));let u=nS(e,["defaultCheckpointId"]);null!=u&&nI(t,["defaultCheckpointId"],u);let d=nS(e,["checkpoints"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["checkpoints"],e);}return t;}function iW(e){let t={},n=nS(e,["safetyAttributes","categories"]);null!=n&&nI(t,["categories"],n);let i=nS(e,["safetyAttributes","scores"]);null!=i&&nI(t,["scores"],i);let r=nS(e,["contentType"]);return null!=r&&nI(t,["contentType"],r),t;}function iz(e){let t={},n=nS(e,["safetyAttributes","categories"]);null!=n&&nI(t,["categories"],n);let i=nS(e,["safetyAttributes","scores"]);null!=i&&nI(t,["scores"],i);let r=nS(e,["contentType"]);return null!=r&&nI(t,["contentType"],r),t;}function iX(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==nS(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=nS(e,["description"]);null!=n&&nI(t,["description"],n);let i=nS(e,["name"]);null!=i&&nI(t,["name"],i);let r=nS(e,["parameters"]);null!=r&&nI(t,["parameters"],r);let l=nS(e,["parametersJsonSchema"]);null!=l&&nI(t,["parametersJsonSchema"],l);let o=nS(e,["response"]);null!=o&&nI(t,["response"],o);let s=nS(e,["responseJsonSchema"]);return null!=s&&nI(t,["responseJsonSchema"],s),t;})(e))),nI(t,["functionDeclarations"],e);}let i=nS(e,["retrieval"]);null!=i&&nI(t,["retrieval"],i);let r=nS(e,["googleSearchRetrieval"]);null!=r&&nI(t,["googleSearchRetrieval"],r);let l=nS(e,["computerUse"]);if(null!=l&&nI(t,["computerUse"],l),void 0!==nS(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=nS(e,["codeExecution"]);null!=o&&nI(t,["codeExecution"],o);let s=nS(e,["enterpriseWebSearch"]);null!=s&&nI(t,["enterpriseWebSearch"],s);let a=nS(e,["googleMaps"]);null!=a&&nI(t,["googleMaps"],a);let u=nS(e,["googleSearch"]);null!=u&&nI(t,["googleSearch"],u);let d=nS(e,["urlContext"]);return null!=d&&nI(t,["urlContext"],d),t;}function iQ(e){let t={},n=nS(e,["uri"]);null!=n&&nI(t,["uri"],n);let i=nS(e,["videoBytes"]);null!=i&&nI(t,["encodedVideo"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["encoding"],r),t;}function iZ(e){let t={},n=nS(e,["uri"]);null!=n&&nI(t,["gcsUri"],n);let i=nS(e,["videoBytes"]);null!=i&&nI(t,["bytesBase64Encoded"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["mimeType"],r),t;}function i0(e,t){let n=nS(e,["mimeType"]);void 0!==t&&null!=n&&nI(t,["mimeType"],n);let i=nS(e,["displayName"]);void 0!==t&&null!=i&&nI(t,["displayName"],i);let r=nS(e,["customMetadata"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["customMetadata"],e);}let l=nS(e,["chunkingConfig"]);return void 0!==t&&null!=l&&nI(t,["chunkingConfig"],l),{};}let i1="x-goog-api-client";class i2{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});let i={};this.clientOptions.vertexai?(i.apiVersion=null!==(t=this.clientOptions.apiVersion)&&void 0!==t?t:"v1beta1",i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=null!==(n=this.clientOptions.apiVersion)&&void 0!==n?n:"v1beta",i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions));}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/";}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return;}this.clientOptions.project=void 0,this.clientOptions.location=void 0;}isVertexAI(){var e;return null!==(e=this.clientOptions.vertexai)&&void 0!==e&&e;}getProject(){return this.clientOptions.project;}getLocation(){return this.clientOptions.location;}async getAuthHeaders(){let e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e;}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.");}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.");}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions);}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.");}getRequestUrlInternal(e){if(!e||void 0===e.baseUrl||void 0===e.apiVersion)throw Error("HTTP options are not correctly set.");let t=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&""!==e.apiVersion&&t.push(e.apiVersion),t.join("/");}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`;}getApiKey(){return this.clientOptions.apiKey;}getWebsocketBaseUrl(){let e=new URL(this.getBaseUrl());return e.protocol="http:"==e.protocol?"ws":"wss",e.toString();}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw Error("HTTP options are not correctly set.");}constructUrl(e,t,n){let i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),""!==e&&i.push(e),new URL(`${i.join("/")}`);}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||"GET"===e.httpMethod&&e.path.startsWith("publishers/google/models"));}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(let[t,n]of Object.entries(e.queryParams))i.searchParams.append(t,String(n));let r={};if("GET"===e.httpMethod){if(e.body&&"{}"!==e.body)throw Error("Request body should be empty for GET request, but got non empty request body");}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.unaryApiCall(i,r,e.httpMethod);}patchHttpOptions(e,t){let n=JSON.parse(JSON.stringify(e));for(let[e,i]of Object.entries(t))"object"==typeof i?n[e]=Object.assign(Object.assign({},n[e]),i):void 0!==i&&(n[e]=i);return n;}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));let n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);i.searchParams.has("alt")&&"sse"===i.searchParams.get("alt")||i.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,i.toString(),e.abortSignal),this.streamApiCall(i,r,e.httpMethod);}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){let n=new AbortController,r=n.signal;if(t.timeout&&(null==t?void 0:t.timeout)>0){let e=setTimeout(()=>n.abort(),t.timeout);e&&"function"==typeof e.unref&&e.unref();}i&&i.addEventListener("abort",()=>{n.abort();}),e.signal=r;}return t&&null!==t.extraBody&&function(e,t){if(!t||0===Object.keys(t).length)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return;}let n={};if("string"==typeof e.body&&e.body.length>0)try{let t=JSON.parse(e.body);if("object"!=typeof t||null===t||Array.isArray(t)){console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return;}n=t;}catch(e){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return;}let i=function e(t,n){let i=Object.assign({},t);for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t)){let r=n[t],l=i[t];r&&"object"==typeof r&&!Array.isArray(r)&&l&&"object"==typeof l&&!Array.isArray(l)?i[t]=e(l,r):(l&&r&&typeof l!=typeof r&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${t}". Original type: ${typeof l}, New type: ${typeof r}. Overwriting.`),i[t]=r);}return i;}(n,t);e.body=JSON.stringify(i);}(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e;}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await i4(e),new nb(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e));});}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async e=>(await i4(e),this.processStreamResponse(e))).catch(e=>{if(e instanceof Error)throw e;throw Error(JSON.stringify(e));});}processStreamResponse(e){return iN(this,arguments,function*(){var t;let n=null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!n)throw Error("Response body is empty");try{let t="",r="data:",l=["\n\n","\r\r","\r\n\r\n"];for(;;){let{done:o,value:s}=yield iR(n.read());if(o){if(t.trim().length>0)throw Error("Incomplete JSON segment at the end");break;}let a=i.decode(s,{stream:!0});try{let e=JSON.parse(a);if("error"in e){let t=JSON.parse(JSON.stringify(e.error)),n=t.status,i=t.code,r=`got status: ${n}. ${JSON.stringify(e)}`;if(i>=400&&i<600)throw new iU({message:r,status:i});}}catch(e){if("ApiError"===e.name)throw e;}t+=a;let u=-1,d=0;for(;;){for(let e of(u=-1,d=0,l)){let n=t.indexOf(e);-1!==n&&(-1===u||n<u)&&(u=n,d=e.length);}if(-1===u)break;let n=t.substring(0,u);t=t.substring(u+d);let i=n.trim();if(i.startsWith(r)){let t=i.substring(r.length).trim();try{let n=new Response(t,{headers:null==e?void 0:e.headers,status:null==e?void 0:e.status,statusText:null==e?void 0:e.statusText});yield yield iR(new nb(n));}catch(e){throw Error(`exception parsing stream chunk ${t}. ${e}`);}}}}}finally{n.releaseLock();}});}async apiCall(e,t){return fetch(e,t).catch(e=>{throw Error(`exception ${e} sending request`);});}getDefaultHeaders(){let e={},t="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return e["User-Agent"]=t,e[i1]=t,e["Content-Type"]="application/json",e;}async getHeadersInternal(e,t){let n=new Headers;if(e&&e.headers){for(let[t,i]of Object.entries(e.headers))n.append(t,i);e.timeout&&e.timeout>0&&n.append("X-Server-Timeout",String(Math.ceil(e.timeout/1e3)));}return await this.clientOptions.auth.addAuthHeaders(n,t),n;}getFileName(e){var t;let n="";return"string"==typeof e&&(n=null!==(t=(n=e.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())&&void 0!==t?t:""),n;}async uploadFile(e,t){var n;let i={};null!=t&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);let r=this.clientOptions.uploader,l=await r.stat(e);i.sizeBytes=String(l.size);let o=null!==(n=null==t?void 0:t.mimeType)&&void 0!==n?n:l.type;if(void 0===o||""===o)throw Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;let s={file:i},a=this.getFileName(e),u=n_("upload/v1beta/files",s._url),d=await this.fetchUploadUrl(u,i.sizeBytes,i.mimeType,a,s,null==t?void 0:t.httpOptions);return r.upload(e,d,this);}async uploadFileToFileSearchStore(e,t,n){var i;let r=this.clientOptions.uploader,l=await r.stat(t),o=String(l.size),s=null!==(i=null==n?void 0:n.mimeType)&&void 0!==i?i:l.type;if(void 0===s||""===s)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let a=`upload/v1beta/${e}:uploadToFileSearchStore`,u=this.getFileName(t),d={};null!=n&&i0(n,d);let p=await this.fetchUploadUrl(a,o,s,u,d,null==n?void 0:n.httpOptions);return r.uploadToFileSearchStore(t,p,this);}async downloadFile(e){let t=this.clientOptions.downloader;await t.download(e,this);}async fetchUploadUrl(e,t,n,i,r,l){var o;let s={};s=l||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};let a=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:s});if(!a||!(null==a?void 0:a.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let u=null===(o=null==a?void 0:a.headers)||void 0===o?void 0:o["x-goog-upload-url"];if(void 0===u)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u;}}async function i4(e){var t;if(void 0===e)throw Error("response is undefined");if(!e.ok){let n=e.status,i=JSON.stringify((null===(t=e.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?await e.json():{error:{message:await e.text(),code:e.status,status:e.statusText}});if(n>=400&&n<600)throw new iU({message:i,status:n});throw Error(i);}}function i3(e){for(let t of e){if(null!==t&&"object"==typeof t&&t instanceof i8||"object"==typeof t&&"inputSchema"in t)return!0;}return!1;}function i6(e){var t;let n=null!==(t=e[i1])&&void 0!==t?t:"";e[i1]=(n+" mcp_used/unknown").trimStart();}class i8{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t;}static create(e,t){return new i8(e,t);}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;let r={},l=[];for(let u of this.mcpClients)try{for(var o,s=!0,a=(t=void 0,iP(function(e){return iN(this,arguments,function*(e,t=100){let n;let i=0;for(;i<t;){let t=yield iR(e.listTools({cursor:n}));for(let e of t.tools)yield yield iR(e),i++;if(!t.nextCursor)break;n=t.nextCursor;}});}(u)));!(e=(o=await a.next()).done);s=!0){i=o.value,s=!1,l.push(i);let e=i.name;if(r[e])throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);r[e]=u;}}catch(e){t={error:e};}finally{try{!s&&!e&&(n=a.return)&&await n.call(a);}finally{if(t)throw t.error;}}this.mcpTools=l,this.functionNameToMcpClient=r;}async tool(){return await this.initialize(),function(e,t={}){let n=[],i=new Set;for(let r of e){let e=r.name;if(i.has(e))throw Error(`Duplicate function name ${e} found in MCP tools. Please ensure function names are unique.`);i.add(e);let l=function(e,t={}){let n={name:e.name,description:e.description,parametersJsonSchema:e.inputSchema};return e.outputSchema&&(n.responseJsonSchema=e.outputSchema),t.behavior&&(n.behavior=t.behavior),{functionDeclarations:[n]};}(r,t);l.functionDeclarations&&n.push(...l.functionDeclarations);}return{functionDeclarations:n};}(this.mcpTools,this.config);}async callTool(e){await this.initialize();let t=[];for(let n of e)if(n.name in this.functionNameToMcpClient){let e;let i=this.functionNameToMcpClient[n.name];this.config.timeout&&(e={timeout:this.config.timeout});let r=await i.callTool({name:n.name,arguments:n.args},void 0,e);t.push({functionResponse:{name:n.name,response:r.isError?{error:r}:r}});}return t;}}async function i5(e,t,n){let i;let r=new nX;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r);}class i9{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n;}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let i=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),l=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t;}(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),s=`${i}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${o}`,a=()=>{},u=new Promise(e=>{a=e;}),d=e.callbacks,p=this.apiClient,c={onopen:function(){a({});},onmessage:e=>{i5(p,d.onmessage,e);},onerror:null!==(t=null==d?void 0:d.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==d?void 0:d.onclose)&&void 0!==n?n:function(e){}},h=this.webSocketFactory.create(s,function(e){let t={};return e.forEach((e,n)=>{t[n]=e;}),t;}(l),c);h.connect(),await u;let f=nZ(this.apiClient,e.model);return h.send(JSON.stringify({setup:{model:f}})),new i7(h,this.apiClient);}}class i7{constructor(e,t){this.conn=e,this.apiClient=t;}async setWeightedPrompts(e){if(!e.weightedPrompts||0===Object.keys(e.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let t=function(e){let t={},n=nS(e,["weightedPrompts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["weightedPrompts"],e);}return t;}(e);this.conn.send(JSON.stringify({clientContent:t}));}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});let t=function(e){let t={},n=nS(e,["musicGenerationConfig"]);return null!=n&&nI(t,["musicGenerationConfig"],n),t;}(e);this.conn.send(JSON.stringify(t));}sendPlaybackControl(e){this.conn.send(JSON.stringify({playbackControl:e}));}play(){this.sendPlaybackControl(tn.PLAY);}pause(){this.sendPlaybackControl(tn.PAUSE);}stop(){this.sendPlaybackControl(tn.STOP);}resetContext(){this.sendPlaybackControl(tn.RESET_CONTEXT);}close(){this.conn.close();}}async function re(e,t,n){let i;let r=new nz;n.data instanceof Blob?i=await n.data.text():i=n.data instanceof ArrayBuffer?new TextDecoder().decode(n.data):n.data;let l=JSON.parse(i);e.isVertexAI()?Object.assign(r,function(e){let t={},n=nS(e,["setupComplete"]);null!=n&&nI(t,["setupComplete"],n);let i=nS(e,["serverContent"]);null!=i&&nI(t,["serverContent"],i);let r=nS(e,["toolCall"]);null!=r&&nI(t,["toolCall"],r);let l=nS(e,["toolCallCancellation"]);null!=l&&nI(t,["toolCallCancellation"],l);let o=nS(e,["usageMetadata"]);null!=o&&nI(t,["usageMetadata"],function(e){let t={},n=nS(e,["promptTokenCount"]);null!=n&&nI(t,["promptTokenCount"],n);let i=nS(e,["cachedContentTokenCount"]);null!=i&&nI(t,["cachedContentTokenCount"],i);let r=nS(e,["candidatesTokenCount"]);null!=r&&nI(t,["responseTokenCount"],r);let l=nS(e,["toolUsePromptTokenCount"]);null!=l&&nI(t,["toolUsePromptTokenCount"],l);let o=nS(e,["thoughtsTokenCount"]);null!=o&&nI(t,["thoughtsTokenCount"],o);let s=nS(e,["totalTokenCount"]);null!=s&&nI(t,["totalTokenCount"],s);let a=nS(e,["promptTokensDetails"]);if(null!=a){let e=a;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["promptTokensDetails"],e);}let u=nS(e,["cacheTokensDetails"]);if(null!=u){let e=u;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["cacheTokensDetails"],e);}let d=nS(e,["candidatesTokensDetails"]);if(null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["responseTokensDetails"],e);}let p=nS(e,["toolUsePromptTokensDetails"]);if(null!=p){let e=p;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["toolUsePromptTokensDetails"],e);}let c=nS(e,["trafficType"]);return null!=c&&nI(t,["trafficType"],c),t;}(o));let s=nS(e,["goAway"]);null!=s&&nI(t,["goAway"],s);let a=nS(e,["sessionResumptionUpdate"]);null!=a&&nI(t,["sessionResumptionUpdate"],a);let u=nS(e,["voiceActivityDetectionSignal"]);return null!=u&&nI(t,["voiceActivityDetectionSignal"],u),t;}(l)):Object.assign(r,l),t(r);}class rt{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new i9(this.apiClient,this.auth,this.webSocketFactory);}async connect(e){var t,n,i,r,l,o;let s;if(e.config&&e.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),d=this.apiClient.getHeaders();e.config&&e.config.tools&&i3(e.config.tools)&&i6(d);let p=function(e){let t=new Headers;for(let[n,i]of Object.entries(e))t.append(n,i);return t;}(d);if(this.apiClient.isVertexAI())s=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,s);else{let e=this.apiClient.getApiKey(),t="BidiGenerateContent",n="key";(null==e?void 0:e.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==u&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),t="BidiGenerateContentConstrained",n="access_token"),s=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.${t}?${n}=${e}`;}let c=()=>{},h=new Promise(e=>{c=e;}),f=e.callbacks,m=this.apiClient,g={onopen:function(){var e;null===(e=null==f?void 0:f.onopen)||void 0===e||e.call(f),c({});},onmessage:e=>{re(m,f.onmessage,e);},onerror:null!==(t=null==f?void 0:f.onerror)&&void 0!==t?t:function(e){},onclose:null!==(n=null==f?void 0:f.onclose)&&void 0!==n?n:function(e){}},y=this.webSocketFactory.create(s,function(e){let t={};return e.forEach((e,n)=>{t[n]=e;}),t;}(p),g);y.connect(),await h;let v=nZ(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){let e=this.apiClient.getProject(),t=this.apiClient.getLocation();v=`projects/${e}/locations/${t}/`+v;}let E={};this.apiClient.isVertexAI()&&(null===(i=e.config)||void 0===i?void 0:i.responseModalities)===void 0&&(void 0===e.config?e.config={responseModalities:[eP.AUDIO]}:e.config.responseModalities=[eP.AUDIO]),(null===(r=e.config)||void 0===r?void 0:r.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let _=null!==(o=null===(l=e.config)||void 0===l?void 0:l.tools)&&void 0!==o?o:[],I=[];for(let e of _)this.isCallableTool(e)?I.push(await e.tool()):I.push(e);I.length>0&&(e.config.tools=I);let S={model:v,config:e.config,callbacks:e.callbacks};return E=this.apiClient.isVertexAI()?function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["setup","model"],nZ(e,i));let r=nS(t,["config"]);return null!=r&&nI(n,["config"],function(e,t){let n=nS(e,["generationConfig"]);void 0!==t&&null!=n&&nI(t,["setup","generationConfig"],function(e){let t={},n=nS(e,["modelSelectionConfig"]);null!=n&&nI(t,["modelConfig"],n);let i=nS(e,["responseJsonSchema"]);null!=i&&nI(t,["responseJsonSchema"],i);let r=nS(e,["audioTimestamp"]);null!=r&&nI(t,["audioTimestamp"],r);let l=nS(e,["candidateCount"]);null!=l&&nI(t,["candidateCount"],l);let o=nS(e,["enableAffectiveDialog"]);null!=o&&nI(t,["enableAffectiveDialog"],o);let s=nS(e,["frequencyPenalty"]);null!=s&&nI(t,["frequencyPenalty"],s);let a=nS(e,["logprobs"]);null!=a&&nI(t,["logprobs"],a);let u=nS(e,["maxOutputTokens"]);null!=u&&nI(t,["maxOutputTokens"],u);let d=nS(e,["mediaResolution"]);null!=d&&nI(t,["mediaResolution"],d);let p=nS(e,["presencePenalty"]);null!=p&&nI(t,["presencePenalty"],p);let c=nS(e,["responseLogprobs"]);null!=c&&nI(t,["responseLogprobs"],c);let h=nS(e,["responseMimeType"]);null!=h&&nI(t,["responseMimeType"],h);let f=nS(e,["responseModalities"]);null!=f&&nI(t,["responseModalities"],f);let m=nS(e,["responseSchema"]);null!=m&&nI(t,["responseSchema"],m);let g=nS(e,["routingConfig"]);null!=g&&nI(t,["routingConfig"],g);let y=nS(e,["seed"]);null!=y&&nI(t,["seed"],y);let v=nS(e,["speechConfig"]);null!=v&&nI(t,["speechConfig"],v);let E=nS(e,["stopSequences"]);null!=E&&nI(t,["stopSequences"],E);let _=nS(e,["temperature"]);null!=_&&nI(t,["temperature"],_);let I=nS(e,["thinkingConfig"]);null!=I&&nI(t,["thinkingConfig"],I);let S=nS(e,["topK"]);null!=S&&nI(t,["topK"],S);let T=nS(e,["topP"]);if(null!=T&&nI(t,["topP"],T),void 0!==nS(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t;}(n));let i=nS(e,["responseModalities"]);void 0!==t&&null!=i&&nI(t,["setup","generationConfig","responseModalities"],i);let r=nS(e,["temperature"]);void 0!==t&&null!=r&&nI(t,["setup","generationConfig","temperature"],r);let l=nS(e,["topP"]);void 0!==t&&null!=l&&nI(t,["setup","generationConfig","topP"],l);let o=nS(e,["topK"]);void 0!==t&&null!=o&&nI(t,["setup","generationConfig","topK"],o);let s=nS(e,["maxOutputTokens"]);void 0!==t&&null!=s&&nI(t,["setup","generationConfig","maxOutputTokens"],s);let a=nS(e,["mediaResolution"]);void 0!==t&&null!=a&&nI(t,["setup","generationConfig","mediaResolution"],a);let u=nS(e,["seed"]);void 0!==t&&null!=u&&nI(t,["setup","generationConfig","seed"],u);let d=nS(e,["speechConfig"]);void 0!==t&&null!=d&&nI(t,["setup","generationConfig","speechConfig"],io(d));let p=nS(e,["thinkingConfig"]);void 0!==t&&null!=p&&nI(t,["setup","generationConfig","thinkingConfig"],p);let c=nS(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&nI(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=nS(e,["systemInstruction"]);void 0!==t&&null!=h&&nI(t,["setup","systemInstruction"],ie(h));let f=nS(e,["tools"]);if(void 0!==t&&null!=f){let e=ia(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={};if(void 0!==nS(e,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let n=nS(e,["description"]);null!=n&&nI(t,["description"],n);let i=nS(e,["name"]);null!=i&&nI(t,["name"],i);let r=nS(e,["parameters"]);null!=r&&nI(t,["parameters"],r);let l=nS(e,["parametersJsonSchema"]);null!=l&&nI(t,["parametersJsonSchema"],l);let o=nS(e,["response"]);null!=o&&nI(t,["response"],o);let s=nS(e,["responseJsonSchema"]);return null!=s&&nI(t,["responseJsonSchema"],s),t;})(e))),nI(t,["functionDeclarations"],e);}let i=nS(e,["retrieval"]);null!=i&&nI(t,["retrieval"],i);let r=nS(e,["googleSearchRetrieval"]);null!=r&&nI(t,["googleSearchRetrieval"],r);let l=nS(e,["computerUse"]);if(null!=l&&nI(t,["computerUse"],l),void 0!==nS(e,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let o=nS(e,["codeExecution"]);null!=o&&nI(t,["codeExecution"],o);let s=nS(e,["enterpriseWebSearch"]);null!=s&&nI(t,["enterpriseWebSearch"],s);let a=nS(e,["googleMaps"]);null!=a&&nI(t,["googleMaps"],a);let u=nS(e,["googleSearch"]);null!=u&&nI(t,["googleSearch"],u);let d=nS(e,["urlContext"]);return null!=d&&nI(t,["urlContext"],d),t;})(is(e)))),nI(t,["setup","tools"],e);}let m=nS(e,["sessionResumption"]);void 0!==t&&null!=m&&nI(t,["setup","sessionResumption"],m);let g=nS(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&nI(t,["setup","inputAudioTranscription"],g);let y=nS(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&nI(t,["setup","outputAudioTranscription"],y);let v=nS(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&nI(t,["setup","realtimeInputConfig"],v);let E=nS(e,["contextWindowCompression"]);void 0!==t&&null!=E&&nI(t,["setup","contextWindowCompression"],E);let _=nS(e,["proactivity"]);void 0!==t&&null!=_&&nI(t,["setup","proactivity"],_);let I=nS(e,["explicitVadSignal"]);return void 0!==t&&null!=I&&nI(t,["setup","explicitVadSignal"],I),{};}(r,n)),n;}(this.apiClient,S):function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["setup","model"],nZ(e,i));let r=nS(t,["config"]);return null!=r&&nI(n,["config"],function(e,t){let n=nS(e,["generationConfig"]);void 0!==t&&null!=n&&nI(t,["setup","generationConfig"],n);let i=nS(e,["responseModalities"]);void 0!==t&&null!=i&&nI(t,["setup","generationConfig","responseModalities"],i);let r=nS(e,["temperature"]);void 0!==t&&null!=r&&nI(t,["setup","generationConfig","temperature"],r);let l=nS(e,["topP"]);void 0!==t&&null!=l&&nI(t,["setup","generationConfig","topP"],l);let o=nS(e,["topK"]);void 0!==t&&null!=o&&nI(t,["setup","generationConfig","topK"],o);let s=nS(e,["maxOutputTokens"]);void 0!==t&&null!=s&&nI(t,["setup","generationConfig","maxOutputTokens"],s);let a=nS(e,["mediaResolution"]);void 0!==t&&null!=a&&nI(t,["setup","generationConfig","mediaResolution"],a);let u=nS(e,["seed"]);void 0!==t&&null!=u&&nI(t,["setup","generationConfig","seed"],u);let d=nS(e,["speechConfig"]);void 0!==t&&null!=d&&nI(t,["setup","generationConfig","speechConfig"],io(d));let p=nS(e,["thinkingConfig"]);void 0!==t&&null!=p&&nI(t,["setup","generationConfig","thinkingConfig"],p);let c=nS(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&nI(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=nS(e,["systemInstruction"]);void 0!==t&&null!=h&&nI(t,["setup","systemInstruction"],function(e){let t={},n=nS(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["mediaResolution"]);null!=n&&nI(t,["mediaResolution"],n);let i=nS(e,["codeExecutionResult"]);null!=i&&nI(t,["codeExecutionResult"],i);let r=nS(e,["executableCode"]);null!=r&&nI(t,["executableCode"],r);let l=nS(e,["fileData"]);null!=l&&nI(t,["fileData"],function(e){let t={};if(void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=nS(e,["fileUri"]);null!=n&&nI(t,["fileUri"],n);let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(l));let o=nS(e,["functionCall"]);null!=o&&nI(t,["functionCall"],function(e){let t={},n=nS(e,["id"]);null!=n&&nI(t,["id"],n);let i=nS(e,["args"]);null!=i&&nI(t,["args"],i);let r=nS(e,["name"]);if(null!=r&&nI(t,["name"],r),void 0!==nS(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==nS(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t;}(o));let s=nS(e,["functionResponse"]);null!=s&&nI(t,["functionResponse"],s);let a=nS(e,["inlineData"]);null!=a&&nI(t,["inlineData"],iL(a));let u=nS(e,["text"]);null!=u&&nI(t,["text"],u);let d=nS(e,["thought"]);null!=d&&nI(t,["thought"],d);let p=nS(e,["thoughtSignature"]);null!=p&&nI(t,["thoughtSignature"],p);let c=nS(e,["videoMetadata"]);return null!=c&&nI(t,["videoMetadata"],c),t;})(e))),nI(t,["parts"],e);}let i=nS(e,["role"]);return null!=i&&nI(t,["role"],i),t;}(ie(h)));let f=nS(e,["tools"]);if(void 0!==t&&null!=f){let e=ia(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["functionDeclarations"],e);}if(void 0!==nS(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=nS(e,["googleSearchRetrieval"]);null!=i&&nI(t,["googleSearchRetrieval"],i);let r=nS(e,["computerUse"]);null!=r&&nI(t,["computerUse"],r);let l=nS(e,["fileSearch"]);null!=l&&nI(t,["fileSearch"],l);let o=nS(e,["codeExecution"]);if(null!=o&&nI(t,["codeExecution"],o),void 0!==nS(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=nS(e,["googleMaps"]);null!=s&&nI(t,["googleMaps"],function(e){let t={};if(void 0!==nS(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=nS(e,["enableWidget"]);return null!=n&&nI(t,["enableWidget"],n),t;}(s));let a=nS(e,["googleSearch"]);null!=a&&nI(t,["googleSearch"],function(e){let t={};if(void 0!==nS(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==nS(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=nS(e,["timeRangeFilter"]);return null!=n&&nI(t,["timeRangeFilter"],n),t;}(a));let u=nS(e,["urlContext"]);return null!=u&&nI(t,["urlContext"],u),t;})(is(e)))),nI(t,["setup","tools"],e);}let m=nS(e,["sessionResumption"]);void 0!==t&&null!=m&&nI(t,["setup","sessionResumption"],function(e){let t={},n=nS(e,["handle"]);if(null!=n&&nI(t,["handle"],n),void 0!==nS(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t;}(m));let g=nS(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&nI(t,["setup","inputAudioTranscription"],g);let y=nS(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&nI(t,["setup","outputAudioTranscription"],y);let v=nS(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&nI(t,["setup","realtimeInputConfig"],v);let E=nS(e,["contextWindowCompression"]);void 0!==t&&null!=E&&nI(t,["setup","contextWindowCompression"],E);let _=nS(e,["proactivity"]);if(void 0!==t&&null!=_&&nI(t,["setup","proactivity"],_),void 0!==nS(e,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{};}(r,n)),n;}(this.apiClient,S),delete E.config,y.send(JSON.stringify(E)),new ri(y,this.apiClient);}isCallableTool(e){return"callTool"in e&&"function"==typeof e.callTool;}}let rn={turnComplete:!0};class ri{constructor(e,t){this.conn=e,this.apiClient=t;}tLiveClientContent(e,t){if(null!==t.turns&&void 0!==t.turns){let n=[];try{n=ii(t.turns),e.isVertexAI()||(n=n.map(e=>iq(e)));}catch(e){throw Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`);}return{clientContent:{turns:n,turnComplete:t.turnComplete}};}return{clientContent:{turnComplete:t.turnComplete}};}tLiveClienttToolResponse(e,t){let n=[];if(null==t.functionResponses||0===(n=Array.isArray(t.functionResponses)?t.functionResponses:[t.functionResponses]).length)throw Error("functionResponses is required.");for(let t of n){if("object"!=typeof t||null===t||!("name"in t)||!("response"in t))throw Error(`Could not parse function response, type '${typeof t}'.`);if(!e.isVertexAI()&&!("id"in t))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.");}return{toolResponse:{functionResponses:n}};}sendClientContent(e){e=Object.assign(Object.assign({},rn),e);let t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t));}sendRealtimeInput(e){let t={};t=this.apiClient.isVertexAI()?{realtimeInput:function(e){let t={},n=nS(e,["media"]);if(null!=n){let e=n1(n);Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["mediaChunks"],e);}let i=nS(e,["audio"]);null!=i&&nI(t,["audio"],n3(i));let r=nS(e,["audioStreamEnd"]);null!=r&&nI(t,["audioStreamEnd"],r);let l=nS(e,["video"]);null!=l&&nI(t,["video"],n4(l));let o=nS(e,["text"]);null!=o&&nI(t,["text"],o);let s=nS(e,["activityStart"]);null!=s&&nI(t,["activityStart"],s);let a=nS(e,["activityEnd"]);return null!=a&&nI(t,["activityEnd"],a),t;}(e)}:{realtimeInput:function(e){let t={},n=nS(e,["media"]);if(null!=n){let e=n1(n);Array.isArray(e)&&(e=e.map(e=>iL(e))),nI(t,["mediaChunks"],e);}let i=nS(e,["audio"]);null!=i&&nI(t,["audio"],iL(n3(i)));let r=nS(e,["audioStreamEnd"]);null!=r&&nI(t,["audioStreamEnd"],r);let l=nS(e,["video"]);null!=l&&nI(t,["video"],iL(n4(l)));let o=nS(e,["text"]);null!=o&&nI(t,["text"],o);let s=nS(e,["activityStart"]);null!=s&&nI(t,["activityStart"],s);let a=nS(e,["activityEnd"]);return null!=a&&nI(t,["activityEnd"],a),t;}(e)},this.conn.send(JSON.stringify(t));}sendToolResponse(e){if(null==e.functionResponses)throw Error("Tool response parameters are required.");let t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t));}close(){this.conn.close();}}function rr(e){var t,n,i;if(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.disable)return!0;let r=!1;for(let t of null!==(n=null==e?void 0:e.tools)&&void 0!==n?n:[])if(rl(t)){r=!0;break;}if(!r)return!0;let l=null===(i=null==e?void 0:e.automaticFunctionCalling)||void 0===i?void 0:i.maximumRemoteCalls;return(!!l&&(l<0||!Number.isInteger(l))||0==l)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0);}function rl(e){return"callTool"in e&&"function"==typeof e.callTool;}function ro(e){var t;let n=[];return(null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.tools)&&e.config.tools.forEach((e,t)=>{!rl(e)&&e.functionDeclarations&&e.functionDeclarations.length>0&&n.push(t);}),n;}function rs(e){var t;return!(null===(t=null==e?void 0:e.automaticFunctionCalling)||void 0===t?void 0:t.ignoreCallHistory);}class ra extends nE{constructor(e){super(),this.apiClient=e,this.generateContent=async e=>{var t,n,i,r,l,o,s,a;let u,d;let p=await this.processParamsMaybeAddMcpUsage(e);if(this.maybeMoveToResponseJsonSchem(e),!(null!==(a=null===(s=null===(o=e.config)||void 0===o?void 0:o.tools)||void 0===s?void 0:s.some(e=>rl(e)))&&void 0!==a&&a)||rr(e.config))return await this.generateContentInternal(p);let c=ro(e);if(c.length>0){let e=c.map(e=>`tools[${e}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${e}.`);}let h=ii(p.contents),f=null!==(i=null===(n=null===(t=p.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==i?i:10,m=0;for(;m<f&&(u=await this.generateContentInternal(p)).functionCalls&&0!==u.functionCalls.length;){let t=u.candidates[0].content,n=[];for(let t of null!==(l=null===(r=e.config)||void 0===r?void 0:r.tools)&&void 0!==l?l:[])if(rl(t)){let e=await t.callTool(u.functionCalls);n.push(...e);}m++,d={role:"user",parts:n},p.contents=ii(p.contents),p.contents.push(t),p.contents.push(d),rs(p.config)&&(h.push(t),h.push(d));}return rs(p.config)&&(u.automaticFunctionCallingHistory=h),u;},this.generateContentStream=async e=>{var t,n,i,r,l;if(this.maybeMoveToResponseJsonSchem(e),rr(e.config)){let t=await this.processParamsMaybeAddMcpUsage(e);return await this.generateContentStreamInternal(t);}let o=ro(e);if(o.length>0){let e=o.map(e=>`tools[${e}]`).join(", ");throw Error(`Incompatible tools found at ${e}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`);}let s=null===(i=null===(n=null===(t=null==e?void 0:e.config)||void 0===t?void 0:t.toolConfig)||void 0===n?void 0:n.functionCallingConfig)||void 0===i?void 0:i.streamFunctionCallArguments,a=null===(l=null===(r=null==e?void 0:e.config)||void 0===r?void 0:r.automaticFunctionCalling)||void 0===l?void 0:l.disable;if(s&&!a)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(e);},this.generateImages=async e=>await this.generateImagesInternal(e).then(e=>{var t;let n;let i=[];if(null==e?void 0:e.generatedImages)for(let r of e.generatedImages)r&&(null==r?void 0:r.safetyAttributes)&&(null===(t=null==r?void 0:r.safetyAttributes)||void 0===t?void 0:t.contentType)==="Positive Prompt"?n=null==r?void 0:r.safetyAttributes:i.push(r);return n?{generatedImages:i,positivePromptSafetyAttributes:n,sdkHttpResponse:e.sdkHttpResponse}:{generatedImages:i,sdkHttpResponse:e.sdkHttpResponse};}),this.list=async e=>{var t;let n={config:Object.assign(Object.assign({},{queryBase:!0}),null==e?void 0:e.config)};if(this.apiClient.isVertexAI()&&!n.config.queryBase){if(null===(t=n.config)||void 0===t?void 0:t.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");n.config.filter="labels.tune-type:*";}return new iT(ti.PAGED_ITEM_MODELS,e=>this.listInternal(e),await this.listInternal(n),n);},this.editImage=async e=>{let t={model:e.model,prompt:e.prompt,referenceImages:[],config:e.config};return e.referenceImages&&e.referenceImages&&(t.referenceImages=e.referenceImages.map(e=>e.toReferenceImageAPI())),await this.editImageInternal(t);},this.upscaleImage=async e=>{let t={numberOfImages:1,mode:"upscale"};e.config&&(t=Object.assign(Object.assign({},t),e.config));let n={model:e.model,image:e.image,upscaleFactor:e.upscaleFactor,config:t};return await this.upscaleImageInternal(n);},this.generateVideos=async e=>{var t,n,i,r,l,o;if((e.prompt||e.image||e.video)&&e.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null===(t=e.video)||void 0===t?void 0:t.uri)&&(null===(n=e.video)||void 0===n?void 0:n.videoBytes)?e.video={uri:e.video.uri,mimeType:e.video.mimeType}:(null===(r=null===(i=e.source)||void 0===i?void 0:i.video)||void 0===r?void 0:r.uri)&&(null===(o=null===(l=e.source)||void 0===l?void 0:l.video)||void 0===o?void 0:o.videoBytes)&&(e.source.video={uri:e.source.video.uri,mimeType:e.source.video.mimeType})),await this.generateVideosInternal(e);};}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&!e.config.responseJsonSchema&&Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema);}async processParamsMaybeAddMcpUsage(e){var t,n,i;let r=null===(t=e.config)||void 0===t?void 0:t.tools;if(!r)return e;let l=await Promise.all(r.map(async e=>rl(e)?await e.tool():e)),o={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(o.config.tools=l,e.config&&e.config.tools&&i3(e.config.tools)){let t=Object.assign({},null!==(i=null===(n=e.config.httpOptions)||void 0===n?void 0:n.headers)&&void 0!==i?i:{});0===Object.keys(t).length&&(t=this.apiClient.getDefaultHeaders()),i6(t),o.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:t});}return o;}async initAfcToolsMap(e){var t,n,i;let r=new Map;for(let l of null!==(n=null===(t=e.config)||void 0===t?void 0:t.tools)&&void 0!==n?n:[])if(rl(l))for(let e of null!==(i=(await l.tool()).functionDeclarations)&&void 0!==i?i:[]){if(!e.name)throw Error("Function declaration name is required.");if(r.has(e.name))throw Error(`Duplicate tool declaration name: ${e.name}`);r.set(e.name,l);}return r;}async processAfcStream(e){var t,n,i;let r=null!==(i=null===(n=null===(t=e.config)||void 0===t?void 0:t.automaticFunctionCalling)||void 0===n?void 0:n.maximumRemoteCalls)&&void 0!==i?i:10,l=!1,o=0;return function(e,t,n){return iN(this,arguments,function*(){for(;o<r;){l&&(o++,l=!1);let m=yield iR(e.processParamsMaybeAddMcpUsage(n)),g=yield iR(e.generateContentStreamInternal(m)),y=[],v=[];try{for(var i,s,a,u,d,p,c,h=!0,f=(s=void 0,iP(g));!(i=(c=yield iR(f.next())).done);h=!0)if(u=c.value,h=!1,yield yield iR(u),u.candidates&&(null===(d=u.candidates[0])||void 0===d?void 0:d.content)){for(let e of(v.push(u.candidates[0].content),null!==(p=u.candidates[0].content.parts)&&void 0!==p?p:[]))if(o<r&&e.functionCall){if(!e.functionCall.name)throw Error("Function call name was not returned by the model.");if(t.has(e.functionCall.name)){let n=yield iR(t.get(e.functionCall.name).callTool([e.functionCall]));y.push(...n);}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${t.keys()}, mising tool: ${e.functionCall.name}`);}}}catch(e){s={error:e};}finally{try{!h&&!i&&(a=f.return)&&(yield iR(a.call(f)));}finally{if(s)throw s.error;}}if(y.length>0){l=!0;let e=new nC;e.candidates=[{content:{role:"user",parts:y}}],yield yield iR(e);let t=[];t.push(...v),t.push({role:"user",parts:y});let i=ii(n.contents).concat(t);n.contents=i;}else break;}});}(this,await this.initAfcToolsMap(e),e);}async generateContentInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=iH(this.apiClient,e);return l=n_("{model}:generateContent",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=iF(e),n=new nC;return Object.assign(n,t),n;});}{let t=iG(this.apiClient,e);return l=n_("{model}:generateContent",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=ij(e),n=new nC;return Object.assign(n,t),n;});}}async generateContentStreamInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=iH(this.apiClient,e);return l=n_("{model}:streamGenerateContent?alt=sse",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.requestStream({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(function(e){return iN(this,arguments,function*(){var t,n,i,r;try{for(var l,o=!0,s=iP(e);!(t=(l=yield iR(s.next())).done);o=!0){r=l.value,o=!1;let e=iF((yield iR(r.json())));e.sdkHttpResponse={headers:r.headers};let t=new nC;Object.assign(t,e),yield yield iR(t);}}catch(e){n={error:e};}finally{try{!o&&!t&&(i=s.return)&&(yield iR(i.call(s)));}finally{if(n)throw n.error;}}});});}{let t=iG(this.apiClient,e);return l=n_("{model}:streamGenerateContent?alt=sse",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.requestStream({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(function(e){return iN(this,arguments,function*(){var t,n,i,r;try{for(var l,o=!0,s=iP(e);!(t=(l=yield iR(s.next())).done);o=!0){r=l.value,o=!1;let e=ij((yield iR(r.json())));e.sdkHttpResponse={headers:r.headers};let t=new nC;Object.assign(t,e),yield yield iR(t);}}catch(e){n={error:e};}finally{try{!o&&!t&&(i=s.return)&&(yield iR(i.call(s)));}finally{if(n)throw n.error;}}});});}}async embedContent(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let t=it(e,r);Array.isArray(t)&&(t=t.map(e=>e)),nI(n,["instances[]","content"],t);}let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["taskType"]);void 0!==t&&null!=n&&nI(t,["instances[]","task_type"],n);let i=nS(e,["title"]);void 0!==t&&null!=i&&nI(t,["instances[]","title"],i);let r=nS(e,["outputDimensionality"]);void 0!==t&&null!=r&&nI(t,["parameters","outputDimensionality"],r);let l=nS(e,["mimeType"]);void 0!==t&&null!=l&&nI(t,["instances[]","mimeType"],l);let o=nS(e,["autoTruncate"]);void 0!==t&&null!=o&&nI(t,["parameters","autoTruncate"],o);}(l,n),n;}(this.apiClient,e);return l=n_("{model}:predict",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["predictions[]","embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["values"]);null!=n&&nI(t,["values"],n);let i=nS(e,["statistics"]);return null!=i&&nI(t,["statistics"],function(e){let t={},n=nS(e,["truncated"]);null!=n&&nI(t,["truncated"],n);let i=nS(e,["token_count"]);return null!=i&&nI(t,["tokenCount"],i),t;}(i)),t;})(e))),nI(t,["embeddings"],e);}let r=nS(e,["metadata"]);return null!=r&&nI(t,["metadata"],r),t;}(e),n=new nO;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let t=it(e,r);Array.isArray(t)&&(t=t.map(e=>e)),nI(n,["requests[]","content"],t);}let l=nS(t,["config"]);null!=l&&function(e,t){let n=nS(e,["taskType"]);void 0!==t&&null!=n&&nI(t,["requests[]","taskType"],n);let i=nS(e,["title"]);void 0!==t&&null!=i&&nI(t,["requests[]","title"],i);let r=nS(e,["outputDimensionality"]);if(void 0!==t&&null!=r&&nI(t,["requests[]","outputDimensionality"],r),void 0!==nS(e,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==nS(e,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");}(l,n);let o=nS(t,["model"]);return void 0!==o&&nI(n,["requests[]","model"],nZ(e,o)),n;}(this.apiClient,e);return l=n_("{model}:batchEmbedContents",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["embeddings"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["embeddings"],e);}let r=nS(e,["metadata"]);return null!=r&&nI(t,["metadata"],r),t;}(e),n=new nO;return Object.assign(n,t),n;});}}async generateImagesInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["prompt"]);null!=r&&nI(n,["instances[0]","prompt"],r);let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["outputGcsUri"]);void 0!==t&&null!=n&&nI(t,["parameters","storageUri"],n);let i=nS(e,["negativePrompt"]);void 0!==t&&null!=i&&nI(t,["parameters","negativePrompt"],i);let r=nS(e,["numberOfImages"]);void 0!==t&&null!=r&&nI(t,["parameters","sampleCount"],r);let l=nS(e,["aspectRatio"]);void 0!==t&&null!=l&&nI(t,["parameters","aspectRatio"],l);let o=nS(e,["guidanceScale"]);void 0!==t&&null!=o&&nI(t,["parameters","guidanceScale"],o);let s=nS(e,["seed"]);void 0!==t&&null!=s&&nI(t,["parameters","seed"],s);let a=nS(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&nI(t,["parameters","safetySetting"],a);let u=nS(e,["personGeneration"]);void 0!==t&&null!=u&&nI(t,["parameters","personGeneration"],u);let d=nS(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&nI(t,["parameters","includeSafetyAttributes"],d);let p=nS(e,["includeRaiReason"]);void 0!==t&&null!=p&&nI(t,["parameters","includeRaiReason"],p);let c=nS(e,["language"]);void 0!==t&&null!=c&&nI(t,["parameters","language"],c);let h=nS(e,["outputMimeType"]);void 0!==t&&null!=h&&nI(t,["parameters","outputOptions","mimeType"],h);let f=nS(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&nI(t,["parameters","outputOptions","compressionQuality"],f);let m=nS(e,["addWatermark"]);void 0!==t&&null!=m&&nI(t,["parameters","addWatermark"],m);let g=nS(e,["labels"]);void 0!==t&&null!=g&&nI(t,["labels"],g);let y=nS(e,["imageSize"]);void 0!==t&&null!=y&&nI(t,["parameters","sampleImageSize"],y);let v=nS(e,["enhancePrompt"]);void 0!==t&&null!=v&&nI(t,["parameters","enhancePrompt"],v);}(l,n),n;}(this.apiClient,e);return l=n_("{model}:predict",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>iV(e))),nI(t,["generatedImages"],e);}let r=nS(e,["positivePromptSafetyAttributes"]);return null!=r&&nI(t,["positivePromptSafetyAttributes"],iz(r)),t;}(e),n=new nR;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["prompt"]);null!=r&&nI(n,["instances[0]","prompt"],r);let l=nS(t,["config"]);return null!=l&&function(e,t){if(void 0!==nS(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==nS(e,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let n=nS(e,["numberOfImages"]);void 0!==t&&null!=n&&nI(t,["parameters","sampleCount"],n);let i=nS(e,["aspectRatio"]);void 0!==t&&null!=i&&nI(t,["parameters","aspectRatio"],i);let r=nS(e,["guidanceScale"]);if(void 0!==t&&null!=r&&nI(t,["parameters","guidanceScale"],r),void 0!==nS(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let l=nS(e,["safetyFilterLevel"]);void 0!==t&&null!=l&&nI(t,["parameters","safetySetting"],l);let o=nS(e,["personGeneration"]);void 0!==t&&null!=o&&nI(t,["parameters","personGeneration"],o);let s=nS(e,["includeSafetyAttributes"]);void 0!==t&&null!=s&&nI(t,["parameters","includeSafetyAttributes"],s);let a=nS(e,["includeRaiReason"]);void 0!==t&&null!=a&&nI(t,["parameters","includeRaiReason"],a);let u=nS(e,["language"]);void 0!==t&&null!=u&&nI(t,["parameters","language"],u);let d=nS(e,["outputMimeType"]);void 0!==t&&null!=d&&nI(t,["parameters","outputOptions","mimeType"],d);let p=nS(e,["outputCompressionQuality"]);if(void 0!==t&&null!=p&&nI(t,["parameters","outputOptions","compressionQuality"],p),void 0!==nS(e,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==nS(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let c=nS(e,["imageSize"]);if(void 0!==t&&null!=c&&nI(t,["parameters","sampleImageSize"],c),void 0!==nS(e,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.");}(l,n),n;}(this.apiClient,e);return l=n_("{model}:predict",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["_self"]);null!=n&&nI(t,["image"],function(e){let t={},n=nS(e,["bytesBase64Encoded"]);null!=n&&nI(t,["imageBytes"],nT(n));let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(n));let i=nS(e,["raiFilteredReason"]);null!=i&&nI(t,["raiFilteredReason"],i);let r=nS(e,["_self"]);return null!=r&&nI(t,["safetyAttributes"],iW(r)),t;})(e))),nI(t,["generatedImages"],e);}let r=nS(e,["positivePromptSafetyAttributes"]);return null!=r&&nI(t,["positivePromptSafetyAttributes"],iW(r)),t;}(e),n=new nR;return Object.assign(n,t),n;});}}async editImageInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["prompt"]);null!=r&&nI(n,["instances[0]","prompt"],r);let l=nS(t,["referenceImages"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["referenceImage"]);null!=n&&nI(t,["referenceImage"],i$(n));let i=nS(e,["referenceId"]);null!=i&&nI(t,["referenceId"],i);let r=nS(e,["referenceType"]);null!=r&&nI(t,["referenceType"],r);let l=nS(e,["maskImageConfig"]);null!=l&&nI(t,["maskImageConfig"],function(e){let t={},n=nS(e,["maskMode"]);null!=n&&nI(t,["maskMode"],n);let i=nS(e,["segmentationClasses"]);null!=i&&nI(t,["maskClasses"],i);let r=nS(e,["maskDilation"]);return null!=r&&nI(t,["dilation"],r),t;}(l));let o=nS(e,["controlImageConfig"]);null!=o&&nI(t,["controlImageConfig"],function(e){let t={},n=nS(e,["controlType"]);null!=n&&nI(t,["controlType"],n);let i=nS(e,["enableControlImageComputation"]);return null!=i&&nI(t,["computeControl"],i),t;}(o));let s=nS(e,["styleImageConfig"]);null!=s&&nI(t,["styleImageConfig"],s);let a=nS(e,["subjectImageConfig"]);return null!=a&&nI(t,["subjectImageConfig"],a),t;})(e))),nI(n,["instances[0]","referenceImages"],e);}let o=nS(t,["config"]);return null!=o&&function(e,t){let n=nS(e,["outputGcsUri"]);void 0!==t&&null!=n&&nI(t,["parameters","storageUri"],n);let i=nS(e,["negativePrompt"]);void 0!==t&&null!=i&&nI(t,["parameters","negativePrompt"],i);let r=nS(e,["numberOfImages"]);void 0!==t&&null!=r&&nI(t,["parameters","sampleCount"],r);let l=nS(e,["aspectRatio"]);void 0!==t&&null!=l&&nI(t,["parameters","aspectRatio"],l);let o=nS(e,["guidanceScale"]);void 0!==t&&null!=o&&nI(t,["parameters","guidanceScale"],o);let s=nS(e,["seed"]);void 0!==t&&null!=s&&nI(t,["parameters","seed"],s);let a=nS(e,["safetyFilterLevel"]);void 0!==t&&null!=a&&nI(t,["parameters","safetySetting"],a);let u=nS(e,["personGeneration"]);void 0!==t&&null!=u&&nI(t,["parameters","personGeneration"],u);let d=nS(e,["includeSafetyAttributes"]);void 0!==t&&null!=d&&nI(t,["parameters","includeSafetyAttributes"],d);let p=nS(e,["includeRaiReason"]);void 0!==t&&null!=p&&nI(t,["parameters","includeRaiReason"],p);let c=nS(e,["language"]);void 0!==t&&null!=c&&nI(t,["parameters","language"],c);let h=nS(e,["outputMimeType"]);void 0!==t&&null!=h&&nI(t,["parameters","outputOptions","mimeType"],h);let f=nS(e,["outputCompressionQuality"]);void 0!==t&&null!=f&&nI(t,["parameters","outputOptions","compressionQuality"],f);let m=nS(e,["addWatermark"]);void 0!==t&&null!=m&&nI(t,["parameters","addWatermark"],m);let g=nS(e,["labels"]);void 0!==t&&null!=g&&nI(t,["labels"],g);let y=nS(e,["editMode"]);void 0!==t&&null!=y&&nI(t,["parameters","editMode"],y);let v=nS(e,["baseSteps"]);void 0!==t&&null!=v&&nI(t,["parameters","editConfig","baseSteps"],v);}(o,n),n;}(this.apiClient,e);return i=n_("{model}:predict",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>iV(e))),nI(t,["generatedImages"],e);}return t;}(e),n=new nN;return Object.assign(n,t),n;});}throw Error("This method is only supported by the Vertex AI.");}async upscaleImageInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["image"]);null!=r&&nI(n,["instances[0]","image"],i$(r));let l=nS(t,["upscaleFactor"]);null!=l&&nI(n,["parameters","upscaleConfig","upscaleFactor"],l);let o=nS(t,["config"]);return null!=o&&function(e,t){let n=nS(e,["outputGcsUri"]);void 0!==t&&null!=n&&nI(t,["parameters","storageUri"],n);let i=nS(e,["safetyFilterLevel"]);void 0!==t&&null!=i&&nI(t,["parameters","safetySetting"],i);let r=nS(e,["personGeneration"]);void 0!==t&&null!=r&&nI(t,["parameters","personGeneration"],r);let l=nS(e,["includeRaiReason"]);void 0!==t&&null!=l&&nI(t,["parameters","includeRaiReason"],l);let o=nS(e,["outputMimeType"]);void 0!==t&&null!=o&&nI(t,["parameters","outputOptions","mimeType"],o);let s=nS(e,["outputCompressionQuality"]);void 0!==t&&null!=s&&nI(t,["parameters","outputOptions","compressionQuality"],s);let a=nS(e,["enhanceInputImage"]);void 0!==t&&null!=a&&nI(t,["parameters","upscaleConfig","enhanceInputImage"],a);let u=nS(e,["imagePreservationFactor"]);void 0!==t&&null!=u&&nI(t,["parameters","upscaleConfig","imagePreservationFactor"],u);let d=nS(e,["labels"]);void 0!==t&&null!=d&&nI(t,["labels"],d);let p=nS(e,["numberOfImages"]);void 0!==t&&null!=p&&nI(t,["parameters","sampleCount"],p);let c=nS(e,["mode"]);void 0!==t&&null!=c&&nI(t,["parameters","mode"],c);}(o,n),n;}(this.apiClient,e);return i=n_("{model}:predict",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["predictions"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>iV(e))),nI(t,["generatedImages"],e);}return t;}(e),n=new nP;return Object.assign(n,t),n;});}throw Error("This method is only supported by the Vertex AI.");}async recontextImage(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["source"]);null!=r&&function(e,t){let n=nS(e,["prompt"]);void 0!==t&&null!=n&&nI(t,["instances[0]","prompt"],n);let i=nS(e,["personImage"]);void 0!==t&&null!=i&&nI(t,["instances[0]","personImage","image"],i$(i));let r=nS(e,["productImages"]);if(void 0!==t&&null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["productImage"]);return null!=n&&nI(t,["image"],i$(n)),t;})(e))),nI(t,["instances[0]","productImages"],e);}}(r,n);let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["numberOfImages"]);void 0!==t&&null!=n&&nI(t,["parameters","sampleCount"],n);let i=nS(e,["baseSteps"]);void 0!==t&&null!=i&&nI(t,["parameters","baseSteps"],i);let r=nS(e,["outputGcsUri"]);void 0!==t&&null!=r&&nI(t,["parameters","storageUri"],r);let l=nS(e,["seed"]);void 0!==t&&null!=l&&nI(t,["parameters","seed"],l);let o=nS(e,["safetyFilterLevel"]);void 0!==t&&null!=o&&nI(t,["parameters","safetySetting"],o);let s=nS(e,["personGeneration"]);void 0!==t&&null!=s&&nI(t,["parameters","personGeneration"],s);let a=nS(e,["addWatermark"]);void 0!==t&&null!=a&&nI(t,["parameters","addWatermark"],a);let u=nS(e,["outputMimeType"]);void 0!==t&&null!=u&&nI(t,["parameters","outputOptions","mimeType"],u);let d=nS(e,["outputCompressionQuality"]);void 0!==t&&null!=d&&nI(t,["parameters","outputOptions","compressionQuality"],d);let p=nS(e,["enhancePrompt"]);void 0!==t&&null!=p&&nI(t,["parameters","enhancePrompt"],p);let c=nS(e,["labels"]);void 0!==t&&null!=c&&nI(t,["labels"],c);}(l,n),n;}(this.apiClient,e);return i=n_("{model}:predict",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>iV(e))),nI(t,["generatedImages"],e);}return t;}(e),n=new nw;return Object.assign(n,t),n;});}throw Error("This method is only supported by the Vertex AI.");}async segmentImage(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["source"]);null!=r&&function(e,t){let n=nS(e,["prompt"]);void 0!==t&&null!=n&&nI(t,["instances[0]","prompt"],n);let i=nS(e,["image"]);void 0!==t&&null!=i&&nI(t,["instances[0]","image"],i$(i));let r=nS(e,["scribbleImage"]);void 0!==t&&null!=r&&nI(t,["instances[0]","scribble"],function(e){let t={},n=nS(e,["image"]);return null!=n&&nI(t,["image"],i$(n)),t;}(r));}(r,n);let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["mode"]);void 0!==t&&null!=n&&nI(t,["parameters","mode"],n);let i=nS(e,["maxPredictions"]);void 0!==t&&null!=i&&nI(t,["parameters","maxPredictions"],i);let r=nS(e,["confidenceThreshold"]);void 0!==t&&null!=r&&nI(t,["parameters","confidenceThreshold"],r);let l=nS(e,["maskDilation"]);void 0!==t&&null!=l&&nI(t,["parameters","maskDilation"],l);let o=nS(e,["binaryColorThreshold"]);void 0!==t&&null!=o&&nI(t,["parameters","binaryColorThreshold"],o);let s=nS(e,["labels"]);void 0!==t&&null!=s&&nI(t,["labels"],s);}(l,n),n;}(this.apiClient,e);return i=n_("{model}:predict",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["predictions"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["_self"]);null!=n&&nI(t,["mask"],iB(n));let i=nS(e,["labels"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["labels"],e);}return t;})(e))),nI(t,["generatedMasks"],e);}return t;}(e),n=new nM;return Object.assign(n,t),n;});}throw Error("This method is only supported by the Vertex AI.");}async get(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);return null!=i&&nI(n,["_url","name"],nZ(e,i)),n;}(this.apiClient,e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>iK(e));}{let t=function(e,t){let n={},i=nS(t,["model"]);return null!=i&&nI(n,["_url","name"],nZ(e,i)),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>iY(e));}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["config"]);return null!=i&&function(e,t,n){let i=nS(t,["pageSize"]);void 0!==n&&null!=i&&nI(n,["_query","pageSize"],i);let r=nS(t,["pageToken"]);void 0!==n&&null!=r&&nI(n,["_query","pageToken"],r);let l=nS(t,["filter"]);void 0!==n&&null!=l&&nI(n,["_query","filter"],l);let o=nS(t,["queryBase"]);void 0!==n&&null!=o&&nI(n,["_url","models_url"],ic(e,o));}(e,i,n),n;}(this.apiClient,e);return l=n_("{models_url}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["_self"]);if(null!=r){let e=ih(r);Array.isArray(e)&&(e=e.map(e=>iK(e))),nI(t,["models"],e);}return t;}(e),n=new nD;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["config"]);return null!=i&&function(e,t,n){let i=nS(t,["pageSize"]);void 0!==n&&null!=i&&nI(n,["_query","pageSize"],i);let r=nS(t,["pageToken"]);void 0!==n&&null!=r&&nI(n,["_query","pageToken"],r);let l=nS(t,["filter"]);void 0!==n&&null!=l&&nI(n,["_query","filter"],l);let o=nS(t,["queryBase"]);void 0!==n&&null!=o&&nI(n,["_url","models_url"],ic(e,o));}(e,i,n),n;}(this.apiClient,e);return l=n_("{models_url}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["_self"]);if(null!=r){let e=ih(r);Array.isArray(e)&&(e=e.map(e=>iY(e))),nI(t,["models"],e);}return t;}(e),n=new nD;return Object.assign(n,t),n;});}}async update(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["displayName"]);void 0!==t&&null!=n&&nI(t,["displayName"],n);let i=nS(e,["description"]);void 0!==t&&null!=i&&nI(t,["description"],i);let r=nS(e,["defaultCheckpointId"]);void 0!==t&&null!=r&&nI(t,["defaultCheckpointId"],r);}(r,n),n;}(this.apiClient,e);return l=n_("{model}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"PATCH",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>iK(e));}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","name"],nZ(e,i));let r=nS(t,["config"]);return null!=r&&function(e,t){let n=nS(e,["displayName"]);void 0!==t&&null!=n&&nI(t,["displayName"],n);let i=nS(e,["description"]);void 0!==t&&null!=i&&nI(t,["description"],i);let r=nS(e,["defaultCheckpointId"]);void 0!==t&&null!=r&&nI(t,["defaultCheckpointId"],r);}(r,n),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"PATCH",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>iY(e));}}async delete(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);return null!=i&&nI(n,["_url","name"],nZ(e,i)),n;}(this.apiClient,e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nx;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["model"]);return null!=i&&nI(n,["_url","name"],nZ(e,i)),n;}(this.apiClient,e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"DELETE",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nx;return Object.assign(n,t),n;});}}async countTokens(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>e)),nI(n,["contents"],e);}let l=nS(t,["config"]);return null!=l&&function(e,t){let n=nS(e,["systemInstruction"]);void 0!==t&&null!=n&&nI(t,["systemInstruction"],ie(n));let i=nS(e,["tools"]);if(void 0!==t&&null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>iX(e))),nI(t,["tools"],e);}let r=nS(e,["generationConfig"]);void 0!==t&&null!=r&&nI(t,["generationConfig"],function(e){let t={},n=nS(e,["modelSelectionConfig"]);null!=n&&nI(t,["modelConfig"],n);let i=nS(e,["responseJsonSchema"]);null!=i&&nI(t,["responseJsonSchema"],i);let r=nS(e,["audioTimestamp"]);null!=r&&nI(t,["audioTimestamp"],r);let l=nS(e,["candidateCount"]);null!=l&&nI(t,["candidateCount"],l);let o=nS(e,["enableAffectiveDialog"]);null!=o&&nI(t,["enableAffectiveDialog"],o);let s=nS(e,["frequencyPenalty"]);null!=s&&nI(t,["frequencyPenalty"],s);let a=nS(e,["logprobs"]);null!=a&&nI(t,["logprobs"],a);let u=nS(e,["maxOutputTokens"]);null!=u&&nI(t,["maxOutputTokens"],u);let d=nS(e,["mediaResolution"]);null!=d&&nI(t,["mediaResolution"],d);let p=nS(e,["presencePenalty"]);null!=p&&nI(t,["presencePenalty"],p);let c=nS(e,["responseLogprobs"]);null!=c&&nI(t,["responseLogprobs"],c);let h=nS(e,["responseMimeType"]);null!=h&&nI(t,["responseMimeType"],h);let f=nS(e,["responseModalities"]);null!=f&&nI(t,["responseModalities"],f);let m=nS(e,["responseSchema"]);null!=m&&nI(t,["responseSchema"],m);let g=nS(e,["routingConfig"]);null!=g&&nI(t,["routingConfig"],g);let y=nS(e,["seed"]);null!=y&&nI(t,["seed"],y);let v=nS(e,["speechConfig"]);null!=v&&nI(t,["speechConfig"],v);let E=nS(e,["stopSequences"]);null!=E&&nI(t,["stopSequences"],E);let _=nS(e,["temperature"]);null!=_&&nI(t,["temperature"],_);let I=nS(e,["thinkingConfig"]);null!=I&&nI(t,["thinkingConfig"],I);let S=nS(e,["topK"]);null!=S&&nI(t,["topK"],S);let T=nS(e,["topP"]);if(null!=T&&nI(t,["topP"],T),void 0!==nS(e,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t;}(r));}(l,n),n;}(this.apiClient,e);return l=n_("{model}:countTokens",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["totalTokens"]);return null!=i&&nI(t,["totalTokens"],i),t;}(e),n=new nU;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>iq(e))),nI(n,["contents"],e);}let l=nS(t,["config"]);return null!=l&&function(e){if(void 0!==nS(e,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==nS(e,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==nS(e,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.");}(l),n;}(this.apiClient,e);return l=n_("{model}:countTokens",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["totalTokens"]);null!=i&&nI(t,["totalTokens"],i);let r=nS(e,["cachedContentTokenCount"]);return null!=r&&nI(t,["cachedContentTokenCount"],r),t;}(e),n=new nU;return Object.assign(n,t),n;});}}async computeTokens(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["contents"]);if(null!=r){let e=ii(r);Array.isArray(e)&&(e=e.map(e=>e)),nI(n,["contents"],e);}return n;}(this.apiClient,e);return i=n_("{model}:computeTokens",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["tokensInfo"]);if(null!=i){let e=i;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["tokensInfo"],e);}return t;}(e),n=new nk;return Object.assign(n,t),n;});}throw Error("This method is only supported by the Vertex AI.");}async generateVideosInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["prompt"]);null!=r&&nI(n,["instances[0]","prompt"],r);let l=nS(t,["image"]);null!=l&&nI(n,["instances[0]","image"],i$(l));let o=nS(t,["video"]);null!=o&&nI(n,["instances[0]","video"],iZ(o));let s=nS(t,["source"]);null!=s&&function(e,t){let n=nS(e,["prompt"]);void 0!==t&&null!=n&&nI(t,["instances[0]","prompt"],n);let i=nS(e,["image"]);void 0!==t&&null!=i&&nI(t,["instances[0]","image"],i$(i));let r=nS(e,["video"]);void 0!==t&&null!=r&&nI(t,["instances[0]","video"],iZ(r));}(s,n);let a=nS(t,["config"]);return null!=a&&function(e,t){let n=nS(e,["numberOfVideos"]);void 0!==t&&null!=n&&nI(t,["parameters","sampleCount"],n);let i=nS(e,["outputGcsUri"]);void 0!==t&&null!=i&&nI(t,["parameters","storageUri"],i);let r=nS(e,["fps"]);void 0!==t&&null!=r&&nI(t,["parameters","fps"],r);let l=nS(e,["durationSeconds"]);void 0!==t&&null!=l&&nI(t,["parameters","durationSeconds"],l);let o=nS(e,["seed"]);void 0!==t&&null!=o&&nI(t,["parameters","seed"],o);let s=nS(e,["aspectRatio"]);void 0!==t&&null!=s&&nI(t,["parameters","aspectRatio"],s);let a=nS(e,["resolution"]);void 0!==t&&null!=a&&nI(t,["parameters","resolution"],a);let u=nS(e,["personGeneration"]);void 0!==t&&null!=u&&nI(t,["parameters","personGeneration"],u);let d=nS(e,["pubsubTopic"]);void 0!==t&&null!=d&&nI(t,["parameters","pubsubTopic"],d);let p=nS(e,["negativePrompt"]);void 0!==t&&null!=p&&nI(t,["parameters","negativePrompt"],p);let c=nS(e,["enhancePrompt"]);void 0!==t&&null!=c&&nI(t,["parameters","enhancePrompt"],c);let h=nS(e,["generateAudio"]);void 0!==t&&null!=h&&nI(t,["parameters","generateAudio"],h);let f=nS(e,["lastFrame"]);void 0!==t&&null!=f&&nI(t,["instances[0]","lastFrame"],i$(f));let m=nS(e,["referenceImages"]);if(void 0!==t&&null!=m){let e=m;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["image"]);null!=n&&nI(t,["image"],i$(n));let i=nS(e,["referenceType"]);return null!=i&&nI(t,["referenceType"],i),t;})(e))),nI(t,["instances[0]","referenceImages"],e);}let g=nS(e,["mask"]);void 0!==t&&null!=g&&nI(t,["instances[0]","mask"],function(e){let t={},n=nS(e,["image"]);null!=n&&nI(t,["_self"],i$(n));let i=nS(e,["maskMode"]);return null!=i&&nI(t,["maskMode"],i),t;}(g));let y=nS(e,["compressionQuality"]);void 0!==t&&null!=y&&nI(t,["parameters","compressionQuality"],y);}(a,n),n;}(this.apiClient,e);return l=n_("{model}:predictLongRunning",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["videos"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["_self"]);return null!=n&&nI(t,["video"],function(e){let t={},n=nS(e,["gcsUri"]);null!=n&&nI(t,["uri"],n);let i=nS(e,["bytesBase64Encoded"]);null!=i&&nI(t,["videoBytes"],nT(i));let r=nS(e,["mimeType"]);return null!=r&&nI(t,["mimeType"],r),t;}(n)),t;})(e))),nI(t,["generatedVideos"],e);}let i=nS(e,["raiMediaFilteredCount"]);null!=i&&nI(t,["raiMediaFilteredCount"],i);let r=nS(e,["raiMediaFilteredReasons"]);return null!=r&&nI(t,["raiMediaFilteredReasons"],r),t;}(o)),t;}(e),n=new nL;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["_url","model"],nZ(e,i));let r=nS(t,["prompt"]);null!=r&&nI(n,["instances[0]","prompt"],r);let l=nS(t,["image"]);null!=l&&nI(n,["instances[0]","image"],iJ(l));let o=nS(t,["video"]);null!=o&&nI(n,["instances[0]","video"],iQ(o));let s=nS(t,["source"]);null!=s&&function(e,t){let n=nS(e,["prompt"]);void 0!==t&&null!=n&&nI(t,["instances[0]","prompt"],n);let i=nS(e,["image"]);void 0!==t&&null!=i&&nI(t,["instances[0]","image"],iJ(i));let r=nS(e,["video"]);void 0!==t&&null!=r&&nI(t,["instances[0]","video"],iQ(r));}(s,n);let a=nS(t,["config"]);return null!=a&&function(e,t){let n=nS(e,["numberOfVideos"]);if(void 0!==t&&null!=n&&nI(t,["parameters","sampleCount"],n),void 0!==nS(e,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==nS(e,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let i=nS(e,["durationSeconds"]);if(void 0!==t&&null!=i&&nI(t,["parameters","durationSeconds"],i),void 0!==nS(e,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let r=nS(e,["aspectRatio"]);void 0!==t&&null!=r&&nI(t,["parameters","aspectRatio"],r);let l=nS(e,["resolution"]);void 0!==t&&null!=l&&nI(t,["parameters","resolution"],l);let o=nS(e,["personGeneration"]);if(void 0!==t&&null!=o&&nI(t,["parameters","personGeneration"],o),void 0!==nS(e,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let s=nS(e,["negativePrompt"]);void 0!==t&&null!=s&&nI(t,["parameters","negativePrompt"],s);let a=nS(e,["enhancePrompt"]);if(void 0!==t&&null!=a&&nI(t,["parameters","enhancePrompt"],a),void 0!==nS(e,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let u=nS(e,["lastFrame"]);void 0!==t&&null!=u&&nI(t,["instances[0]","lastFrame"],iJ(u));let d=nS(e,["referenceImages"]);if(void 0!==t&&null!=d){let e=d;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["image"]);null!=n&&nI(t,["image"],iJ(n));let i=nS(e,["referenceType"]);return null!=i&&nI(t,["referenceType"],i),t;})(e))),nI(t,["instances[0]","referenceImages"],e);}if(void 0!==nS(e,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==nS(e,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.");}(a,n),n;}(this.apiClient,e);return l=n_("{model}:predictLongRunning",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response","generateVideoResponse"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["generatedSamples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["video"]);return null!=n&&nI(t,["video"],function(e){let t={},n=nS(e,["uri"]);null!=n&&nI(t,["uri"],n);let i=nS(e,["encodedVideo"]);null!=i&&nI(t,["videoBytes"],nT(i));let r=nS(e,["encoding"]);return null!=r&&nI(t,["mimeType"],r),t;}(n)),t;})(e))),nI(t,["generatedVideos"],e);}let i=nS(e,["raiMediaFilteredCount"]);null!=i&&nI(t,["raiMediaFilteredCount"],i);let r=nS(e,["raiMediaFilteredReasons"]);return null!=r&&nI(t,["raiMediaFilteredReasons"],r),t;}(o)),t;}(e),n=new nL;return Object.assign(n,t),n;});}}}class ru extends nE{constructor(e){super(),this.apiClient=e;}async getVideosOperation(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let r=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!0});}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1});}}async get(e){let t=e.operation,n=e.config;if(void 0===t.name||""===t.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let e;let i=t.name.split("/operations/")[0];n&&"httpOptions"in n&&(e=n.httpOptions);let r=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:e}});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!0});}{let e=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:e,_isVertexAI:!1});}}async getVideosOperationInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e){let t={},n=nS(e,["operationName"]);return null!=n&&nI(t,["_url","operationName"],n),t;}(e);return l=n_("{operationName}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json());}{let t=function(e){let t={},n=nS(e,["operationName"]);return null!=n&&nI(t,["_url","operationName"],n),t;}(e);return l=n_("{operationName}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json());}}async fetchPredictVideosOperationInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e){let t={},n=nS(e,["operationName"]);null!=n&&nI(t,["operationName"],n);let i=nS(e,["resourceName"]);return null!=i&&nI(t,["_url","resourceName"],i),t;}(e);return i=n_("{resourceName}:fetchPredictOperation",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json());}throw Error("This method is only supported by the Vertex AI.");}}class rd extends nE{constructor(e){super(),this.apiClient=e;}async create(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let l=function(e,t){let n={},i=nS(t,["config"]);return null!=i&&nI(n,["config"],function(e,t,n){let i=nS(t,["expireTime"]);void 0!==n&&null!=i&&nI(n,["expireTime"],i);let r=nS(t,["newSessionExpireTime"]);void 0!==n&&null!=r&&nI(n,["newSessionExpireTime"],r);let l=nS(t,["uses"]);void 0!==n&&null!=l&&nI(n,["uses"],l);let o=nS(t,["liveConnectConstraints"]);void 0!==n&&null!=o&&nI(n,["bidiGenerateContentSetup"],function(e,t){let n={},i=nS(t,["model"]);null!=i&&nI(n,["setup","model"],nZ(e,i));let r=nS(t,["config"]);return null!=r&&nI(n,["config"],function(e,t){let n=nS(e,["generationConfig"]);void 0!==t&&null!=n&&nI(t,["setup","generationConfig"],n);let i=nS(e,["responseModalities"]);void 0!==t&&null!=i&&nI(t,["setup","generationConfig","responseModalities"],i);let r=nS(e,["temperature"]);void 0!==t&&null!=r&&nI(t,["setup","generationConfig","temperature"],r);let l=nS(e,["topP"]);void 0!==t&&null!=l&&nI(t,["setup","generationConfig","topP"],l);let o=nS(e,["topK"]);void 0!==t&&null!=o&&nI(t,["setup","generationConfig","topK"],o);let s=nS(e,["maxOutputTokens"]);void 0!==t&&null!=s&&nI(t,["setup","generationConfig","maxOutputTokens"],s);let a=nS(e,["mediaResolution"]);void 0!==t&&null!=a&&nI(t,["setup","generationConfig","mediaResolution"],a);let u=nS(e,["seed"]);void 0!==t&&null!=u&&nI(t,["setup","generationConfig","seed"],u);let d=nS(e,["speechConfig"]);void 0!==t&&null!=d&&nI(t,["setup","generationConfig","speechConfig"],io(d));let p=nS(e,["thinkingConfig"]);void 0!==t&&null!=p&&nI(t,["setup","generationConfig","thinkingConfig"],p);let c=nS(e,["enableAffectiveDialog"]);void 0!==t&&null!=c&&nI(t,["setup","generationConfig","enableAffectiveDialog"],c);let h=nS(e,["systemInstruction"]);void 0!==t&&null!=h&&nI(t,["setup","systemInstruction"],function(e){let t={},n=nS(e,["parts"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["mediaResolution"]);null!=n&&nI(t,["mediaResolution"],n);let i=nS(e,["codeExecutionResult"]);null!=i&&nI(t,["codeExecutionResult"],i);let r=nS(e,["executableCode"]);null!=r&&nI(t,["executableCode"],r);let l=nS(e,["fileData"]);null!=l&&nI(t,["fileData"],function(e){let t={};if(void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let n=nS(e,["fileUri"]);null!=n&&nI(t,["fileUri"],n);let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(l));let o=nS(e,["functionCall"]);null!=o&&nI(t,["functionCall"],function(e){let t={},n=nS(e,["id"]);null!=n&&nI(t,["id"],n);let i=nS(e,["args"]);null!=i&&nI(t,["args"],i);let r=nS(e,["name"]);if(null!=r&&nI(t,["name"],r),void 0!==nS(e,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==nS(e,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return t;}(o));let s=nS(e,["functionResponse"]);null!=s&&nI(t,["functionResponse"],s);let a=nS(e,["inlineData"]);null!=a&&nI(t,["inlineData"],function(e){let t={},n=nS(e,["data"]);if(null!=n&&nI(t,["data"],n),void 0!==nS(e,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let i=nS(e,["mimeType"]);return null!=i&&nI(t,["mimeType"],i),t;}(a));let u=nS(e,["text"]);null!=u&&nI(t,["text"],u);let d=nS(e,["thought"]);null!=d&&nI(t,["thought"],d);let p=nS(e,["thoughtSignature"]);null!=p&&nI(t,["thoughtSignature"],p);let c=nS(e,["videoMetadata"]);return null!=c&&nI(t,["videoMetadata"],c),t;})(e))),nI(t,["parts"],e);}let i=nS(e,["role"]);return null!=i&&nI(t,["role"],i),t;}(ie(h)));let f=nS(e,["tools"]);if(void 0!==t&&null!=f){let e=ia(f);Array.isArray(e)&&(e=e.map(e=>(function(e){let t={},n=nS(e,["functionDeclarations"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["functionDeclarations"],e);}if(void 0!==nS(e,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let i=nS(e,["googleSearchRetrieval"]);null!=i&&nI(t,["googleSearchRetrieval"],i);let r=nS(e,["computerUse"]);null!=r&&nI(t,["computerUse"],r);let l=nS(e,["fileSearch"]);null!=l&&nI(t,["fileSearch"],l);let o=nS(e,["codeExecution"]);if(null!=o&&nI(t,["codeExecution"],o),void 0!==nS(e,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let s=nS(e,["googleMaps"]);null!=s&&nI(t,["googleMaps"],function(e){let t={};if(void 0!==nS(e,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let n=nS(e,["enableWidget"]);return null!=n&&nI(t,["enableWidget"],n),t;}(s));let a=nS(e,["googleSearch"]);null!=a&&nI(t,["googleSearch"],function(e){let t={};if(void 0!==nS(e,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==nS(e,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let n=nS(e,["timeRangeFilter"]);return null!=n&&nI(t,["timeRangeFilter"],n),t;}(a));let u=nS(e,["urlContext"]);return null!=u&&nI(t,["urlContext"],u),t;})(is(e)))),nI(t,["setup","tools"],e);}let m=nS(e,["sessionResumption"]);void 0!==t&&null!=m&&nI(t,["setup","sessionResumption"],function(e){let t={},n=nS(e,["handle"]);if(null!=n&&nI(t,["handle"],n),void 0!==nS(e,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return t;}(m));let g=nS(e,["inputAudioTranscription"]);void 0!==t&&null!=g&&nI(t,["setup","inputAudioTranscription"],g);let y=nS(e,["outputAudioTranscription"]);void 0!==t&&null!=y&&nI(t,["setup","outputAudioTranscription"],y);let v=nS(e,["realtimeInputConfig"]);void 0!==t&&null!=v&&nI(t,["setup","realtimeInputConfig"],v);let E=nS(e,["contextWindowCompression"]);void 0!==t&&null!=E&&nI(t,["setup","contextWindowCompression"],E);let _=nS(e,["proactivity"]);if(void 0!==t&&null!=_&&nI(t,["setup","proactivity"],_),void 0!==nS(e,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{};}(r,n)),n;}(e,o));let s=nS(t,["lockAdditionalFields"]);return void 0!==n&&null!=s&&nI(n,["fieldMask"],s),{};}(e,i,n)),n;}(this.apiClient,e);i=n_("auth_tokens",l._url),r=l._query,delete l.config,delete l._url,delete l._query;let o=function(e,t){let n=null,i=e.bidiGenerateContentSetup;if("object"==typeof i&&null!==i&&"setup"in i){let t=i.setup;"object"==typeof t&&null!==t?(e.bidiGenerateContentSetup=t,n=t):delete e.bidiGenerateContentSetup;}else void 0!==i&&delete e.bidiGenerateContentSetup;let r=e.fieldMask;if(n){let i=function(e){let t=[];for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)){let i=e[n];if("object"==typeof i&&null!=i&&Object.keys(i).length>0){let e=Object.keys(i).map(e=>`${n}.${e}`);t.push(...e);}else t.push(n);}return t.join(",");}(n);if(Array.isArray(null==t?void 0:t.lockAdditionalFields)&&(null==t?void 0:t.lockAdditionalFields.length)===0)i?e.fieldMask=i:delete e.fieldMask;else if((null==t?void 0:t.lockAdditionalFields)&&t.lockAdditionalFields.length>0&&null!==r&&Array.isArray(r)&&r.length>0){let t=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],n=[];r.length>0&&(n=r.map(e=>t.includes(e)?`generationConfig.${e}`:e));let l=[];i&&l.push(i),n.length>0&&l.push(...n),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask;}else delete e.fieldMask;}else null!==r&&Array.isArray(r)&&r.length>0?e.fieldMask=r.join(","):delete e.fieldMask;return e;}(l,e.config);return this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(o),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}}}class rp extends nE{constructor(e){super(),this.apiClient=e,this.list=async e=>new iT(ti.PAGED_ITEM_DOCUMENTS,t=>this.listInternal({parent:e.parent,config:t.config}),await this.listInternal(e),e);}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);return null!=n&&nI(t,["_url","name"],n),t;}(e);return i=n_("{name}",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["_url","name"],n);let i=nS(e,["config"]);return null!=i&&function(e,t){let n=nS(e,["force"]);void 0!==t&&null!=n&&nI(t,["_query","force"],n);}(i,t),t;}(e);i=n_("{name}",l._url),r=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal});}}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["parent"]);null!=n&&nI(t,["_url","parent"],n);let i=nS(e,["config"]);return null!=i&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);}(i,t),t;}(e);return i=n_("{parent}/documents",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["documents"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["documents"],e);}return t;}(e),n=new nF;return Object.assign(n,t),n;});}}}class rc extends nE{constructor(e,t=new rp(e)){super(),this.apiClient=e,this.documents=t,this.list=async(e={})=>new iT(ti.PAGED_ITEM_FILE_SEARCH_STORES,e=>this.listInternal(e),await this.listInternal(e),e);}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config);}async create(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["displayName"]);void 0!==t&&null!=n&&nI(t,["displayName"],n);}(n,t),t;}(e);return i=n_("fileSearchStores",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}}async get(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);return null!=n&&nI(t,["_url","name"],n),t;}(e);return i=n_("{name}",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>e);}}async delete(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["_url","name"],n);let i=nS(e,["config"]);return null!=i&&function(e,t){let n=nS(e,["force"]);void 0!==t&&null!=n&&nI(t,["_query","force"],n);}(i,t),t;}(e);i=n_("{name}",l._url),r=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal});}}async listInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["config"]);return null!=n&&function(e,t){let n=nS(e,["pageSize"]);void 0!==t&&null!=n&&nI(t,["_query","pageSize"],n);let i=nS(e,["pageToken"]);void 0!==t&&null!=i&&nI(t,["_query","pageToken"],i);}(n,t),t;}(e);return i=n_("fileSearchStores",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["nextPageToken"]);null!=i&&nI(t,["nextPageToken"],i);let r=nS(e,["fileSearchStores"]);if(null!=r){let e=r;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["fileSearchStores"],e);}return t;}(e),n=new nV;return Object.assign(n,t),n;});}}async uploadToFileSearchStoreInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["fileSearchStoreName"]);null!=n&&nI(t,["_url","file_search_store_name"],n);let i=nS(e,["config"]);return null!=i&&i0(i,t),t;}(e);return i=n_("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["sdkHttpResponse"]);return null!=n&&nI(t,["sdkHttpResponse"],n),t;}(e),n=new nB;return Object.assign(n,t),n;});}}async importFile(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e){let t={},n=nS(e,["fileSearchStoreName"]);null!=n&&nI(t,["_url","file_search_store_name"],n);let i=nS(e,["fileName"]);null!=i&&nI(t,["fileName"],i);let r=nS(e,["config"]);return null!=r&&function(e,t){let n=nS(e,["customMetadata"]);if(void 0!==t&&null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI(t,["customMetadata"],e);}let i=nS(e,["chunkingConfig"]);void 0!==t&&null!=i&&nI(t,["chunkingConfig"],i);}(r,t),t;}(e);return i=n_("{file_search_store_name}:importFile",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json()).then(e=>{let t=function(e){let t={},n=nS(e,["name"]);null!=n&&nI(t,["name"],n);let i=nS(e,["metadata"]);null!=i&&nI(t,["metadata"],i);let r=nS(e,["done"]);null!=r&&nI(t,["done"],r);let l=nS(e,["error"]);null!=l&&nI(t,["error"],l);let o=nS(e,["response"]);return null!=o&&nI(t,["response"],function(e){let t={},n=nS(e,["sdkHttpResponse"]);null!=n&&nI(t,["sdkHttpResponse"],n);let i=nS(e,["parent"]);null!=i&&nI(t,["parent"],i);let r=nS(e,["documentName"]);return null!=r&&nI(t,["documentName"],r),t;}(o)),t;}(e),n=new nJ;return Object.assign(n,t),n;});}}}let rh=function(){let{crypto:e}=globalThis;if(null==e?void 0:e.randomUUID)return rh=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^n()&15>>+e/4).toString(16));},rf=()=>rh();function rm(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"));}let rg=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t;}}catch(e){}try{return Error(JSON.stringify(e));}catch(e){}}return Error(e);};class ry extends Error{}class rv extends ry{constructor(e,t,n,i){super(`${rv.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.error=t;}static makeMessage(e,t,n){let i=(null==t?void 0:t.message)?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)";}static generate(e,t,n,i){return e&&i?400===e?new rS(e,t,n,i):401===e?new rT(e,t,n,i):403===e?new rA(e,t,n,i):404===e?new rb(e,t,n,i):409===e?new rC(e,t,n,i):422===e?new rO(e,t,n,i):429===e?new rR(e,t,n,i):e>=500?new rN(e,t,n,i):new rv(e,t,n,i):new r_({message:n,cause:rg(t)});}}class rE extends rv{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0);}}class r_ extends rv{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t);}}class rI extends r_{constructor({message:e}={}){super({message:null!=e?e:"Request timed out."});}}class rS extends rv{}class rT extends rv{}class rA extends rv{}class rb extends rv{}class rC extends rv{}class rO extends rv{}class rR extends rv{}class rN extends rv{}let rP=/^[a-z][a-z0-9+.-]*:/i,rw=e=>rP.test(e),rM=e=>(rM=Array.isArray)(e),rD=rM,rx=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new ry(`${e} must be an integer`);if(t<0)throw new ry(`${e} must be a positive integer`);return t;},rU=e=>{try{return JSON.parse(e);}catch(e){return;}},rk=e=>new Promise(t=>setTimeout(t,e)),rL="0.0.1",rq=()=>{var e,t,n,i,r;let l="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":rL,"X-Stainless-OS":rH(Deno.build.os),"X-Stainless-Arch":rG(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!==(t=null===(e=Deno.version)||void 0===e?void 0:e.deno)&&void 0!==t?t:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":rL,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===l)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":rL,"X-Stainless-OS":rH(null!==(n=globalThis.process.platform)&&void 0!==n?n:"unknown"),"X-Stainless-Arch":rG(null!==(i=globalThis.process.arch)&&void 0!==i?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!==(r=globalThis.process.version)&&void 0!==r?r:"unknown"};let o=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let n=t.exec(navigator.userAgent);if(n){let t=n[1]||0,i=n[2]||0,r=n[3]||0;return{browser:e,version:`${t}.${i}.${r}`};}}return null;}();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":rL,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":rL,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"};},rG=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",rH=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",rj=()=>null!=i?i:i=rq();function rF(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e);}function rV(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return(null==e?void 0:e.done)&&t.releaseLock(),e;}catch(e){throw t.releaseLock(),e;}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0};},[Symbol.asyncIterator](){return this;}};}async function rB(e){var t,n;if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator]){await (null===(n=(t=e[Symbol.asyncIterator]()).return)||void 0===n?void 0:n.call(t));return;}let i=e.getReader(),r=i.cancel();i.releaseLock(),await r;}let rJ=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),r$=()=>{var e;if("undefined"==typeof File){let{process:t}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null===(e=null==t?void 0:t.versions)||void 0===e?void 0:e.node)&&20>parseInt(t.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""));}};function rY(e,t,n){return r$(),new File(e,null!=t?t:"unknown_file",n);}let rK=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],rW=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,rz=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&rW(e),rX=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob;async function rQ(e,t,n){var i;if(r$(),rz(e=await e))return e instanceof File?e:rY([await e.arrayBuffer()],e.name);if(rX(e)){let i=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),rY(await rZ(i),t,n);}let r=await rZ(e);if(t||(t=("object"==typeof(i=e)&&null!==i&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0),!(null==n?void 0:n.type)){let e=r.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(n=Object.assign(Object.assign({},n),{type:e}));}return rY(r,t,n);}async function rZ(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(rW(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(rK(e))try{for(var n,i,r,l,o,s,a=!0,u=iP(e);!(n=(s=await u.next()).done);a=!0)l=s.value,a=!1,t.push(...await rZ(l));}catch(e){i={error:e};}finally{try{!a&&!n&&(r=u.return)&&await r.call(u);}finally{if(i)throw i.error;}}else{let t=null===(o=null==e?void 0:e.constructor)||void 0===o?void 0:o.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`;}(e)}`);}return t;}class r0{constructor(e){this._client=e;}}function r1(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent);}r0._key=[];let r2=Object.freeze(Object.create(null)),r4=((e=r1)=>function(t,...n){let i;if(1===t.length)return t[0];let r=!1,l=[],o=t.reduce((t,i,o)=>{var s,a,u;/[?#]/.test(i)&&(r=!0);let d=n[o],p=(r?encodeURIComponent:e)(""+d);return o!==n.length&&(null==d||"object"==typeof d&&d.toString===(null===(u=Object.getPrototypeOf(null!==(a=Object.getPrototypeOf(null!==(s=d.hasOwnProperty)&&void 0!==s?s:r2))&&void 0!==a?a:r2))||void 0===u?void 0:u.toString))&&(p=d+"",l.push({start:t.length+i.length,length:p.length,error:`Value of type ${Object.prototype.toString.call(d).slice(8,-1)} is not a valid path parameter`})),t+i+(o===n.length?"":p);},""),s=o.split(/[?#]/,1)[0],a=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(i=a.exec(s));)l.push({start:i.index,length:i[0].length,error:`Value "${i[0]}" can't be safely passed as a path parameter`});if(l.sort((e,t)=>e.start-t.start),l.length>0){let e=0,t=l.reduce((t,n)=>{let i=" ".repeat(n.start-e),r="^".repeat(n.length);return e=n.start+n.length,t+i+r;},"");throw new ry(`Path parameters result in path with invalid segments:
${l.map(e=>e.error).join("\n")}
${o}
${t}`);}return o;})(r1);class r3 extends r0{create(e,t){var n;let{api_version:i=this._client.apiVersion}=e,r=iO(e,["api_version"]);if("model"in r&&"agent_config"in r)throw new ry("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in r&&"generation_config"in r)throw new ry("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(r4`/${i}/interactions`,Object.assign(Object.assign({body:r},t),{stream:null!==(n=e.stream)&&void 0!==n&&n}));}delete(e,t={},n){let{api_version:i=this._client.apiVersion}=null!=t?t:{};return this._client.delete(r4`/${i}/interactions/${e}`,n);}cancel(e,t={},n){let{api_version:i=this._client.apiVersion}=null!=t?t:{};return this._client.post(r4`/${i}/interactions/${e}/cancel`,n);}get(e,t={},n){var i;let r=null!=t?t:{},{api_version:l=this._client.apiVersion}=r,o=iO(r,["api_version"]);return this._client.get(r4`/${l}/interactions/${e}`,Object.assign(Object.assign({query:o},n),{stream:null!==(i=null==t?void 0:t.stream)&&void 0!==i&&i}));}}r3._key=Object.freeze(["interactions"]);class r6 extends r3{}function r8(e){let t;return(null!=r?r:r=(t=new globalThis.TextEncoder).encode.bind(t))(e);}function r5(e){let t;return(null!=l?l:l=(t=new globalThis.TextDecoder).decode.bind(t))(e);}class r9{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null;}decode(e){let t;if(null==e)return[];let n=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?r8(e):e;this.buffer=function(e){let t=0;for(let n of e)t+=n.length;let n=new Uint8Array(t),i=0;for(let t of e)n.set(t,i),i+=t.length;return n;}([this.buffer,n]);let i=[];for(;null!=(t=function(e,t){for(let n=null!=t?t:0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0};}return null;}(this.buffer,this.carriageReturnIndex));){if(t.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=t.index;continue;}if(null!=this.carriageReturnIndex&&(t.index!==this.carriageReturnIndex+1||t.carriage)){i.push(r5(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue;}let e=null!==this.carriageReturnIndex?t.preceding-1:t.preceding,n=r5(this.buffer.subarray(0,e));i.push(n),this.buffer=this.buffer.subarray(t.index),this.carriageReturnIndex=null;}return i;}flush(){return this.buffer.length?this.decode("\n"):[];}}r9.NEWLINE_CHARS=new Set(["\n","\r"]),r9.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let r7={off:0,error:200,warn:300,info:400,debug:500},le=(e,t,n)=>{if(e){if(Object.prototype.hasOwnProperty.call(r7,e))return e;ll(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(r7))}`);}};function lt(){}function ln(e,t,n){return!t||r7[e]>r7[n]?lt:t[e].bind(t);}let li={error:lt,warn:lt,info:lt,debug:lt},lr=new WeakMap;function ll(e){var t;let n=e.logger,i=null!==(t=e.logLevel)&&void 0!==t?t:"off";if(!n)return li;let r=lr.get(n);if(r&&r[0]===i)return r[1];let l={error:ln("error",n,i),warn:ln("warn",n,i),info:ln("info",n,i),debug:ln("debug",n,i)};return lr.set(n,[i,l]),l;}let lo=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-goog-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class ls{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n;}static fromSSEResponse(e,t,n){let i=!1,r=n?ll(n):console;return new ls(function(){return iN(this,arguments,function*(){var n,l,o,s;if(i)throw new ry("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let a=!1;try{try{for(var u,d=!0,p=iP(function(e,t){return iN(this,arguments,function*(){var n,i,r,l;if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new ry("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new ry("Attempted to iterate over a response with no body");}let o=new la,s=new r9,a=rV(e.body);try{for(var u,d=!0,p=iP(function(e){return iN(this,arguments,function*(){var t,n,i,r;let l=new Uint8Array;try{for(var o,s=!0,a=iP(e);!(t=(o=yield iR(a.next())).done);s=!0){let e;if(r=o.value,s=!1,null==r)continue;let t=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?r8(r):r,n=new Uint8Array(l.length+t.length);for(n.set(l),n.set(t,l.length),l=n;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4;}return -1;}(l));)yield yield iR(l.slice(0,e)),l=l.slice(e);}}catch(e){n={error:e};}finally{try{!s&&!t&&(i=a.return)&&(yield iR(i.call(a)));}finally{if(n)throw n.error;}}l.length>0&&(yield yield iR(l));});}(a));!(n=(u=yield iR(p.next())).done);d=!0)for(let e of(l=u.value,d=!1,s.decode(l))){let t=o.decode(e);t&&(yield yield iR(t));}}catch(e){i={error:e};}finally{try{!d&&!n&&(r=p.return)&&(yield iR(r.call(p)));}finally{if(i)throw i.error;}}for(let e of s.flush()){let t=o.decode(e);t&&(yield yield iR(t));}});}(e,t));!(n=(u=yield iR(p.next())).done);d=!0)if(s=u.value,d=!1,!a){if(s.data.startsWith("[DONE]")){a=!0;continue;}try{yield yield iR(JSON.parse(s.data));}catch(e){throw r.error("Could not parse message into JSON:",s.data),r.error("From chunk:",s.raw),e;}}}catch(e){l={error:e};}finally{try{!d&&!n&&(o=p.return)&&(yield iR(o.call(p)));}finally{if(l)throw l.error;}}a=!0;}catch(e){if(rm(e))return yield iR(void 0);throw e;}finally{a||t.abort();}});},t,n);}static fromReadableStream(e,t,n){let i=!1;return new ls(function(){return iN(this,arguments,function*(){var n,r,l,o;if(i)throw new ry("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let s=!1;try{try{for(var a,u=!0,d=iP(function(){return iN(this,arguments,function*(){var t,n,i,r;let l=new r9,o=rV(e);try{for(var s,a=!0,u=iP(o);!(t=(s=yield iR(u.next())).done);a=!0)for(let e of(r=s.value,a=!1,l.decode(r)))yield yield iR(e);}catch(e){n={error:e};}finally{try{!a&&!t&&(i=u.return)&&(yield iR(i.call(u)));}finally{if(n)throw n.error;}}for(let e of l.flush())yield yield iR(e);});}());!(n=(a=yield iR(d.next())).done);u=!0)o=a.value,u=!1,!s&&o&&(yield yield iR(JSON.parse(o)));}catch(e){r={error:e};}finally{try{!u&&!n&&(l=d.return)&&(yield iR(l.call(d)));}finally{if(r)throw r.error;}}s=!0;}catch(e){if(rm(e))return yield iR(void 0);throw e;}finally{s||t.abort();}});},t,n);}[Symbol.asyncIterator](){return this.iterator();}tee(){let e=[],t=[],n=this.iterator(),i=i=>({next:()=>{if(0===i.length){let i=n.next();e.push(i),t.push(i);}return i.shift();}});return[new ls(()=>i(e),this.controller,this.client),new ls(()=>i(t),this.controller,this.client)];}toReadableStream(){let e;let t=this;return rF({async start(){e=t[Symbol.asyncIterator]();},async pull(t){try{let{value:n,done:i}=await e.next();if(i)return t.close();let r=r8(JSON.stringify(n)+"\n");t.enqueue(r);}catch(e){t.error(e);}},async cancel(){var t;await (null===(t=e.return)||void 0===t?void 0:t.call(e));}});}}class la{constructor(){this.event=null,this.data=[],this.chunks=[];}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e;}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=function(e,t){let n=e.indexOf(":");return -1!==n?[e.substring(0,n),":",e.substring(n+t.length)]:[e,"",""];}(e,":");return i.startsWith(" ")&&(i=i.substring(1)),"event"===t?this.event=i:"data"===t&&this.data.push(i),null;}}async function lu(e,t){let{response:n,requestLogID:i,retryOfRequestLogID:r,startTime:l}=t,o=await (async()=>{var i;if(t.options.stream)return(ll(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(n,t.controller,e):ls.fromSSEResponse(n,t.controller,e);if(204===n.status)return null;if(t.options.__binaryResponse)return n;let r=n.headers.get("content-type"),l=null===(i=null==r?void 0:r.split(";")[0])||void 0===i?void 0:i.trim();return(null==l?void 0:l.includes("application/json"))||(null==l?void 0:l.endsWith("+json"))?await n.json():await n.text();})();return ll(e).debug(`[${i}] response parsed`,lo({retryOfRequestLogID:r,url:n.url,status:n.status,body:o,durationMs:Date.now()-l})),o;}class ld extends Promise{constructor(e,t,n=lu){super(e=>{e(null);}),this.responsePromise=t,this.parseResponse=n,this.client=e;}_thenUnwrap(e){return new ld(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n));}asResponse(){return this.responsePromise.then(e=>e.response);}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t};}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise;}then(e,t){return this.parse().then(e,t);}catch(e){return this.parse().catch(e);}finally(e){return this.parse().finally(e);}}let lp=Symbol("brand.privateNullableHeaders"),lc=e=>{let t=new Headers,n=new Set;for(let i of e){let e=new Set;for(let[r,l]of function*(e){let t;if(!e)return;if(lp in e){let{values:t,nulls:n}=e;for(let e of(yield*t.entries(),n))yield[e,null];return;}let n=!1;for(let i of(e instanceof Headers?t=e.entries():rD(e)?t=e:(n=!0,t=Object.entries(null!=e?e:{})),t)){let e=i[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=rD(i[1])?i[1]:[i[1]],r=!1;for(let i of t)void 0!==i&&(n&&!r&&(r=!0,yield[e,null]),yield[e,i]);}}(i)){let i=r.toLowerCase();e.has(i)||(t.delete(r),e.add(i)),null===l?(t.delete(r),n.add(i)):(t.append(r,l),n.delete(i));}}return{[lp]:!0,values:t,nulls:n};},lh=e=>{var t,n,i,r,l,o;return void 0!==globalThis.process?null!==(i=null===(n=null===(t=globalThis.process.env)||void 0===t?void 0:t[e])||void 0===n?void 0:n.trim())&&void 0!==i?i:void 0:void 0!==globalThis.Deno?null===(o=null===(l=null===(r=globalThis.Deno.env)||void 0===r?void 0:r.get)||void 0===l?void 0:l.call(r,e))||void 0===o?void 0:o.trim():void 0;};class lf{constructor(e){var t,n,i,r,l,o,s,{baseURL:a=lh("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:u=null!==(t=lh("GEMINI_API_KEY"))&&void 0!==t?t:null,apiVersion:d="v1beta"}=e;let p=Object.assign(Object.assign({apiKey:u,apiVersion:d},iO(e,["baseURL","apiKey","apiVersion"])),{baseURL:a||"https://generativelanguage.googleapis.com"});this.baseURL=p.baseURL,this.timeout=null!==(n=p.timeout)&&void 0!==n?n:lf.DEFAULT_TIMEOUT,this.logger=null!==(i=p.logger)&&void 0!==i?i:console;let c="warn";this.logLevel=c,this.logLevel=null!==(l=null!==(r=le(p.logLevel,"ClientOptions.logLevel",this))&&void 0!==r?r:le(lh("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))&&void 0!==l?l:c,this.fetchOptions=p.fetchOptions,this.maxRetries=null!==(o=p.maxRetries)&&void 0!==o?o:2,this.fetch=null!==(s=p.fetch)&&void 0!==s?s:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`");}(),this.encoder=rJ,this._options=p,this.apiKey=u,this.apiVersion=d,this.clientAdapter=p.clientAdapter;}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e));}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL;}defaultQuery(){return this._options.defaultQuery;}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key")||this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted');}async authHeaders(e){let t=lc([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return lc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return lc([await this.clientAdapter.getAuthHeaders()]);}}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new ry(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`);}).join("&");}getUserAgent(){return`${this.constructor.name}/JS ${rL}`;}defaultIdempotencyKey(){return`stainless-node-retry-${rf()}`;}makeStatusError(e,t,n,i){return rv.generate(e,t,n,i);}buildURL(e,t,n){let i=!this.baseURLOverridden()&&n||this.baseURL,r=new URL(rw(e)?e:i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0;}(l)&&(t=Object.assign(Object.assign({},l),t)),"object"==typeof t&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString();}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){let t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`;}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t);}post(e,t){return this.methodRequest("post",e,t);}patch(e,t){return this.methodRequest("patch",e,t);}put(e,t){return this.methodRequest("put",e,t);}delete(e,t){return this.methodRequest("delete",e,t);}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(n=>Object.assign({method:e,path:t},n)));}request(e,t=null){return new ld(this,this.makeRequest(e,t,void 0));}async makeRequest(e,t,n){var i,r,l;let o=await e,s=null!==(i=o.maxRetries)&&void 0!==i?i:this.maxRetries;null==t&&(t=s),await this.prepareOptions(o);let{req:a,url:u,timeout:d}=await this.buildRequest(o,{retryCount:s-t});await this.prepareRequest(a,{url:u,options:o});let p="log_"+(16777216*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===n?"":`, retryOf: ${n}`,h=Date.now();if(ll(this).debug(`[${p}] sending request`,lo({retryOfRequestLogID:n,method:o.method,url:u,options:o,headers:a.headers})),null===(r=o.signal)||void 0===r?void 0:r.aborted)throw new rE;let f=new AbortController,m=await this.fetchWithTimeout(u,a,d,f).catch(rg),g=Date.now();if(m instanceof globalThis.Error){let e=`retrying, ${t} attempts remaining`;if(null===(l=o.signal)||void 0===l?void 0:l.aborted)throw new rE;let i=rm(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(t)return ll(this).info(`[${p}] connection ${i?"timed out":"failed"} - ${e}`),ll(this).debug(`[${p}] connection ${i?"timed out":"failed"} (${e})`,lo({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),this.retryRequest(o,t,null!=n?n:p);if(ll(this).info(`[${p}] connection ${i?"timed out":"failed"} - error; no more retries left`),ll(this).debug(`[${p}] connection ${i?"timed out":"failed"} (error; no more retries left)`,lo({retryOfRequestLogID:n,url:u,durationMs:g-h,message:m.message})),i)throw new rI;throw new r_({cause:m});}let y=`[${p}${c}] ${a.method} ${u} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${g-h}ms`;if(!m.ok){let e=await this.shouldRetry(m);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await rB(m.body),ll(this).info(`${y} - ${e}`),ll(this).debug(`[${p}] response error (${e})`,lo({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),this.retryRequest(o,t,null!=n?n:p,m.headers);}let i=e?"error; no more retries left":"error; not retryable";ll(this).info(`${y} - ${i}`);let r=await m.text().catch(e=>rg(e).message),l=rU(r),s=l?void 0:r;throw ll(this).debug(`[${p}] response error (${i})`,lo({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:s,durationMs:Date.now()-h})),this.makeStatusError(m.status,l,s,m.headers);}return ll(this).info(y),ll(this).debug(`[${p}] response start`,lo({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:g-h})),{response:m,options:o,controller:f,requestLogID:p,retryOfRequestLogID:n,startTime:h};}async fetchWithTimeout(e,t,n,i){let r=t||{},{signal:l,method:o}=r,s=iO(r,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());let a=setTimeout(()=>i.abort(),n),u=globalThis.ReadableStream&&s.body instanceof globalThis.ReadableStream||"object"==typeof s.body&&null!==s.body&&Symbol.asyncIterator in s.body,d=Object.assign(Object.assign(Object.assign({signal:i.signal},u?{duplex:"half"}:{}),{method:"GET"}),s);o&&(d.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,d);}finally{clearTimeout(a);}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500);}async retryRequest(e,t,n,i){var r;let l;let o=null==i?void 0:i.get("retry-after-ms");if(o){let e=parseFloat(o);Number.isNaN(e)||(l=e);}let s=null==i?void 0:i.get("retry-after");if(s&&!l){let e=parseFloat(s);l=Number.isNaN(e)?Date.parse(s)-Date.now():1e3*e;}if(!(l&&0<=l&&l<6e4)){let n=null!==(r=e.maxRetries)&&void 0!==r?r:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,n);}return await rk(l),this.makeRequest(e,t-1,n);}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3;}async buildRequest(e,{retryCount:t=0}={}){var n,i,r;let l=Object.assign({},e),{method:o,path:s,query:a,defaultBaseURL:u}=l,d=this.buildURL(s,a,u);"timeout"in l&&rx("timeout",l.timeout),l.timeout=null!==(n=l.timeout)&&void 0!==n?n:this.timeout;let{bodyHeaders:p,body:c}=this.buildBody({options:l}),h=await this.buildHeaders({options:e,method:o,bodyHeaders:p,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:o,headers:h},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"}),c&&{body:c}),null!==(i=this.fetchOptions)&&void 0!==i?i:{}),null!==(r=l.fetchOptions)&&void 0!==r?r:{}),url:d,timeout:l.timeout};}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:i}){let r={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);let l=await this.authHeaders(e),o=lc([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),rj()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(o),o.values;}buildBody({options:{body:e,headers:t}}){let n;if(!e)return{bodyHeaders:void 0,body:void 0};let i=lc([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:(n=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator](),rF({start(){},async pull(e){let{done:t,value:i}=await n.next();t?e.close():e.enqueue(i);},async cancel(){var e;await (null===(e=n.return)||void 0===e?void 0:e.call(n));}}))}:this.encoder({body:e,headers:i});}}lf.DEFAULT_TIMEOUT=6e4;class lm extends lf{constructor(){super(...arguments),this.interactions=new r6(this);}}function lg(e,t){let n={},i=nS(e,["sdkHttpResponse"]);null!=i&&nI(n,["sdkHttpResponse"],i);let r=nS(e,["name"]);null!=r&&nI(n,["name"],r);let l=nS(e,["state"]);null!=l&&nI(n,["state"],id(l));let o=nS(e,["createTime"]);null!=o&&nI(n,["createTime"],o);let s=nS(e,["tuningTask","startTime"]);null!=s&&nI(n,["startTime"],s);let a=nS(e,["tuningTask","completeTime"]);null!=a&&nI(n,["endTime"],a);let u=nS(e,["updateTime"]);null!=u&&nI(n,["updateTime"],u);let d=nS(e,["description"]);null!=d&&nI(n,["description"],d);let p=nS(e,["baseModel"]);null!=p&&nI(n,["baseModel"],p);let c=nS(e,["_self"]);return null!=c&&nI(n,["tunedModel"],function(e,t){let n={},i=nS(e,["name"]);null!=i&&nI(n,["model"],i);let r=nS(e,["name"]);return null!=r&&nI(n,["endpoint"],r),n;}(c)),n;}function ly(e,t){let n={},i=nS(e,["sdkHttpResponse"]);null!=i&&nI(n,["sdkHttpResponse"],i);let r=nS(e,["name"]);null!=r&&nI(n,["name"],r);let l=nS(e,["state"]);null!=l&&nI(n,["state"],id(l));let o=nS(e,["createTime"]);null!=o&&nI(n,["createTime"],o);let s=nS(e,["startTime"]);null!=s&&nI(n,["startTime"],s);let a=nS(e,["endTime"]);null!=a&&nI(n,["endTime"],a);let u=nS(e,["updateTime"]);null!=u&&nI(n,["updateTime"],u);let d=nS(e,["error"]);null!=d&&nI(n,["error"],d);let p=nS(e,["description"]);null!=p&&nI(n,["description"],p);let c=nS(e,["baseModel"]);null!=c&&nI(n,["baseModel"],c);let h=nS(e,["tunedModel"]);null!=h&&nI(n,["tunedModel"],h);let f=nS(e,["preTunedModel"]);null!=f&&nI(n,["preTunedModel"],f);let m=nS(e,["supervisedTuningSpec"]);null!=m&&nI(n,["supervisedTuningSpec"],m);let g=nS(e,["preferenceOptimizationSpec"]);null!=g&&nI(n,["preferenceOptimizationSpec"],g);let y=nS(e,["tuningDataStats"]);null!=y&&nI(n,["tuningDataStats"],y);let v=nS(e,["encryptionSpec"]);null!=v&&nI(n,["encryptionSpec"],v);let E=nS(e,["partnerModelTuningSpec"]);null!=E&&nI(n,["partnerModelTuningSpec"],E);let _=nS(e,["customBaseModel"]);null!=_&&nI(n,["customBaseModel"],_);let I=nS(e,["experiment"]);null!=I&&nI(n,["experiment"],I);let S=nS(e,["labels"]);null!=S&&nI(n,["labels"],S);let T=nS(e,["outputUri"]);null!=T&&nI(n,["outputUri"],T);let A=nS(e,["pipelineJob"]);null!=A&&nI(n,["pipelineJob"],A);let b=nS(e,["serviceAccount"]);null!=b&&nI(n,["serviceAccount"],b);let C=nS(e,["tunedModelDisplayName"]);null!=C&&nI(n,["tunedModelDisplayName"],C);let O=nS(e,["veoTuningSpec"]);return null!=O&&nI(n,["veoTuningSpec"],O),n;}function lv(e,t){let n={},i=nS(e,["gcsUri"]);null!=i&&nI(n,["validationDatasetUri"],i);let r=nS(e,["vertexDatasetResource"]);return null!=r&&nI(n,["validationDatasetUri"],r),n;}lm.GeminiNextGenAPIClient=lm,lm.GeminiNextGenAPIClientError=ry,lm.APIError=rv,lm.APIConnectionError=r_,lm.APIConnectionTimeoutError=rI,lm.APIUserAbortError=rE,lm.NotFoundError=rb,lm.ConflictError=rC,lm.RateLimitError=rR,lm.BadRequestError=rS,lm.AuthenticationError=rT,lm.InternalServerError=rN,lm.PermissionDeniedError=rA,lm.UnprocessableEntityError=rO,lm.toFile=rQ,lm.Interactions=r6;class lE extends nE{constructor(e){super(),this.apiClient=e,this.list=async(e={})=>new iT(ti.PAGED_ITEM_TUNING_JOBS,e=>this.listInternal(e),await this.listInternal(e),e),this.get=async e=>await this.getInternal(e),this.tune=async e=>{var t;if(this.apiClient.isVertexAI()){if(e.baseModel.startsWith("projects/")){let n={tunedModelName:e.baseModel};(null===(t=e.config)||void 0===t?void 0:t.preTunedModelCheckpointId)&&(n.checkpointId=e.config.preTunedModelCheckpointId);let i=Object.assign(Object.assign({},e),{preTunedModel:n});return i.baseModel=void 0,await this.tuneInternal(i);}{let t=Object.assign({},e);return await this.tuneInternal(t);}}{let t=Object.assign({},e),n=await this.tuneMldevInternal(t),i="";return void 0!==n.metadata&&void 0!==n.metadata.tunedModel?i=n.metadata.tunedModel:void 0!==n.name&&n.name.includes("/operations/")&&(i=n.name.split("/operations/")[0]),{name:i,state:ex.JOB_STATE_QUEUED};}};}async getInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(e,["name"]);return null!=i&&nI(n,["_url","name"],i),n;}(e);return l=n_("{name}",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ly(e));}{let t=function(e,t){let n={},i=nS(e,["name"]);return null!=i&&nI(n,["_url","name"],i),n;}(e);return l=n_("{name}",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>lg(e));}}async listInternal(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(e,["config"]);return null!=i&&function(e,t,n){let i=nS(e,["pageSize"]);void 0!==t&&null!=i&&nI(t,["_query","pageSize"],i);let r=nS(e,["pageToken"]);void 0!==t&&null!=r&&nI(t,["_query","pageToken"],r);let l=nS(e,["filter"]);void 0!==t&&null!=l&&nI(t,["_query","filter"],l);}(i,n),n;}(e);return l=n_("tuningJobs",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"GET",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=nS(e,["sdkHttpResponse"]);null!=i&&nI(n,["sdkHttpResponse"],i);let r=nS(e,["nextPageToken"]);null!=r&&nI(n,["nextPageToken"],r);let l=nS(e,["tuningJobs"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>ly(e))),nI(n,["tuningJobs"],e);}return n;}(e),n=new nq;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(e,["config"]);return null!=i&&function(e,t,n){let i=nS(e,["pageSize"]);void 0!==t&&null!=i&&nI(t,["_query","pageSize"],i);let r=nS(e,["pageToken"]);void 0!==t&&null!=r&&nI(t,["_query","pageToken"],r);let l=nS(e,["filter"]);void 0!==t&&null!=l&&nI(t,["_query","filter"],l);}(i,n),n;}(e);return l=n_("tunedModels",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"GET",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=nS(e,["sdkHttpResponse"]);null!=i&&nI(n,["sdkHttpResponse"],i);let r=nS(e,["nextPageToken"]);null!=r&&nI(n,["nextPageToken"],r);let l=nS(e,["tunedModels"]);if(null!=l){let e=l;Array.isArray(e)&&(e=e.map(e=>lg(e))),nI(n,["tuningJobs"],e);}return n;}(e),n=new nq;return Object.assign(n,t),n;});}}async cancel(e){var t,n,i,r;let l="",o={};if(this.apiClient.isVertexAI()){let i=function(e,t){let n={},i=nS(e,["name"]);return null!=i&&nI(n,["_url","name"],i),n;}(e);return l=n_("{name}:cancel",i._url),o=i._query,delete i._url,delete i._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(i),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=nS(e,["sdkHttpResponse"]);return null!=i&&nI(n,["sdkHttpResponse"],i),n;}(e),n=new nG;return Object.assign(n,t),n;});}{let t=function(e,t){let n={},i=nS(e,["name"]);return null!=i&&nI(n,["_url","name"],i),n;}(e);return l=n_("{name}:cancel",t._url),o=t._query,delete t._url,delete t._query,this.apiClient.request({path:l,queryParams:o,body:JSON.stringify(t),httpMethod:"POST",httpOptions:null===(i=e.config)||void 0===i?void 0:i.httpOptions,abortSignal:null===(r=e.config)||void 0===r?void 0:r.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>{let t=function(e,t){let n={},i=nS(e,["sdkHttpResponse"]);return null!=i&&nI(n,["sdkHttpResponse"],i),n;}(e),n=new nG;return Object.assign(n,t),n;});}}async tuneInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI()){let l=function(e,t){let n={},i=nS(e,["baseModel"]);null!=i&&nI(n,["baseModel"],i);let r=nS(e,["preTunedModel"]);null!=r&&nI(n,["preTunedModel"],r);let l=nS(e,["trainingDataset"]);null!=l&&function(e,t,n){let i=nS(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=nS(e,["gcsUri"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","trainingDatasetUri"],n);}else if("PREFERENCE_TUNING"===i){let n=nS(e,["gcsUri"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","trainingDatasetUri"],n);}let r=nS(n,["config","method"]);if(void 0===r&&(r="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===r){let n=nS(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","trainingDatasetUri"],n);}else if("PREFERENCE_TUNING"===r){let n=nS(e,["vertexDatasetResource"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","trainingDatasetUri"],n);}if(void 0!==nS(e,["examples"]))throw Error("examples parameter is not supported in Vertex AI.");}(l,n,t);let o=nS(e,["config"]);return null!=o&&function(e,t,n){let i=nS(n,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let n=nS(e,["validationDataset"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec"],lv(n));}else if("PREFERENCE_TUNING"===i){let n=nS(e,["validationDataset"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec"],lv(n));}let r=nS(e,["tunedModelDisplayName"]);void 0!==t&&null!=r&&nI(t,["tunedModelDisplayName"],r);let l=nS(e,["description"]);void 0!==t&&null!=l&&nI(t,["description"],l);let o=nS(n,["config","method"]);if(void 0===o&&(o="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===o){let n=nS(e,["epochCount"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","hyperParameters","epochCount"],n);}else if("PREFERENCE_TUNING"===o){let n=nS(e,["epochCount"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],n);}let s=nS(n,["config","method"]);if(void 0===s&&(s="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===s){let n=nS(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],n);}else if("PREFERENCE_TUNING"===s){let n=nS(e,["learningRateMultiplier"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],n);}let a=nS(n,["config","method"]);if(void 0===a&&(a="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===a){let n=nS(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","exportLastCheckpointOnly"],n);}else if("PREFERENCE_TUNING"===a){let n=nS(e,["exportLastCheckpointOnly"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],n);}let u=nS(n,["config","method"]);if(void 0===u&&(u="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===u){let n=nS(e,["adapterSize"]);void 0!==t&&null!=n&&nI(t,["supervisedTuningSpec","hyperParameters","adapterSize"],n);}else if("PREFERENCE_TUNING"===u){let n=nS(e,["adapterSize"]);void 0!==t&&null!=n&&nI(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],n);}if(void 0!==nS(e,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==nS(e,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let d=nS(e,["labels"]);void 0!==t&&null!=d&&nI(t,["labels"],d);let p=nS(e,["beta"]);void 0!==t&&null!=p&&nI(t,["preferenceOptimizationSpec","hyperParameters","beta"],p);}(o,n,t),n;}(e,e);return i=n_("tuningJobs",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>ly(e));}throw Error("This method is only supported by the Vertex AI.");}async tuneMldevInternal(e){var t,n;let i="",r={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let l=function(e,t){let n={},i=nS(e,["baseModel"]);null!=i&&nI(n,["baseModel"],i);let r=nS(e,["preTunedModel"]);null!=r&&nI(n,["preTunedModel"],r);let l=nS(e,["trainingDataset"]);null!=l&&function(e,t){if(void 0!==nS(e,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==nS(e,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let n=nS(e,["examples"]);if(null!=n){let e=n;Array.isArray(e)&&(e=e.map(e=>e)),nI({},["examples","examples"],e);}}(l);let o=nS(e,["config"]);return null!=o&&function(e,t,n){if(void 0!==nS(e,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let i=nS(e,["tunedModelDisplayName"]);if(void 0!==t&&null!=i&&nI(t,["displayName"],i),void 0!==nS(e,["description"]))throw Error("description parameter is not supported in Gemini API.");let r=nS(e,["epochCount"]);void 0!==t&&null!=r&&nI(t,["tuningTask","hyperparameters","epochCount"],r);let l=nS(e,["learningRateMultiplier"]);if(null!=l&&nI({},["tuningTask","hyperparameters","learningRateMultiplier"],l),void 0!==nS(e,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==nS(e,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==nS(e,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let o=nS(e,["batchSize"]);void 0!==t&&null!=o&&nI(t,["tuningTask","hyperparameters","batchSize"],o);let s=nS(e,["learningRate"]);if(void 0!==t&&null!=s&&nI(t,["tuningTask","hyperparameters","learningRate"],s),void 0!==nS(e,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==nS(e,["beta"]))throw Error("beta parameter is not supported in Gemini API.");}(o,n),n;}(e);return i=n_("tunedModels",l._url),r=l._query,delete l._url,delete l._query,this.apiClient.request({path:i,queryParams:r,body:JSON.stringify(l),httpMethod:"POST",httpOptions:null===(t=e.config)||void 0===t?void 0:t.httpOptions,abortSignal:null===(n=e.config)||void 0===n?void 0:n.abortSignal}).then(e=>e.json().then(t=>(t.sdkHttpResponse={headers:e.headers},t))).then(e=>(function(e,t){let n={},i=nS(e,["sdkHttpResponse"]);null!=i&&nI(n,["sdkHttpResponse"],i);let r=nS(e,["name"]);null!=r&&nI(n,["name"],r);let l=nS(e,["metadata"]);null!=l&&nI(n,["metadata"],l);let o=nS(e,["done"]);null!=o&&nI(n,["done"],o);let s=nS(e,["error"]);return null!=s&&nI(n,["error"],s),n;})(e));}}}class l_{async download(e,t){throw Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.");}}let lI="x-goog-upload-status";async function lS(e,t,n){var i;let r=await lA(e,t,n),l=await (null==r?void 0:r.json());if((null===(i=null==r?void 0:r.headers)||void 0===i?void 0:i[lI])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return l.file;}async function lT(e,t,n){var i;let r=await lA(e,t,n),l=await (null==r?void 0:r.json());if((null===(i=null==r?void 0:r.headers)||void 0===i?void 0:i[lI])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let o=nA(l),s=new nQ;return Object.assign(s,o),s;}async function lA(e,t,n){var i,r;let l=0,o=0,s=new nb(new Response),a="upload";for(l=e.size;o<l;){let u=Math.min(8388608,l-o),d=e.slice(o,o+u);o+u>=l&&(a+=", finalize");let p=0,c=1e3;for(;p<3&&(null===(i=null==(s=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":a,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}))?void 0:s.headers)||void 0===i||!i[lI]);)p++,await function(e){return new Promise(t=>setTimeout(t,e));}(c),c*=2;if(o+=u,(null===(r=null==s?void 0:s.headers)||void 0===r?void 0:r[lI])!=="active")break;if(l<=o)throw Error("All content has been uploaded, but the upload status is not finalized.");}return s;}async function lb(e){return{size:e.size,type:e.type};}class lC{async upload(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await lS(e,t,n);}async uploadToFileSearchStore(e,t,n){if("string"==typeof e)throw Error("File path is not supported in browser uploader.");return await lT(e,t,n);}async stat(e){if("string"!=typeof e)return await lb(e);throw Error("File path is not supported in browser uploader.");}}class lO{create(e,t,n){return new lR(e,t,n);}}class lR{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n;}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage;}send(e){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(e);}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close();}}let lN="x-goog-api-key";class lP{constructor(e){this.apiKey=e;}async addAuthHeaders(e,t){if(null===e.get(lN)){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw Error("API key is missing. Please provide a valid API key.");e.append(lN,this.apiKey);}}}class lw{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let e=this.httpOptions;(null==e?void 0:e.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let t=new lm({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==e?void 0:e.timeout});return this._interactions=t.interactions,this._interactions;}constructor(e){var t;if(null==e.apiKey)throw Error("An API Key must be set when running in a browser");if(e.project||e.location)throw Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=null!==(t=e.vertexai)&&void 0!==t&&t,this.apiKey=e.apiKey;let n=function(e,t,n,i){var r,l;if(!(null==e?void 0:e.baseUrl)){let e={geminiUrl:o,vertexUrl:s};return t?null!==(r=e.vertexUrl)&&void 0!==r?r:n:null!==(l=e.geminiUrl)&&void 0!==l?l:i;}return e.baseUrl;}(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;let i=new lP(this.apiKey);this.apiClient=new i2({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/web",uploader:new lC,downloader:new l_}),this.models=new ra(this.apiClient),this.live=new rt(this.apiClient,i,new lO),this.batches=new iA(this.apiClient),this.chats=new iD(this.models,this.apiClient),this.caches=new iC(this.apiClient),this.files=new ik(this.apiClient),this.operations=new ru(this.apiClient),this.authTokens=new rd(this.apiClient),this.tunings=new lE(this.apiClient),this.fileSearchStores=new rc(this.apiClient);}}class lM extends ny{async generate(e){let{api_key:t}=e;if(!t)throw Error("Gemini API key is required");let n=this.generateUserPrompt(e);try{let e=new lw({apiKey:t}),i=await e.models.generateContent({model:"gemini-3-flash-preview",contents:[{parts:[{text:ng+"\n\n"+n}]}]}),r="";if(i.candidates&&i.candidates.length>0){let e=i.candidates[0];e.content&&e.content.parts&&(r=e.content.parts.filter(e=>e.text).map(e=>e.text).join("\n"));}return this.parseResponse(r);}catch(e){throw console.error("Error calling Gemini API:",e),e;}}}lM=nm([(0,nf.injectable)()],lM);class lD extends ny{async generate(e){let{api_key:t}=e;if(!t)throw Error("MiMo API key is required");let n=this.generateUserPrompt(e);try{let e=await fetch("https://api.xiaomimimo.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({model:"mimo-v2-flash",messages:[{role:"system",content:ng},{role:"user",content:n}],temperature:.8,top_p:.95,max_tokens:4096,stream:!1,extra_body:{thinking:{type:"enabled"}}})});if(!e.ok){let t=await e.text();throw console.error("MiMo API error:",{status:e.status,statusText:e.statusText,url:e.url,errorData:t}),Error(`MiMo API request failed with status ${e.status}: ${e.statusText}`);}let i=(await e.json()).choices[0].message.content;return this.parseResponse(i);}catch(e){if(console.error("Error calling MiMo API:",e),e instanceof TypeError&&e.message.includes("Failed to fetch"))throw Error("MiMo API \u8BF7\u6C42\u5931\u8D25\uFF1A\u9047\u5230\u8DE8\u57DF\u95EE\u9898\uFF08CORS\uFF09\u3002\n\u89E3\u51B3\u65B9\u6848\uFF1A\n1. \u5EFA\u8BAE\u5728\u672C\u5730\u5F00\u53D1\u73AF\u5883\u4E2D\u4F7F\u7528 MiMo \u6A21\u578B\n2. \u6216\u4F7F\u7528\u5176\u4ED6\u6A21\u578B\u5982 DeepSeek \u6216 Gemini\n3. \u6216\u90E8\u7F72\u81EA\u5DF1\u7684 CORS \u4EE3\u7406\u670D\u52A1\n\n\u672C\u5730\u5F00\u53D1\u73AF\u5883\u542F\u52A8\u65B9\u5F0F\uFF1A\n1. \u514B\u9686\u4ED3\u5E93\u5230\u672C\u5730\n2. \u8FD0\u884C pnpm install \u5B89\u88C5\u4F9D\u8D56\n3. \u8FD0\u884C pnpm dev \u542F\u52A8\u5F00\u53D1\u670D\u52A1\u5668\n4. \u5728 http://localhost:8000 \u4E0A\u4F7F\u7528\u5E94\u7528");throw e;}}}lD=nm([(0,nf.injectable)()],lD);var lx=n("e236400f");let lU=`Symphonic Pop-Rock, Mandopop, Baroque Pop-Rock, J-Rock Influence, Heavy distorted guitars over symphonic orchestration, Sophisticated Chord Progressions. Breathy Female Vocals, Clear Emotive Tone, Soaring High Notes, Sustained High Notes, Moderate Vibrato, Introspective to Powerful. Theatrical, Epic.
INTRO: Cinematic atmosphere, slow build up, high strings ensemble in lyrical counterpoint over classical piano arpeggios and warm pad.
VERSE: Breathy female vocals (introspective tone), delicate piano, acoustic guitar arpeggios, light percussion.
PRE-CHORUS: Emotional crescendo, dramatic build-up.
CHORUS: Powerful belting vocals, sustained high notes, richly stacked harmonies, heavy distorted guitars + power chords, high strings unison counterpoint, fast driving cinematic drums, huge wall of sound.
INTERLUDE: Lyrical electric guitar solo trading melodies with high strings.
BRIDGE: Emotional climax, building high tension.
OUTRO: Fading out with piano arpeggio and soft strings.`,lk=`[Intro Chorus]
[Arrangement: Ethereal atmosphere, Cold Open]
[Instrument: Classical Grand Piano only, No Drums, No Guitar]
[Dynamics: mp, emotional and intimate]
Forever Forever
\u{65E0}\u{8BBA}\u{4F60}\u{8D70}\u{5230}\u{54EA}
\u{4E5F}\u{8981}\u{5728}\u{540C}\u{4E00}\u{7247}\u{5929}\u{7A7A}\u{4E0B}\u{53D1}\u{5149}
Forever Forever
\u{628A}\u{5FAC}\u{5FA8}\u{7684}\u{5FC3}\u{90FD}\u{70B9}\u{4EAE}
\u{62E5}\u{62B1}\u{5F7C}\u{6B64}\u{7684}\u{6A21}\u{6837}
\u{6C38}\u{6052}\u{56DE}\u{5FC6}\u{5C31}\u{50CF}\u{6052}\u{661F}\u{4E0D}\u{5FD8}

[Instrumental Hook]
[Arrangement: Sudden Energy Explosion, J-Rock Influence]
[Instrument: Heavy Distorted Guitars, High Strings Ensemble, Driving Rock Drums]
[Dynamics: ff, Epic Start]

[Verse 1]
[Vocal: Breathy female vocals, Introspective tone, Near microphone]
[Instrument: Minimalist Piano, Broken Chords, Bass pulse enters]
[Dynamics: p, gentle storytelling]
\u{6D41}\u{661F}\u{5212}\u{8FC7}\u{55A7}\u{6270}\u{7A79}\u{82CD}
\u{53EF}\u{66FE}\u{56DE}\u{5E94}\u{8C01}\u{7684}\u{613F}\u{671B}
\u{6211}\u{5DF2}\u{8D70}\u{5230}\u{513F}\u{65F6}\u{7684}\u{8FDC}\u{65B9}
\u{5374}\u{9057}\u{5931}\u{4E86}\u{81EA}\u{5DF1}\u{7684}\u{6A21}\u{6837}

[Verse 2]
[Vocal: Clear emotive tone, slightly stronger presence]
[Arrangement: Building up]
[Instrument: Acoustic Guitar Strumming, Piano high notes, Light Snare]
[Dynamics: mp -> mf, flowing]
\u{68A6}\u{60F3}\u{9010}\u{6E10}\u{589E}\u{52A0}\u{91CD}\u{91CF}
\u{6211}\u{4EEC}\u{662F}\u{5426}\u{4E0D}\u{518D}\u{5E7B}\u{60F3}
\u{7528}\u{5C3D}\u{6574}\u{4E2A}\u{9752}\u{6625}\u{53BB}\u{8352}\u{5510}
\u{4E5F}\u{7528}\u{6574}\u{4E2A}\u{4EBA}\u{751F}\u{53BB}\u{98DE}\u{7FD4}

[Chorus 1]
[Vocal: Power belting, Sustained high notes, Layered Harmonies]
[Texture: Wall of Sound, Symphonic Rock]
[Instrument: Heavy Distorted Guitars (Power Chords), High Strings Unison Counterpoint, Bright Piano Octaves]
[Dynamics: f, explosive release]
Forever Forever
\u{65E0}\u{8BBA}\u{4F60}\u{8D70}\u{5230}\u{54EA}
\u{4E5F}\u{8981}\u{5728}\u{540C}\u{4E00}\u{7247}\u{5929}\u{7A7A}\u{4E0B}\u{53D1}\u{5149}
Forever Forever
\u{628A}\u{5FAC}\u{5FA8}\u{7684}\u{5FC3}\u{90FD}\u{70B9}\u{4EAE}
\u{62E5}\u{62B1}\u{5F7C}\u{6B64}\u{7684}\u{6A21}\u{6837}
\u{6C38}\u{6052}\u{56DE}\u{5FC6}\u{5C31}\u{50CF}\u{6052}\u{661F}\u{4E0D}\u{5FD8}

[Instrumental Interlude]
[Arrangement: J-Rock influence, soaring atmosphere]
[Instrument: Lyrical electric guitar solo trading melodies with High Strings Section (Duel)]
[Dynamics: ff]

[Verse 3]
[Vocal: Clear emotive tone, emotional friction]
[Instrument: Acoustic Guitar Strumming dominant, String Staccato Rhythm, Piano counter-melody]
[Dynamics: mf, driving rhythm]
\u{5E86}\u{5E78}\u{8FD9}\u{573A}\u{522B}\u{6765}\u{65E0}\u{6059}
\u{6C89}\u{9ED8}\u{91CC}\u{85CF}\u{7740}\u{592A}\u{591A}\u{8BDD}
\u{5C81}\u{6708}\u{4ECE}\u{4E0D}\u{653E}\u{8FC7}\u{8C01}\u{8138}\u{5E9E}
\u{5374}\u{4E5F}\u{5728}\u{5FC3}\u{4E2D}\u{7559}\u{4E0B}\u{5B9D}\u{85CF}

[Verse 4]
[Vocal: High tension, dramatic delivery, Double Tracking]
[Arrangement: Orchestral Swell, Strings Tremolo]
[Instrument: Intense Strumming, Heavy Piano Chords, Snare Rolls]
[Dynamics: mf -> f, dramatic push]
\u{70DF}\u{706B}\u{518D}\u{6B21}\u{7EFD}\u{653E}\u{8F89}\u{714C}
\u{5931}\u{843D}\u{77B3}\u{5B54}\u{5012}\u{6620}\u{5E0C}\u{671B}
\u{6BCF}\u{5F53}\u{524D}\u{8DEF}\u{98CE}\u{6A2A}\u{96E8}\u{53C8}\u{72C2}
\u{8BA9}\u{6211}\u{518D}\u{966A}\u{4F60}\u{5C55}\u{5F00}\u{7FC5}\u{8180}

[Chorus 2]
[Vocal: Intense belting, Richly Stacked Harmonies]
[Texture: Dense Wall of Sound]
[Instrument: Heavy Distorted Guitars, High Strings Unison Counterpoint, Crash Cymbals]
[Dynamics: ff, Driving Power]
Forever Forever
\u{65E0}\u{8BBA}\u{4F60}\u{8D70}\u{5230}\u{54EA}
\u{4E5F}\u{8981}\u{5728}\u{540C}\u{4E00}\u{7247}\u{5929}\u{7A7A}\u{4E0B}\u{53D1}\u{5149}
Forever Forever
\u{628A}\u{5FAC}\u{5FA8}\u{7684}\u{5FC3}\u{90FD}\u{70B9}\u{4EAE}
\u{62E5}\u{62B1}\u{5F7C}\u{6B64}\u{7684}\u{6A21}\u{6837}
\u{6C38}\u{6052}\u{56DE}\u{5FC6}\u{5C31}\u{50CF}\u{6052}\u{661F}\u{4E0D}\u{5FD8}

[Grand Chorus]
[Vocal: Ultimate high notes, Choir Backing, Octave Doubles, High Pitch Ad-libs]
[Arrangement: Explosive anthemic grand finale chorus]
[Instrument: Maximum Distorted Wall, Soaring Strings Melody, Bright Piano Glissando, Full Orchestra]
[Dynamics: fff, Anthemic, Epic Finale]
Forever Forever
\u{65E0}\u{8BBA}\u{4F60}\u{8D70}\u{5230}\u{54EA}
\u{4E5F}\u{8981}\u{5728}\u{540C}\u{4E00}\u{7247}\u{5929}\u{7A7A}\u{4E0B}\u{53D1}\u{5149}
Forever Forever
\u{628A}\u{5FAC}\u{5FA8}\u{7684}\u{5FC3}\u{90FD}\u{70B9}\u{4EAE}
\u{91CD}\u{56DE}\u{6700}\u{597D}\u{7684}\u{65F6}\u{5149}
\u{6C38}\u{6052}\u{56DE}\u{5FC6}\u{5C31}\u{50CF}\u{6052}\u{661F}\u{4E0D}\u{5FD8}

[Instrumental Outro]
[Arrangement: Fading out]
[Instrument: Piano Arpeggios, Soft Strings]
[Dynamics: Diminuendo, pp]`,lL=async()=>(await new Promise(e=>setTimeout(e,5e3)),{styles:lU,lyrics:lk}),lq=async(e,t)=>{try{await navigator.clipboard.writeText(e),nt.default.success(`${t||"\u6587\u672C"}\u{5DF2}\u{6210}\u{529F}\u{590D}\u{5236}\u{5230}\u{526A}\u{8D34}\u{677F}`);}catch(e){console.error("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25:",e),nt.default.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236");}},lG={songName:[{required:!0,message:"\u8BF7\u586B\u5199\u6B4C\u66F2\u540D\u79F0"},{max:100,message:"\u6B4C\u66F2\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7 100 \u4E2A\u5B57\u7B26"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9\s\-_]+$/,message:"\u6B4C\u66F2\u540D\u79F0\u53EA\u80FD\u5305\u542B\u4E2D\u6587\u3001\u82F1\u6587\u3001\u6570\u5B57\u3001\u7A7A\u683C\u548C\u5E38\u7528\u7B26\u53F7"}],artistName:[{required:!0,message:"\u8BF7\u586B\u5199\u6A21\u4EFF\u7684\u827A\u672F\u5BB6\u59D3\u540D"},{max:50,message:"\u827A\u672F\u5BB6\u59D3\u540D\u4E0D\u80FD\u8D85\u8FC7 50 \u4E2A\u5B57\u7B26"},{pattern:/^[\u4e00-\u9fa5a-zA-Z\s]+$/,message:"\u827A\u672F\u5BB6\u59D3\u540D\u53EA\u80FD\u5305\u542B\u4E2D\u6587\u3001\u82F1\u6587\u3001\u7A7A\u683C\u548C\u95F4\u9694\u7B26"}],referenceSongTitle:[{required:!0,message:"\u6B4C\u66F2\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"},{max:50,message:"\u6B4C\u66F2\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7 50 \u4E2A\u5B57\u7B26"}],referenceSongArtist:[{max:30,message:"\u6F14\u5531\u8005\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7 30 \u4E2A\u5B57\u7B26"}],lyrics:[{required:!0,message:"\u8BF7\u8F93\u5165\u6BB5\u843D\u4E0E\u6B4C\u8BCD"},{min:10,message:"\u6B4C\u8BCD\u5185\u5BB9\u81F3\u5C11\u9700\u8981 10 \u4E2A\u5B57\u7B26"},{max:2e3,message:"\u6BB5\u843D\u6B4C\u8BCD\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7 2000 \u5B57"},{validator:(e,t)=>t?/[[\]<>]/.test(t)?Promise.resolve():Promise.reject(Error("\u5EFA\u8BAE\u4F7F\u7528\u3010\u4E3B\u6B4C\u3011\u3001\u3010\u526F\u6B4C\u3011\u7B49\u6807\u8BB0\u5212\u5206\u6BB5\u843D")):Promise.resolve()}],language:[{required:!0,message:"\u8BF7\u9009\u62E9\u6B4C\u66F2\u8BED\u8A00"}]},lH={songName:{showCount:!0,maxLength:100},artistName:{showCount:!0,maxLength:50},referenceSongTitle:{showCount:!0,maxLength:50},referenceSongArtist:{showCount:!0,maxLength:30},lyrics:{showCount:!0,autoSize:{minRows:10,maxRows:12}}},lj=async e=>{try{if(!e)return[];if(Array.isArray(e))return e.filter(e=>e&&"object"==typeof e&&e.title&&"string"==typeof e.title).map(e=>({title:e.title||"",artist:e.artist||""}));if("string"==typeof e)try{let t=JSON.parse(e);if(Array.isArray(t))return t.filter(e=>e&&"object"==typeof e&&e.title&&"string"==typeof e.title).map(e=>({title:e.title||"",artist:e.artist||""}));}catch(e){}return[];}catch(e){return[];}},lF=async e=>{let t={song_name:"",song_language:"Mandarin",target_artist:"",style_note:"",lyrics_raw:"",extra_note:"",reference_songs:[]};if(!e)return{formValues:t,hasRecord:!1};try{let n=await lx.db.getPromptRecord(parseInt(e));if(!n)return nt.default.error("\u8BB0\u5F55\u4E0D\u5B58\u5728"),{formValues:t,hasRecord:!1};let i=await lj(n.user_input.reference_songs);return Object.assign(t,{song_name:n.user_input.song_name||"",song_language:n.user_input.song_language||"Mandarin",target_artist:n.user_input.target_singer||"",style_note:n.user_input.style_description||"",lyrics_raw:n.user_input.lyrics||"",extra_note:n.user_input.scene||"",reference_songs:i.length>0?i:[{title:"",artist:""}]}),{formValues:t,hasRecord:!0};}catch(e){return nt.default.error("\u6570\u636E\u52A0\u8F7D\u5931\u8D25"),{formValues:t,hasRecord:!1};}},lV=()=>{let[e,t]=nt.default.useMessage(),{apiKey:n,model:i,isLoading:r,saveApiKey:l,deleteApiKey:o,validateApiKey:s}=(0,nh.useApiKey)(),[a]=t5.default.useForm(),u=(0,ty.useRef)(null),[d]=(0,tP.useSearchParams)(),[p,c]=(0,ty.useState)(!1),[h,f]=(0,ty.useState)(""),[m,g]=(0,ty.useState)(""),[y,v]=(0,ty.useState)(!1),E=(0,ty.useCallback)(()=>!!n||(t7.default.confirm({title:"\u5C1A\u672A\u8BBE\u7F6E AI API Key",content:"\u8BBE\u7F6E\u5B8C\u6210\u540E\u5373\u53EF\u4F7F\u7528\u8BE5\u529F\u80FD\uFF0C\u662F\u5426\u73B0\u5728\u53BB\u8BBE\u7F6E\uFF1F",okText:"\u53BB\u8BBE\u7F6E",cancelText:"\u53D6\u6D88",onOk(){tP.history.push("/ai-setting");}}),!1),[n,tP.history]),_=(0,ty.useCallback)(async(t,n,r=!1)=>{try{let l=Array.isArray(t.reference_songs)?t.reference_songs:[],o=JSON.stringify(l.filter(e=>e&&e.title&&"string"==typeof e.title)),s=t.song_language||"Mandarin",a=t.target_artist||"\u672A\u77E5\u827A\u672F\u5BB6",u=t.lyrics_raw||"\u65E0\u6B4C\u8BCD",d={user_id:1,user_input:{song_name:t.song_name,song_language:s,target_singer:a,reference_songs:o,style_description:t.style_note||"",lyrics:u,scene:t.extra_note||""},ai_result:{styles:n.styles,lyrics:n.lyrics,model:r?"mock":i}},p=await lx.db.createPromptRecord(d);return e.success("\u8BB0\u5F55\u5DF2\u6210\u529F\u4FDD\u5B58"),p;}catch(e){throw e;}},[i,e]);(0,ty.useEffect)(()=>{(async()=>{let e=d.get("recordId"),{formValues:t,hasRecord:n}=await lF(e);n&&(f(t.stylesResult||""),g(t.lyricsResult||"")),a.setFieldsValue(t),v(!0);})();},[d,a]);let I=()=>{switch(i){case"deepseek":return nf.container.resolve(nv);case"gemini":return nf.container.resolve(lM);case"mimo":return nf.container.resolve(lD);default:throw Error(`Unsupported AI model: ${i}`);}},S=(0,ty.useCallback)(async t=>{if(E()){c(!0);try{let r=I(),l=await r.generate({...t,api_key:n,model:i});f(l.styles),g(l.lyrics),e.success("\u63D0\u793A\u8BCD\u5DF2\u6210\u529F\u751F\u6210\uFF01"),await _(t,l,!1);}catch(n){let t=n instanceof Error?n.message:`\u{8C03}\u{7528} ${i} API \u{5931}\u{8D25}\u{FF0C}\u{8BF7}\u{68C0}\u{67E5} API Key \u{6216}\u{7A0D}\u{540E}\u{518D}\u{8BD5}\u{3002}`;e.error(t);}finally{c(!1);}}},[E,n,i,e]),T=(0,ty.useCallback)(async()=>{c(!0);try{let t=a.getFieldsValue(),n=await lL();f(n.styles),g(n.lyrics),e.success("\u6A21\u62DF\u751F\u6210\u5DF2\u5B8C\u6210"),await _(t,n,!0);}catch(t){e.error("\u6A21\u62DF\u751F\u6210\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5");}finally{c(!1);}},[a,e]),A=(0,ty.useCallback)(()=>{T();},[T]);return(0,to.jsxs)(to.Fragment,{children:[t,(0,to.jsxs)(ts.PageContainer,{children:[!n&&(0,to.jsx)(tM.default,{title:"\u5C1A\u672A\u8BBE\u7F6E AI API Key\uFF0C\u8BBE\u7F6E\u5B8C\u6210\u540E\u5373\u53EF\u4F7F\u7528\u8BE5\u529F\u80FD\uFF0C\u662F\u5426\u73B0\u5728\u53BB\u8BBE\u7F6E\uFF1F",banner:!0,style:{marginBottom:24},action:(0,to.jsx)(tx.default,{type:"link",onClick:()=>tP.history.push("/ai-setting"),children:"\u53BB\u8BBE\u7F6E"})}),(0,to.jsx)(ns.default,{spinning:p,fullscreen:!0,size:"large"}),(0,to.jsxs)(ni.default,{gutter:[24,0],children:[(0,to.jsx)(tk.default,{span:8,children:(0,to.jsx)(ta.ProCard,{title:(0,to.jsx)("span",{onClick:A,style:{cursor:"pointer"},children:"\u7FFB\u5531\u914D\u7F6E"}),style:{height:"100%"},children:y?(0,to.jsxs)(tu.ProForm,{form:a,layout:"vertical",onFinish:S,submitter:{render:()=>(0,to.jsx)(t6,{vertical:!0,gap:"small",style:{marginTop:16},children:(0,to.jsx)(tx.default,{type:"primary",onClick:()=>a.submit(),loading:p,size:"large",block:!0,children:"\u751F\u6210\u63D0\u793A\u8BCD"})})},children:[(0,to.jsx)(tO.default,{name:"song_name",label:"\u6B4C\u66F2\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u6B4C\u66F2\u540D\u79F0\uFF0C\u4EC5\u4F5C\u4E3A\u8BB0\u5F55\u65B9\u4FBF\u67E5\u8BE2",rules:lG.songName,fieldProps:lH.songName}),(0,to.jsx)(tb,{name:"song_language",label:"\u6B4C\u66F2\u8BED\u8A00",placeholder:"\u8BF7\u9009\u62E9\u6B4C\u66F2\u8BED\u8A00",rules:lG.language,options:[{value:"Mandarin",label:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},{value:"Cantonese",label:"\u7CA4\u8BED"},{value:"Minnan",label:"\u95FD\u5357\u8BED"},{value:"English",label:"\u82F1\u8BED"},{value:"Korean",label:"\u97E9\u8BED"},{value:"Japanese",label:"\u65E5\u8BED"},{value:"Other",label:"\u5176\u4ED6"}]}),(0,to.jsx)(tO.default,{name:"target_artist",label:"\u60F3\u6A21\u4EFF\u54EA\u4F4D\u827A\u672F\u5BB6\uFF1F",placeholder:"\u4F8B\u5982\uFF1A\u5F20\u60E0\u59B9\u3001\u9648\u5955\u8FC5\u3001\u5468\u6770\u4F26\u7B49",rules:lG.artistName,fieldProps:lH.artistName}),(0,to.jsx)(td.ProFormList,{actionRef:u,name:"reference_songs",label:"\u53C2\u8003\u6B4C\u66F2\uFF08\u53EF\u9009\uFF0C\u6700\u591A 3 \u9996\uFF09",initialValue:[{title:"",artist:""}],creatorButtonProps:{creatorButtonText:"\u6DFB\u52A0\u53C2\u8003\u6B4C\u66F2",type:"dashed",block:!0},deleteIconProps:{tooltipText:"\u5220\u9664\u8BE5\u53C2\u8003\u6B4C\u66F2"},copyIconProps:!1,max:3,children:e=>(0,to.jsxs)(nl.default,{style:{width:"100%"},children:[(0,to.jsx)(tO.default,{name:"title",placeholder:"\u6B4C\u66F2\u540D",rules:lG.referenceSongTitle,fieldProps:{style:{width:"100%"},...lH.referenceSongTitle}}),(0,to.jsx)(tO.default,{name:"artist",placeholder:"\u6F14\u5531\u8005\uFF08\u53EF\u9009\uFF09",rules:lG.referenceSongArtist,fieldProps:{style:{width:"100%"},...lH.referenceSongArtist}})]},e.name)}),(0,to.jsx)(tN,{name:"style_note",label:"\u98CE\u683C\u5907\u6CE8\uFF08\u53EF\u9009\uFF09",placeholder:"\u4F8B\u5982\uFF1A\u4E3B\u6B4C\u8981\u50CF\u300A\u4EBA\u8D28\u300B\u4E00\u6837\u6781\u5EA6\u514B\u5236\uFF0C\u526F\u6B4C\u63A5\u8FD1\u300A\u542C\u6D77\u300B\u7684\u60C5\u7EEA\u7206\u53D1\u3002",fieldProps:{showCount:!0,rows:3}}),(0,to.jsx)(tN,{name:"extra_note",label:"\u7279\u6B8A\u8BF4\u660E\uFF08\u5982\u573A\u666F\u3001\u53D7\u4F17\u7B49\uFF0C\u53EF\u9009\uFF09",placeholder:"\u4F8B\u5982\uFF1A\u6F14\u5531\u4F1A\u73B0\u573A\u7248\u3001\u5F55\u97F3\u5BA4\u7248\u672C\u7B49",fieldProps:{showCount:!0,rows:3}}),(0,to.jsx)(tN,{name:"lyrics_raw",label:"\u6BB5\u843D\u4E0E\u6B4C\u8BCD",placeholder:"\u8BF7\u586B\u5199\u6B4C\u8BCD\uFF0C\u5E76\u4F7F\u7528\u4EFB\u610F\u6807\u7B7E\u5212\u5206\u6BB5\u843D\uFF0C\u4F8B\u5982\uFF1A\u3010\u4E3B\u6B4C\u3011\u3001\u3010\u526F\u6B4C\u3011\u3001[Verse]\u3001[Chorus] \u7B49",rules:lG.lyrics,fieldProps:lH.lyrics})]}):(0,to.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,to.jsx)(ns.default,{size:"large"})})})}),(0,to.jsx)(tk.default,{span:8,children:(0,to.jsx)(nc,{title:"Styles \u63D0\u793A\u8BCD\uFF08\u53EF\u76F4\u63A5\u590D\u5236\u7528\u4E8E Suno\uFF09",value:h,onCopy:()=>lq(h,"Styles")})}),(0,to.jsx)(tk.default,{span:8,children:(0,to.jsx)(nc,{title:"Lyrics \u63D0\u793A\u8BCD\uFF08\u53EF\u76F4\u63A5\u590D\u5236\u7528\u4E8E Suno\uFF09",value:m,onCopy:()=>lq(m,"Lyrics")})})]})]})]});};}}]);
//# sourceMappingURL=c27184d7-async.ac682e89.js.map