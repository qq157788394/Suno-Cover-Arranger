(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_suno-cover-arranger"]||[]).push([["76bb6665"],{eab7b529:function(e,t,r){r.d(t,"__esModule",{value:!0}),r.e(t,{default:function(){return $;}});var a=r("777fffbe"),l=r("852bbaa9"),n=r("c1fced07"),i=r("47ea07bf"),o=a._(i),s=r("067db9e2"),d=l._(s),u=r("ac38420e"),c=a._(u),f=r("f16f47f8"),g=a._(f);function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);}return e;}).apply(this,arguments);}let h=d.forwardRef((e,t)=>d.createElement(g.default,v({},e,{ref:t,icon:c.default})));var _=r("b0f18a1c"),b=a._(_),p=r("94726fb6"),y=r("cbf15750"),w=r("ccf5e343"),m=r("59830d05"),C=a._(m),k=r("7c4238ce"),x=a._(k),I=r("83e0e46b"),S=a._(I),j=r("2d814793"),T=a._(j),L=r("6337b314"),D=a._(L),O=r("1b7cbf58"),R=a._(O),P=r("e236400f");let E=e=>{let[t,r]=(0,d.useState)(!1),[a,l]=(0,d.useState)([]),n=(0,d.useCallback)(async()=>await P.db.getUserPromptRecords(e),[e]),i=(0,d.useCallback)((e,t)=>{if(!t||!Array.isArray(t)||!t[0]||!t[1])return e;let r=new Date(t[0]),a=new Date(t[1]);return a.setHours(23,59,59,999),e.filter(e=>{let t=new Date(e.created_at||new Date(0));return t>=r&&t<=a;});},[]),o=(0,d.useCallback)((e,t)=>{if(!t)return e;let r=Array.isArray(t)?t:[t];return e.filter(e=>r.includes(e.user_input.song_language));},[]),s=(0,d.useCallback)((e,t)=>{if(!t||!t.trim())return e;let r=t.toLowerCase();return e.filter(e=>{var t,a;return null===(a=e.user_input)||void 0===a?void 0:null===(t=a.target_singer)||void 0===t?void 0:t.toLowerCase().includes(r);});},[]),u=(0,d.useCallback)((e,t)=>{if(!t||!t.trim())return e;let r=t.toLowerCase();return e.filter(e=>{var t,a;return null===(a=e.user_input)||void 0===a?void 0:null===(t=a.style_description)||void 0===t?void 0:t.toLowerCase().includes(r);});},[]),c=(0,d.useCallback)((e,t)=>{if(!t||!t.trim())return e;let r=t.toLowerCase();return e.filter(e=>{var t,a;return null===(a=e.user_input)||void 0===a?void 0:null===(t=a.song_name)||void 0===t?void 0:t.toLowerCase().includes(r);});},[]),f=(0,d.useCallback)((e,t)=>{if(!t||!t.trim())return e;let r=t.toLowerCase();return e.filter(e=>{var t,a,l,n,i,o,s,d,u,c;return(null===(a=e.user_input)||void 0===a?void 0:null===(t=a.song_name)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(n=e.user_input)||void 0===n?void 0:null===(l=n.target_singer)||void 0===l?void 0:l.toLowerCase().includes(r))||(null===(o=e.user_input)||void 0===o?void 0:null===(i=o.style_description)||void 0===i?void 0:i.toLowerCase().includes(r))||(null===(d=e.ai_result)||void 0===d?void 0:null===(s=d.styles)||void 0===s?void 0:s.toLowerCase().includes(r))||(null===(c=e.ai_result)||void 0===c?void 0:null===(u=c.lyrics)||void 0===u?void 0:u.toLowerCase().includes(r));});},[]),g=(0,d.useCallback)(async(e={})=>{r(!0);try{let t=await n();return t=f(t,e.keyword),t=i(t,e.dateRange),t=o(t,e.songLanguages),t=s(t,e.targetSinger),t=u(t,e.styleDescription),t=c(t,e.songName),l(t),t;}catch(e){return console.error("\u83B7\u53D6\u8BB0\u5F55\u5931\u8D25\uFF1A",e),l([]),[];}finally{r(!1);}},[n,f,i,o,s,u,c]),v=(0,d.useCallback)(async e=>{try{return await P.db.deletePromptRecord(e),await g(),{success:!0};}catch(e){return console.error("\u5220\u9664\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[g]);return{records:a,loading:t,fetchRecords:g,deleteRecord:v,clearAllRecords:(0,d.useCallback)(async()=>{try{let t=await P.db.getUserPromptRecords(e);return await Promise.all(t.map(e=>P.db.deletePromptRecord(e.id))),l([]),{success:!0};}catch(e){return console.error("\u6E05\u7A7A\u8BB0\u5F55\u5931\u8D25\uFF1A",e),{success:!1,error:e};}},[e])};},M={info:(e,t)=>{console.log(`[INFO] ${new Date().toISOString()}: ${e}`,t||"");},error:(e,t)=>{console.error(`[ERROR] ${new Date().toISOString()}: ${e}`,t||"");}};var $=d.default.memo(()=>{let{records:e,loading:t,fetchRecords:r,deleteRecord:a}=E(1),l=(0,w.useNavigate)();(0,d.useEffect)(()=>{r();},[r]);let i=(0,d.useCallback)(e=>{try{if(M.info("\u70B9\u51FB\u67E5\u770B\u8BE6\u60C5\uFF0C\u51C6\u5907\u4F20\u9012\u7684\u8BB0\u5F55ID",{recordId:e.id,record:e}),!e||!e.id){M.error("record\u6216record.id\u4E3A\u7A7A",{record:e}),T.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BB0\u5F55\u6570\u636E\u4E0D\u5B8C\u6574");return;}M.info("\u5F00\u59CB\u8DF3\u8F6C\u5230\u9996\u9875\uFF0C\u643A\u5E26\u8BB0\u5F55ID\u53C2\u6570",{recordId:e.id}),l(`/?recordId=${e.id}`);}catch(e){M.error("\u5BFC\u822A\u5230\u8BE6\u60C5\u9875\u5931\u8D25",e),T.default.error("\u67E5\u770B\u8BE6\u60C5\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");}},[l]),s=(0,d.useCallback)(async e=>{S.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u6761\u8BB0\u5F55\u5417\uFF1F\u8BE5\u64CD\u4F5C\u65E0\u6CD5\u6062\u590D\u3002",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk:async()=>{try{await a(e.id),T.default.success("\u5220\u9664\u6210\u529F");}catch(e){T.default.error("\u5220\u9664\u5931\u8D25"),console.error("\u5220\u9664\u5931\u8D25\uFF1A",e);}}});},[a]),u=(0,d.useCallback)(e=>e,[]),c=(0,d.useCallback)(async(e,t,a,l)=>{let{action:n,searchFormValues:i}=l;if("search"===n){let e=(null==i?void 0:i.keyword)||"",t=null==i?void 0:i.created_at,a=null==i?void 0:i.song_language,l=null==i?void 0:i.target_singer,n=null==i?void 0:i.style_description,o=null==i?void 0:i.song_name;await r({keyword:e,dateRange:t,songLanguages:a,targetSinger:l,styleDescription:n,songName:o});}},[r]),f=(0,d.useMemo)(()=>[{title:"ID",dataIndex:"id",key:"id",width:80,hideInSearch:!0},{title:"\u65F6\u95F4",dataIndex:"created_at",key:"created_at",width:180,valueType:"dateRange",render:(e,t)=>{let r=t.created_at||new Date(0);return(0,n.jsx)(R.default,{title:new Date(r).toLocaleString(),children:(0,n.jsxs)(D.default,{children:[(0,n.jsx)(o.default,{}),new Date(r).toLocaleString()]})});}},{title:"\u6B4C\u66F2\u540D\u79F0",dataIndex:["user_input","song_name"],key:"song_name",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u6B4C\u66F2\u8BED\u8A00",dataIndex:["user_input","song_language"],key:"song_language",width:120,valueType:"select",valueEnum:{Mandarin:{text:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},Cantonese:{text:"\u7CA4\u8BED"},Minnan:{text:"\u95FD\u5357\u8BED"},English:{text:"\u82F1\u8BED"},Korean:{text:"\u97E9\u8BED"},Japanese:{text:"\u65E5\u8BED"},Other:{text:"\u5176\u4ED6"}},search:!0,search:{multiple:!0,fieldProps:{mode:"multiple",options:[{value:"Mandarin",label:"\u534E\u8BED\uFF08\u666E\u901A\u8BDD\uFF09"},{value:"Cantonese",label:"\u7CA4\u8BED"},{value:"Minnan",label:"\u95FD\u5357\u8BED"},{value:"English",label:"\u82F1\u8BED"},{value:"Korean",label:"\u97E9\u8BED"},{value:"Japanese",label:"\u65E5\u8BED"},{value:"Other",label:"\u5176\u4ED6"}],maxTagCount:"responsive"}}},{title:"\u6A21\u4EFF\u6B4C\u624B",dataIndex:["user_input","target_singer"],key:"target_singer",width:150,search:!0,ellipsis:{showTitle:!1}},{title:"\u98CE\u683C\u5907\u6CE8",dataIndex:["user_input","style_description"],key:"style_description",width:200,search:!0,ellipsis:{showTitle:!1}},{title:"\u64CD\u4F5C",key:"action",width:120,fixed:"right",hideInSearch:!0,render:(e,t)=>(0,n.jsxs)(D.default,{size:"middle",children:[(0,n.jsx)(R.default,{title:"\u67E5\u770B\u63D0\u793A\u8BCD",children:(0,n.jsx)(x.default,{type:"primary",icon:(0,n.jsx)(b.default,{}),size:"small",onClick:()=>i(t),children:"\u8BE6\u60C5"})}),(0,n.jsx)(R.default,{title:"\u5220\u9664",children:(0,n.jsx)(x.default,{danger:!0,icon:(0,n.jsx)(h,{}),size:"small",onClick:()=>s(t),children:"\u5220\u9664"})})]})}],[i,s]);return(0,n.jsxs)(p.PageContainer,{children:[(0,n.jsx)(C.default,{title:"\u751F\u6210\u8BB0\u5F55\u4EC5\u4FDD\u5B58\u5728\u672C\u5730\u8BBE\u5907\uFF0C\u4E0D\u4F1A\u4E0A\u4F20\u81F3\u670D\u52A1\u5668\uFF0C\u66F4\u6362\u8BBE\u5907\u6216\u6D4F\u89C8\u5668\u540E\u8BB0\u5F55\u5C06\u65E0\u6CD5\u67E5\u770B\u3002",banner:!0,style:{marginBottom:24}}),(0,n.jsx)(y.ProTable,{rowKey:"id",columns:f,dataSource:e,loading:t,headerTitle:"\u63D0\u793A\u8BCD\u751F\u6210\u8BB0\u5F55",options:{reload:()=>r(),density:!0,fullScreen:!0},scroll:{x:"max-content"},onChange:c,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`\u{5171} ${e} \u{6761}\u{8BB0}\u{5F55}`},search:{labelWidth:"auto",defaultCollapsed:!1,span:6},request:async(t,a,l)=>{let n=(null==t?void 0:t.keyword)||"",i=null==t?void 0:t.created_at,o=null==t?void 0:t.song_language,s=null==t?void 0:t.target_singer,d=null==t?void 0:t.style_description,u=null==t?void 0:t.song_name;return await r({keyword:n,dateRange:i,songLanguages:o,targetSinger:s,styleDescription:d,songName:u}),{data:e,success:!0,total:e.length};},beforeSearchSubmit:u})]});});}}]);
//# sourceMappingURL=76bb6665-async.36b89636.js.map