{"version":3,"sources":["src/pages/ai-setting/index.tsx"],"sourcesContent":["import { DeleteOutlined, SaveOutlined } from '@ant-design/icons';\nimport {\n  PageContainer,\n  ProCard,\n  ProForm,\n  ProFormText,\n} from '@ant-design/pro-components';\nimport { Alert, Form, message, Space, Typography } from 'antd';\nimport React, { useEffect } from 'react';\nimport { useApiKey } from '@/hooks/useApiKey';\n\nconst { Text, Paragraph, Title } = Typography;\n\nconst AISettingPage: React.FC = () => {\n  // 使用自定义hook管理API Key\n  const { apiKey, isLoading, saveApiKey, deleteApiKey, validateApiKey } =\n    useApiKey();\n  // 创建 FormInstance 的引用\n  const [form] = Form.useForm();\n\n  // 当API Key加载完成后，设置到表单中\n  useEffect(() => {\n    if (!isLoading) {\n      form.setFieldsValue({ apiKey: apiKey });\n    }\n  }, [apiKey, isLoading, form]);\n\n  // 表单提交处理\n  const handleFormSubmit = async (values: { apiKey: string }) => {\n    // 验证API Key格式\n    if (!validateApiKey(values.apiKey)) {\n      message.error('API Key格式不正确，请输入以sk-开头的API Key');\n      return;\n    }\n\n    const result = await saveApiKey(values.apiKey);\n    if (result) {\n      message.success('API Key 已成功保存');\n    } else {\n      message.error('保存API Key失败，请稍后重试');\n    }\n  };\n\n  // 表单重置处理\n  const handleFormReset = async () => {\n    const result = await deleteApiKey();\n    if (result) {\n      // 清空表单内容\n      form.setFieldsValue({ apiKey: '' });\n      message.success('API Key 已删除');\n    } else {\n      message.error('删除API Key失败，请稍后重试');\n    }\n  };\n\n  return (\n    <PageContainer>\n      <Space direction=\"vertical\" size=\"large\" style={{ display: 'flex' }}>\n        <ProCard>\n          <ProForm\n            layout=\"vertical\"\n            initialValues={{\n              apiKey: apiKey,\n            }}\n            form={form}\n            onFinish={handleFormSubmit}\n            onReset={handleFormReset}\n            submitter={{\n              searchConfig: {\n                submitText: '保存 API Key',\n                resetText: '删除 API Key',\n              },\n            }}\n            loading={isLoading}\n          >\n            <ProFormText.Password\n              name=\"apiKey\"\n              label=\"DeepSeek API Key\"\n              placeholder=\"请输入以sk-开头的DeepSeek API Key\"\n              fieldProps={{\n                size: 'large',\n              }}\n              rules={[\n                {\n                  required: true,\n                  message: '请输入DeepSeek API Key',\n                },\n                {\n                  validator: (_rule, value) => {\n                    if (!value || validateApiKey(value)) {\n                      return Promise.resolve();\n                    }\n                    return Promise.reject(\n                      new Error('API Key格式不正确，请输入以sk-开头的API Key'),\n                    );\n                  },\n                },\n              ]}\n            />\n\n            <Alert\n              title=\"温馨提示\"\n              description={\n                <Paragraph>\n                  <ul>\n                    <li>您的 API Key 仅保存在本地设备</li>\n                    <li>不会上传至任何第三方服务器</li>\n                    <li>仅通过 HTTPS 直连 DeepSeek 官方 API</li>\n                    <li>您可随时删除保存的 API Key</li>\n                  </ul>\n                </Paragraph>\n              }\n              type=\"success\"\n              style={{ marginBottom: 24 }}\n            />\n          </ProForm>\n        </ProCard>\n\n        <ProCard>\n          <Title level={4}>\n            DeepSeek API Key 一分钟申请 + 充值指南（新手版）\n          </Title>\n          <Paragraph>\n            <ol>\n              <li>\n                打开官网：\n                <a\n                  href=\"https://platform.deepseek.com/\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  https://www.deepseek.cn/register\n                </a>\n              </li>\n              <li>点击右上角 【登录 / 注册】（手机号、邮箱、微信都可以）</li>\n              <li>根据提示完成注册（手机号、邮箱、微信都可以）</li>\n              <li>登录后，在左侧找到 【API 密钥 / API Keys】</li>\n              <li>点击 【创建 API Key】，输入名称并确认</li>\n              <li>复制生成的 API Key（记得先保存好，之后看不到完整内容）</li>\n              <li>\n                在 DeepSeek 平台完成充值：10 元起充，支持微信、支付宝，10\n                元一般能用挺久。\n              </li>\n              <li>回到本应用 → 打开 设置 / AI 设置 → 粘贴 API Key → 保存。</li>\n              <li>完成！现在就可以正常使用各项 AI 生成功能了。</li>\n            </ol>\n          </Paragraph>\n        </ProCard>\n      </Space>\n    </PageContainer>\n  );\n};\n\nexport default AISettingPage;\n"],"names":[],"mappings":"2QAyJA,+CAAA,4NAjJiC,gBACP,YAE1B,GAAM,CAAE,KAAA,CAAI,CAAE,UAAA,CAAS,CAAE,MAAA,CAAK,CAAE,CAAG,SAAU,KA8I7C,EA5IgC,KAE9B,GAAM,CAAE,OAAA,CAAM,CAAE,UAAA,CAAS,CAAE,WAAA,CAAU,CAAE,aAAA,CAAY,CAAE,eAAA,CAAc,CAAE,CACnE,GAAA,WAAS,IAEL,CAAC,EAAK,CAAG,SAAI,CAAC,OAAO,GAG3B,GAAA,WAAS,EAAC,KACH,GACH,EAAK,cAAc,CAAC,CAAE,OAAQ,CAAO,GAEzC,EAAG,CAAC,EAAQ,EAAW,EAAK,EAG5B,IAAM,EAAmB,MAAO,IAE9B,GAAI,CAAC,EAAe,EAAO,MAAM,EAAG,CAClC,SAAO,CAAC,KAAK,CAAC,mGACd,OACF,CAEe,MAAM,EAAW,EAAO,MAAM,EAE3C,SAAO,CAAC,OAAO,CAAC,0CAEhB,SAAO,CAAC,KAAK,CAAC,uEAElB,EAGM,EAAkB,UACP,MAAM,KAGnB,EAAK,cAAc,CAAC,CAAE,OAAQ,EAAG,GACjC,SAAO,CAAC,OAAO,CAAC,+BAEhB,SAAO,CAAC,KAAK,CAAC,uEAElB,EAEA,MACE,UAAC,eAAa,WACZ,WAAC,SAAK,EAAC,UAAU,WAAW,KAAK,QAAQ,MAAO,CAAE,QAAS,MAAO,YAChE,UAAC,SAAO,WACN,WAAC,SAAO,EACN,OAAO,WACP,cAAe,CACb,OAAQ,CACV,EACA,KAAM,EACN,SAAU,EACV,QAAS,EACT,UAAW,CACT,aAAc,CACZ,WAAY,uBACZ,UAAW,sBACb,CACF,EACA,QAAS,YAET,UAAC,SAAW,CAAC,QAAQ,EACnB,KAAK,SACL,MAAM,mBACN,YAAY,gEACZ,WAAY,CACV,KAAM,OACR,EACA,MAAO,CACL,CACE,SAAU,CAAA,EACV,QAAS,oCACX,EACA,CACE,UAAW,CAAC,EAAO,IACjB,AAAI,CAAC,GAAS,EAAe,GACpB,QAAQ,OAAO,GAEjB,QAAQ,MAAM,CACnB,AAAI,MAAM,mGAGhB,EACD,GAGH,UAAC,SAAK,EACJ,MAAM,2BACN,YACE,UAAC,YACC,WAAC,gBACC,UAAC,eAAG,0EACJ,UAAC,eAAG,mFACJ,UAAC,eAAG,oEACJ,UAAC,eAAG,wEAIV,KAAK,UACL,MAAO,CAAE,aAAc,EAAG,SAKhC,WAAC,SAAO,YACN,UAAC,GAAM,MAAO,WAAG,6GAGjB,UAAC,YACC,WAAC,gBACC,WAAC,gBAAG,iCAEF,UAAC,KACC,KAAK,iCACL,OAAO,SACP,IAAI,+BACL,wCAIH,UAAC,eAAG,+JACJ,UAAC,eAAG,yIACJ,UAAC,eAAG,mGACJ,UAAC,eAAG,kGACJ,UAAC,eAAG,uJACJ,UAAC,eAAG,mMAIJ,UAAC,eAAG,4IACJ,UAAC,eAAG,8IAOlB"}